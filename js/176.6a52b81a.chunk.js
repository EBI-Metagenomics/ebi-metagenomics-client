"use strict";(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[176],{2379:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(7294),r=a(2531);const l={biosynthetic:"Core biosynthetic gene","biosynthetic-additional":"Additional biosynthetic gene",regulatory:"Regulatory genes",transport:"Transport-related gene",resistance:"Resistance genes"},s=({value:e,url:t,decodeValue:a})=>{if(!e)return null;const l=e.split(",");return n.createElement("ul",{className:"vf-list"},l.map((e=>{const l=a?decodeURIComponent(e):e;return n.createElement("li",{key:e},t?n.createElement(r.Z,{href:`${t}${e}`},l):l)})))},o=e=>{const t="string"==typeof e.start?parseInt(e.start,10):e.start,a="string"==typeof e.end?parseInt(e.end,10):e.end;if(!Number.isNaN(t)&&!Number.isNaN(a)&&null!==t&&null!==a)return Math.ceil((a-t)/3)},i=({data:e})=>{const{name:t,gene:a,product:i,properties:c}=(e=>{const t=e.reduce(((e,t)=>(t.name&&(e[t.name.toLowerCase()]=t.value),e)),{}),a={title:"Functional annotation",data:[{name:"E.C Number",Value:t.ecnumber&&(()=>n.createElement(s,{value:t.ecnumber,url:"https://enzyme.expasy.org/EC/"}))},{name:"Pfam",Value:t.pfam&&(()=>n.createElement(s,{value:t.pfam,url:"https://pfam.xfam.org/family/"}))},{name:"KEGG",Value:t.kegg&&(()=>n.createElement(s,{value:t.kegg,url:"https://www.genome.jp/dbget-bin/www_bget?"}))},{name:"eggNOG",Value:t.eggnog&&decodeURIComponent(t.eggnog)},{name:"COG",Value:t.cog&&(()=>n.createElement(s,{value:t.cog}))},{name:"GO",Value:t.go&&(()=>n.createElement(s,{value:t.go,url:"https://www.ebi.ac.uk/ols/search?q="}))},{name:"InterPro",Value:t.interpro&&(()=>n.createElement(s,{value:t.interpro,url:"https://www.ebi.ac.uk/interpro/entry/InterPro/'"}))},{name:"Gene type",Value:t.as_type&&(l[t.as_type]||t.as_type)},{name:"Notes",Value:t.as_notes&&(()=>n.createElement(s,{value:decodeURIComponent(t.as_notes)}))},{name:"Cluster",Value:t.as_gene_clusters&&(()=>n.createElement(s,{value:t.as_gene_clusters}))}]},i={title:"Feature details",data:[{name:"Type",Value:t.type},{name:"Inference",Value:t.inference},{name:"Start / End",Value:`${t.start}/${t.end}`},{name:"Protein length",Value:String(o(t))}]},c={title:"Metaproteomics",data:[{name:"Peptide sequences",Value:t.peptide_sequences&&(()=>n.createElement(s,{value:t.peptide_sequences,decodeValue:!0}))},{name:"Pride ID",Value:t.pride_id&&(()=>n.createElement(r.Z,{href:`https://www.ebi.ac.uk/pride/archive/projects/${t.pride_id}`},t.pride_id))}]};return{name:t.id,gene:t.gene,product:t.product,properties:[a,i,c]}})(e);return n.createElement(n.Fragment,null,n.createElement("table",{className:"stack hover igv-popover-table"},n.createElement("caption",{className:"igv-popover-section-header"},"Feature"),n.createElement("tbody",null,t&&n.createElement("tr",null,n.createElement("td",{className:"igv-popover-table-td-name"},"ID"),n.createElement("td",null,t)),a&&n.createElement("tr",null,n.createElement("td",{className:"igv-popover-table-td-name"},"Gene"),n.createElement("td",null,n.createElement("em",null,a))),i&&n.createElement("tr",null,n.createElement("td",{className:"igv-popover-table-td-name"},"Product"),n.createElement("td",null,i)))),c.map((e=>n.createElement("table",{className:"stack hover igv-popover-table",key:e.title},e.data.filter((e=>!!e.Value)).length>0&&n.createElement("caption",{className:"igv-popover-section-header"},e.title),n.createElement("tbody",null,e.data.map((({name:e,Value:t})=>t&&n.createElement("tr",{key:e},n.createElement("td",{className:"igv-popover-table-td-name"},e),n.createElement("td",null,"string"==typeof t?t:n.createElement(t,null))))).filter(Boolean))))))}},1274:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(7294),r=a(6974);const l=({hash:e,isDefault:t=!1,children:a})=>{const l=(0,r.TH)(),s=(0,r.s0)();return(0,n.useEffect)((()=>{""===l.hash&&""!==e&&t&&s(e,{replace:!0})})),l.hash===e?n.createElement(n.Fragment,null,a):null}},2069:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(7294);const r=()=>n.createElement("svg",{"aria-hidden":"true",className:"vf-card__heading__icon | vf-icon vf-icon-arrow--inline-end",width:"1em",height:"1em",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",preserveAspectRatio:"none"},n.createElement("path",{d:"M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z",fill:"currentColor",fillRule:"nonzero"}))},8696:(e,t,a)=>{a.d(t,{Z:()=>m});var n=a(7294),r=a(9521),l=a(402),s=a(2119);const o=({currentPageIndex:e,pageIndex:t,gotoPage:a})=>e===t?n.createElement("li",{className:"vf-pagination__item vf-pagination__item--is-active"},n.createElement("span",{className:"vf-pagination__label","aria-current":"page"},n.createElement("span",{className:"vf-u-sr-only"},"Page "),e+1)):n.createElement("li",{className:"vf-pagination__item"},n.createElement("button",{type:"button",onClick:()=>a(t),className:"vf-button vf-button--link vf-pagination__link"},n.createElement("span",{className:"vf-u-sr-only"}," page"),t+1));var i=a(9111);const c=({namespace:e})=>{const[t,a]=(0,s.B)({[`${e}search`]:""}),[r,l]=(0,n.useState)(t[`${e}search`]||""),o=(0,n.useCallback)((0,i.Z)((n=>{a(Object.assign(Object.assign({},t),{[`${e}search`]:n}))}),300),[]);return n.createElement("div",{className:"vf-form__item mg-textsearch"},n.createElement("label",{className:"vf-form__label vf-search__label",htmlFor:"searchitem"},"Filter"),n.createElement("input",{type:"search",placeholder:"Enter your search terms",id:"searchitem",className:"vf-form__input",onChange:e=>{const t=e.target.value;l(t),o(t)},value:r}))},m=({cols:e,data:t,title:a,initialPage:i=0,initialPageSize:m=25,className:u="",namespace:d="",showPagination:g=!0,showTextFilter:p=!1,sortable:b=!1,loading:v=!1,isStale:f=!1,downloadURL:h=null})=>{var E,y,_,N;const[w,x]=(0,s.B)({[`${d}page`]:1,[`${d}order`]:"",[`${d}page_size`]:m,[`${d}search`]:m},{[`${d}page`]:Number,[`${d}page_size`]:Number}),{getTableProps:k,getTableBodyProps:C,headerGroups:P,rows:$,prepareRow:Z,canPreviousPage:S,canNextPage:O,pageCount:F,gotoPage:T,setPageSize:D,nextPage:G,previousPage:j,state:{pageIndex:B,pageSize:z,sortBy:A}}=(0,r.useTable)({columns:e,data:(null===(E=t)||void 0===E?void 0:E.data)||t,initialState:{pageIndex:i,pageSize:w[`${d}page_size`]},pageCount:(null===(N=null===(_=null===(y=t)||void 0===y?void 0:y.meta)||void 0===_?void 0:_.pagination)||void 0===N?void 0:N.pages)||1,manualPagination:!0,manualSortBy:!0},r.useSortBy,r.usePagination),I=(0,n.useRef)(null),[R,V]=(0,n.useState)(!1);(0,n.useEffect)((()=>{g&&w[`${d}page`]!==B+1&&(x(Object.assign(Object.assign({},w),{[`${d}page`]:B+1})),I.current&&R&&(I.current.scrollIntoView(),V(!1)))}),[g,x,B]),(0,n.useEffect)((()=>{g&&w[`${d}page_size`]!==z&&(x(Object.assign(Object.assign({},w),{[`${d}page_size`]:z})),I.current&&R&&(I.current.scrollIntoView(),V(!1)))}),[g,x,z]),(0,n.useEffect)((()=>{if(b){const e=function(e){if(!e.length)return"";const t=e[0];return`${t.desc?"-":""}${t.id.replace(/attributes./g,"").replace(/-/g,"_")}`}(A);if(e===w[`${d}order`])return;x(Object.assign(Object.assign({},w),{[`${d}order`]:e,[`${d}page`]:1})),I.current&&R&&(I.current.scrollIntoView(),V(!1))}}),[g,x,A,b]);const q=(0,n.useMemo)((()=>function(e,t){const a=t>1?[0,1]:[0],n=t>2?[Math.max(2,e-2)]:[];for(let e=n[0]+1;e<t-2&&n.length<5;e+=1)n.push(e);let r=[];return t>7?r=[t-2,t-1]:t>6&&(r=[t-1]),{startingPages:a,endingPages:r,adjacentPages:n,hasJumpFromStart:!!n.length&&n[0]>a[a.length-1]+1,hasJumpToEnd:!!r.length&&!!n.length&&r[0]>n[n.length-1]+1}}(B,F)),[B,F]),H=e=>(V(!0),T(e)),M=e=>(V(!0),D(+e.target.value));return v&&!f?n.createElement(l.Z,{size:"small"}):n.createElement("section",null,n.createElement("div",{className:"mg-table-overlay-container"},n.createElement("div",{className:v&&f?"mg-table-overlay":void 0}),n.createElement("table",Object.assign({},k,{className:`vf-table--striped mg-table ${u}`,ref:I}),(a||p||h)&&n.createElement("caption",{className:"vf-table__caption mg-table-caption"},n.createElement("div",null,n.createElement("div",null,p&&n.createElement(c,{namespace:d}),h&&n.createElement(n.Fragment,null," ",n.createElement("a",{href:h,className:"vf-button vf-button--secondary vf-button--sm",style:{whiteSpace:"nowrap"},download:!0},n.createElement("span",{className:"icon icon-common icon-download"})," ","Download"))),a&&("string"==typeof a?a:n.createElement(a,null)))),n.createElement("thead",{className:"vf-table__header"},P.map((e=>n.createElement("tr",Object.assign({},e.getHeaderGroupProps(),{className:"vf-table__row"}),e.headers.map((e=>n.createElement("th",Object.assign({},b&&e.canSort?e.getHeaderProps(e.getSortByToggleProps()):{key:e.id},{className:"vf-table__heading"}),e.render("Header"),b&&e.canSort&&n.createElement(n.Fragment,null,"Â ",n.createElement("span",null,e.isSorted?e.isSortedDesc?n.createElement("i",{className:"icon icon-common icon-sort-down"}):n.createElement("i",{className:"icon icon-common icon-sort-up"}):n.createElement("i",{className:"icon icon-common icon-sort"})))))))))),n.createElement("tbody",Object.assign({},C(),{className:"vf-table__body"}),$.map((e=>(Z(e),n.createElement("tr",Object.assign({},e.getRowProps(),{className:"vf-table__row"}),e.cells.map((e=>n.createElement("td",Object.assign({},e.getCellProps(),{className:"vf-table__cell"}),e.render("Cell"))))))))))),g&&n.createElement("section",{className:"mg-table-footer"},n.createElement("label",{className:"vf-form__label"},"Page Size:",n.createElement("select",{className:"vf-form__select",value:w[`${d}page_size`],onBlur:M,onChange:M},[10,25,50].map((e=>n.createElement("option",{key:e,value:e},"Show ",e))))),n.createElement("nav",{className:"vf-pagination","aria-label":"Pagination"},n.createElement("ul",{className:"vf-pagination__list"},n.createElement("li",{className:"vf-pagination__item vf-pagination__item--previous-page"},n.createElement("button",{disabled:!S,type:"button",onClick:j,className:"vf-button vf-button--link vf-pagination__link"},"Previous",n.createElement("span",{className:"vf-u-sr-only"}," page"))),q.startingPages.map((e=>n.createElement(o,{key:e,currentPageIndex:B,pageIndex:e,gotoPage:H}))),q.hasJumpFromStart&&n.createElement("li",{className:"vf-pagination__item"},n.createElement("span",{className:"vf-pagination__label"},"...")),q.adjacentPages.map((e=>n.createElement(o,{key:e,currentPageIndex:B,pageIndex:e,gotoPage:H}))),q.hasJumpToEnd&&n.createElement("li",{className:"vf-pagination__item"},n.createElement("span",{className:"vf-pagination__label"},"...")),q.endingPages.map((e=>n.createElement(o,{key:e,currentPageIndex:B,pageIndex:e,gotoPage:H}))),n.createElement("li",{className:"vf-pagination__item vf-pagination__item--next-page"},n.createElement("button",{disabled:!O,type:"button",onClick:G,className:"vf-button vf-button--link vf-pagination__link"},"Next",n.createElement("span",{className:"vf-u-sr-only"}," page")))))))}},2531:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(7294);const r=({href:e,id:t,title:a,children:r})=>n.createElement("a",{href:e,title:a,id:t,target:"_blank",rel:"noreferrer noopener",className:"mg-ext"},n.createElement("span",{className:"icon icon-common icon-external-link-alt"})," ",r)},1699:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(7294),r=a(7838);const l=()=>{window.location.reload()},s=({error:e})=>e&&e.type!==r.ZB.NullURL?n.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy",style:{backgroundColor:"lemonchiffon"}},n.createElement("h3",{className:"vf-box__heading"},n.createElement("span",{className:"icon icon-common icon-exclamation-triangle"})," Error Fetching Data"),n.createElement("p",{className:"vf-box__text"},(null==e?void 0:e.type)===r.ZB.FetchError&&`There were problems with the request. [${e.error}]`,(null==e?void 0:e.type)===r.ZB.NotOK&&`The response from the server was not OK [Status: ${e.status}].`,(null==e?void 0:e.type)===r.ZB.JSONError&&`The recovered resource didn't follow the expected format [${e.error}].`),n.createElement("div",{className:"mg-right"},n.createElement("button",{type:"button",className:"vf-button vf-button--tertiary vf-button--sm ",onClick:l},"Refresh"))):null},3415:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(7294);const r=({list:e})=>n.createElement("div",{className:"vf-grid vf-grid__col-2",style:{gridTemplateColumns:"1fr 2fr",rowGap:"0.5rem"}},e.map((({key:e,value:t})=>n.createElement(n.Fragment,{key:e},n.createElement("div",{style:{textAlign:"right"}},e,":"),n.createElement("div",null,"string"==typeof t?t:n.createElement(t,null))))))},4821:(e,t,a)=>{a.d(t,{Z:()=>s});var n=a(7294),r=a(6974),l=a(9711);const s=({tabs:e})=>{const t=(0,r.TH)();return n.createElement("div",{className:"vf-tabs mg-search-tabs"},n.createElement("ul",{className:"vf-tabs__list"},e.map((({label:e,to:a})=>n.createElement("li",{className:"vf-tabs__item",key:a},n.createElement(l.rU,{className:"vf-tabs__link "+(a===t.pathname||a.startsWith("#")&&a===t.hash||"#"===a&&""===t.hash?"is-active":""),to:a},"string"==typeof e?e:n.createElement(e,null)))))))}},7565:(e,t,a)=>{a.d(t,{Z:()=>l});var n=a(7294),r=a(7275);a(3751);const l=({content:e,children:t})=>n.createElement(r.ZP,{content:e},t)},2119:(e,t,a)=>{a.d(t,{B:()=>s});var n=a(7294),r=a(6974);const l=(e,t,a)=>{const n={},r=new URLSearchParams(t);return Object.entries(e).forEach((([e,t])=>{const l=a[e]||String;n[e]=l(r.get(e)||t)})),n},s=(e,t={})=>{const a=(0,r.TH)(),s=(0,r.s0)(),o=(0,n.useMemo)((()=>l(e,a.search,t)),[e,a.search,t]),[i,c]=(0,n.useState)(o);return(0,n.useEffect)((()=>{const n=l(e,a.search,t);JSON.stringify(n)!==JSON.stringify(i)&&c(n)}),[a.search,i,e,t]),[i,t=>{if(JSON.stringify(t)===JSON.stringify(i))return;const n=new URLSearchParams(a.search);let r=!1;Object.entries(e).forEach((([e,a])=>{const l=e in t?t[e]:a;t[e]!==i[e]&&(n.set(e,String(l)),l===a&&n.delete(e),r=!0)})),r&&(a.search=n.toString(),s(a))}]}},964:(e,t,a)=>{a.d(t,{Z:()=>r});var n=a(6974);const r=()=>{const e=(0,n.TH)();let{pathname:t}=e;t.trim().endsWith("/")&&(t=t.trim().slice(0,-1));const a=t.split("/");return null==a?void 0:a[a.length-1]}},8920:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var n=a(7294),r=a(8110),l=a(964),s=a(402),o=a(1699),i=a(4821),c=a(3415),m=a(9711);const u=({data:e})=>{var t,a,r,l,s,o,i,u,d,g,p,b,v,f;return n.createElement("section",null,n.createElement("div",{className:"vf-stack"},n.createElement("details",{open:!0},n.createElement("summary",null,n.createElement("b",null,"Description")),n.createElement(c.Z,{list:[{key:"Study",value:(null===(r=null===(a=null===(t=e.relationships)||void 0===t?void 0:t.study)||void 0===a?void 0:a.data)||void 0===r?void 0:r.id)&&(()=>n.createElement(m.rU,{to:`/studies/${e.relationships.study.data.id}`},e.relationships.study.data.id))},{key:"Sample",value:(null===(o=null===(s=null===(l=e.relationships)||void 0===l?void 0:l.sample)||void 0===s?void 0:s.data)||void 0===o?void 0:o.id)&&(()=>n.createElement(m.rU,{to:`/samples/${e.relationships.sample.data.id}`},e.relationships.sample.data.id))},{key:"Assembly",value:(null===(d=null===(u=null===(i=e.relationships)||void 0===i?void 0:i.assembly)||void 0===u?void 0:u.data)||void 0===d?void 0:d.id)&&(f=e.attributes["experiment-type"],["assembly","hybrid_assembly","long_reads_assembly"].includes(f))&&(()=>n.createElement(m.rU,{to:`/assemblies/${e.relationships.assembly.data.id}`},e.relationships.assembly.data.id))},{key:"Run",value:(null===(b=null===(p=null===(g=e.relationships)||void 0===g?void 0:g.run)||void 0===p?void 0:p.data)||void 0===b?void 0:b.id)&&(()=>n.createElement(m.rU,{to:`/runs/${e.relationships.run.data.id}`},e.relationships.run.data.id))},{key:"Pipeline version",value:(null===(v=e.attributes)||void 0===v?void 0:v["pipeline-version"])&&(()=>n.createElement(m.rU,{to:`/pipelines/${e.attributes["pipeline-version"]}`},e.attributes["pipeline-version"]))}].filter((({value:e})=>!!e))})),n.createElement("details",{open:!0},n.createElement("summary",null,n.createElement("b",null,"Experiment details")),n.createElement(c.Z,{list:[{key:"Experiment type",value:e.attributes["experiment-type"]},{key:"Instrument model",value:e.attributes["instrument-model"]},{key:"Instrument platform",value:e.attributes["instrument-platform"]}].filter((({value:e})=>!!e))}))))};var d=a(7838),g=a(8840),p=a(5708),b=a.n(p);const v=({analysisData:e,summaryData:t})=>{var a;const r=(0,n.useRef)(null),l="assembly"===e.attributes["experiment-type"],s=l?"contigs":"reads",o=l?"Contigs":"Reads",i=[0,0,0,0,0],c=[0,0,0,0,0],m=[0,0,0,0,0],u={};((null===(a=e.attributes)||void 0===a?void 0:a["analysis-summary"])||[]).forEach((({key:e,value:t})=>{u[e]=t})),m[4]=Number(t.sequence_count),i[0]=Number(u["Submitted nucleotide sequences"]),i[1]=Number(u["Nucleotide sequences after format-specific filtering"]),i[2]=Number(u["Nucleotide sequences after length filtering"]),i[3]=Number(u["Nucleotide sequences after undetermined bases filtering"]),c[2]=i[1]-i[2],c[1]=i[0]-i[1],c[4]=i[3]-i[4]-m[4];const d={chart:{type:"bar",height:240},title:{text:`Number of sequence ${s} per QC step`},yAxis:{min:0,title:{text:"Count"}},xAxis:{categories:[`Initial ${s}`,"Trimming","Length filtering","Ambiguous base filtering",`${o} subsampled for QC analysis`]},plotOptions:{series:{stacking:"normal"}},credits:{enabled:!1},series:[{name:`${o} filtered out`,data:c,color:"#CCCCD3"},{name:`${o} remaining`,data:i,color:"#058DC7"},{name:`${o} after sampling`,data:m,color:"#8dc7c7"}]};return n.createElement(b(),{highcharts:g,options:d,ref:r})},f=({analysisData:e,summaryData:t})=>{const a=(0,n.useRef)(null),i=(0,l.Z)(),{data:c,loading:m,error:u}=(0,r.Z)(`analyses/${i}/seq-length`,{},{},d.B5.TSV);if(m)return n.createElement(s.Z,{size:"large"});if(u)return n.createElement(o.Z,{error:u});if(!c)return n.createElement(s.Z,null);const p=c.map((([e,t])=>[Number(e),Number(t)])),v=Math.max(...p.map((([e])=>e))),f="assembly"===e.attributes["experiment-type"],h=f?"Contigs":"Reads",E={chart:{marginLeft:78,style:{fontFamily:"Helvetica"},zoomType:"x"},title:{text:`${h} length histogram`,style:{fontSize:16,fontWeight:"bold"}},yAxis:{title:{text:"Number of "+(f?"contigs":"reads")}},xAxis:{min:0,max:100*(Math.floor(v/100)+1),plotBands:null===t?[]:[{from:Number(t.average_length)-Number(t.standard_deviation_length),to:Number(t.average_length)+Number(t.standard_deviation_length),color:"rgba(128, 128, 128, .2)",label:{text:`Standard Deviation<br/>Â±${Number(t.standard_deviation_length).toFixed(2)}`,style:{color:"#666666",fontSize:"0.8em"}}}]},series:[{name:h,data:p,color:"#058dc7"}],legend:{enabled:!1},credits:!1,navigation:{buttonOptions:{height:32,width:32,symbolX:16,symbolY:16,y:-10}}};return n.createElement(b(),{highcharts:g,options:E,ref:a})},h=()=>{const e=(0,n.useRef)(null),t=(0,l.Z)(),{data:a,loading:i,error:c}=(0,r.Z)(`analyses/${t}/nucleotide-distribution`,{},{},d.B5.TSV);if(i)return n.createElement(s.Z,{size:"large"});if(c)return n.createElement(o.Z,{error:c});if(!a)return n.createElement(s.Z,null);const m={pos:[],A:[],G:[],T:[],C:[],N:[]},u={A:"rgb(16, 150, 24)",G:"rgb(255, 153, 0)",C:"rgb(51, 102, 204)",T:"rgb(220, 57, 18)",N:"rgb(138, 65, 23)"},p=a[0];a.slice(1).forEach((e=>{e.forEach(((e,t)=>{m[p[t]].push(Number(e))}))}));const v={chart:{type:"area",style:{fontFamily:"Helvetica"}},title:{text:"Nucleotide position histogram",style:{fontSize:16,fontWeight:"bold"}},xAxis:{categories:m.pos,tickmarkPlacement:"on",title:{enabled:!1}},yAxis:{min:0,max:100,title:{enabled:!1}},plotOptions:{area:{stacking:"normal",lineColor:"#666666",lineWidth:1,marker:{lineWidth:1,lineColor:"#666666"}}},tooltip:{shared:!0},series:["A","T","C","G","N"].map((e=>({name:e,data:m[e],color:u[e]}))),credits:!1,navigation:{buttonOptions:{height:32,width:32,symbolX:16,symbolY:16,y:-10}}};return n.createElement(b(),{highcharts:g,options:v,ref:e})},E=({analysisData:e,summaryData:t})=>{const a=(0,n.useRef)(null),i=(0,l.Z)(),{data:c,loading:m,error:u}=(0,r.Z)(`analyses/${i}/gc-distribution`,{},{},d.B5.TSV);if(m)return n.createElement(s.Z,{size:"large"});if(u)return n.createElement(o.Z,{error:u});if(!c)return n.createElement(s.Z,null);const p=c.map((([e,t])=>[Number(e),Number(t)])),v="assembly"===e.attributes["experiment-type"],f=v?"Contigs":"Reads",h={chart:{style:{fontFamily:"Helvetica"},zoomType:"x"},title:{text:`${f} GC distribution`,style:{fontSize:16,fontWeight:"bold"}},yAxis:{title:{text:"Number of "+(v?"contigs":"reads")}},xAxis:{min:0,max:100,plotBands:null===t?[]:[{from:Number(t.average_gc_content)-Number(t.standard_deviation_gc_content),to:Number(t.average_gc_content)+Number(t.standard_deviation_gc_content),color:"rgba(128, 128, 128, .2)",borderColor:"#000000",label:{text:`Standard Deviation<br/>Â±${Number(t.standard_deviation_gc_content).toFixed(2)}`,style:{color:"#666666",fontSize:"0.8em"}}}]},series:[{name:f,data:p,color:"#058dc7"}],legend:{enabled:!1},credits:!1,navigation:{buttonOptions:{height:32,width:32,symbolX:16,symbolY:16,y:-10}}};return n.createElement(b(),{highcharts:g,options:h,ref:a})},y=({summaryData:e})=>{const t=(0,n.useRef)(null),a={chart:{type:"bar",marginTop:0,height:120},title:!1,xAxis:{categories:["Minimum","Average","Maximum"],title:{enabled:!1},lineColor:"#595959",tickColor:""},yAxis:{min:0,max:100*(Math.floor(Number(e.length_max)/100)+1),title:{text:"Sequence length (bp)"},plotBands:[{from:Number(e.average_length)-Number(e.standard_deviation_length),to:e.average_length+Number(e.standard_deviation_length),color:"rgba(128, 128, 128, .2)"}]},plotOptions:{series:{grouping:!1,shadow:!1,borderWidth:0}},series:[{name:"Length",data:[{y:Number(e.length_min),x:0,color:"rgb(114, 191, 63)"},{y:Number(e.average_length),x:1,color:"rgb(63, 114, 191)"},{y:Number(e.length_max),x:2,color:"rgb(114, 63, 191)"}],pointPadding:-.2,tooltip:{pointFormatter(){return`<span style="color:${this.color}">â</span> ${this.category}: <b>${this.y.toFixed(2)}</b><br/>`}}}],legend:{enabled:!1},credits:!1,navigation:{buttonOptions:{height:32,width:32,symbolX:16,symbolY:16,y:-10}},exporting:{enabled:!1}};return n.createElement(b(),{highcharts:g,options:a,ref:t})},_=({summaryData:e})=>{const t=(0,n.useRef)(null),a={chart:{type:"bar",marginTop:0,height:150},title:!1,xAxis:{categories:["Content"],title:{enabled:!1},lineColor:"#595959",tickColor:""},yAxis:{min:0,max:100,title:{enabled:!1},plotBands:[{from:Number(e.average_gc_content)-Number(e.standard_deviation_gc_content),to:Number(e.average_gc_content)+Number(e.standard_deviation_gc_content),color:"rgba(128, 128, 128, .2)"}]},plotOptions:{series:{grouping:!1,shadow:!1,borderWidth:0}},series:[{name:"GC content",pointPadding:.25,color:"rgb(63, 114, 191)",tooltip:{pointFormatter(){return`<span style="color:${this.color}">â</span> ${this.series.name}: <b>${this.y.toFixed(2)}%</b><br/>`}},data:[Number(e.average_gc_content)]},{name:"AT content",color:"rgb(114, 63, 191)",pointPadding:.25,threshold:Number(e.average_gc_content),tooltip:{pointFormatter(){const t=(100-Number(e.average_gc_content)).toFixed(2);return`\n              <span style="color:${this.color}">â</span>\n              ${this.series.name}: <b>${t}%</b>\n              <br/>`}},data:[100]}],credits:!1,navigation:{buttonOptions:{height:32,width:32,symbolX:16,symbolY:16,y:-10}},exporting:{enabled:!1}};return n.createElement(b(),{highcharts:g,options:a,ref:t})},N=({analysisData:e})=>{const t=(0,l.Z)(),{data:a,loading:i,error:c}=(0,r.Z)(`analyses/${t}/summary`,{},{},d.B5.TSV);if(i)return n.createElement(s.Z,{size:"large"});if(c)return n.createElement(o.Z,{error:c});if(!a)return n.createElement(s.Z,null);const m=Object.fromEntries(a),u="assembly"===e.attributes["experiment-type"],g=u?"contig":"read",p=u?"contigs":"reads";return n.createElement("div",{className:"vf-stack vf-stack--200"},n.createElement("p",null,"The chart below shows the number of ",p," which pass the quality control steps in the pipeline. Paired-end sequences may have been merged, in which case the initial number of ",p," may differ from the number given by ENA."),n.createElement(v,{analysisData:e,summaryData:m}),Number(e.attributes["pipeline-version"])>2&&n.createElement(n.Fragment,null,n.createElement("p",null,"The histograms below show the distributions of sequence lengths (left) and percentage GC content (right) for the sequences having passed quality control. Note that for large files, the distributions were compiled from a random subset of 2 million",p,". The standard deviations are shown on each plot. The bar chart underneath each graph indicates the minimum, mean and maximum length and mean GC and AT content, respectively."),n.createElement("div",{className:"vf-grid vf-grid__col-2"},n.createElement("div",{className:"vf-stack"},n.createElement(f,{analysisData:e,summaryData:m}),n.createElement(y,{summaryData:m})),n.createElement("div",{className:"vf-stack"},n.createElement(E,{analysisData:e,summaryData:m}),n.createElement(_,{summaryData:m}))),n.createElement("p",null,'The graph below show the relative abundance of nucletotides (A, C, G, T, or ambiguous base "N") at each position starting from the beginning of each ',g," up to the first 500 base pairs."),n.createElement(h,null)))};var w=a(6050),x=a(4897),k=a.n(x),C=a(8696),P=a(7565),$=a(2054);const Z=n.createContext({contigsQueryData:{data:null,loading:!1,error:null},queryParameters:{},setQueryParameters:$.Z});var S=a(2069);const O=e=>e.split("cursor=")[1].split("&")[0],F=({paginationLinks:e,handleCursor:t})=>{const a=!!e.prev,r=!!e.next;return n.createElement("section",{className:"mg-table-footer"},n.createElement("nav",{className:"vf-pagination","aria-label":"Pagination"},n.createElement("ul",{className:"vf-pagination__list"},n.createElement("li",{className:"vf-pagination__item vf-pagination__item--previous-page"},n.createElement("button",{disabled:!a,type:"button",onClick:()=>t(O(e.prev)),className:"vf-button vf-button--link vf-pagination__link"},"Previous",n.createElement("span",{className:"vf-u-sr-only"}," page"))),n.createElement("li",{className:"vf-pagination__item vf-pagination__item--next-page"},n.createElement("button",{disabled:!r,type:"button",onClick:()=>t(O(e.next)),className:"vf-button vf-button--link vf-pagination__link"},"Next",n.createElement("span",{className:"vf-u-sr-only"}," page"))))))},T=({annotationType:e,present:t})=>{let a;const r=e[0].toUpperCase();switch(e){case"cog":a="#3b6fb6";break;case"kegg":a="#18974c";break;case"pfam":a="#193f90";break;case"interpro":a="#734595";break;case"go":a="#f49e17";break;case"antismash":a="#b65417";break;default:a="#8d8f8e"}t||(a+="55");const l=`${t?"Has":"Doesât have"} ${e} annotations`;return n.createElement(P.Z,{content:l},n.createElement("div",{className:"emg-contig-feature-flag vf-text vf-text-body--4",style:{borderColor:a,color:a}},r))},D=()=>{const{contigsQueryData:e,setQueryParameters:t,queryParameters:a}=(0,n.useContext)(Z),{data:r,loading:l,error:i}=e||{},c=(0,n.useMemo)((()=>[{id:"contig_id",Header:"Name",accessor:e=>e.attributes["contig-id"],Cell:({cell:e})=>n.createElement("button",{className:"vf-button vf-button--link vf-button--sm contig-id-button",type:"button",onClick:()=>t(Object.assign(Object.assign({},a),{selectedContig:e.value}))},e.value,n.createElement(S.Z,null))},{id:"length",Header:"Length (bp)",accessor:e=>e.attributes.length,Cell:({cell:e})=>n.createElement("span",null,e.value)},{id:"coverage",Header:"Coverage",accessor:e=>e.attributes.coverage,Cell:({cell:e})=>n.createElement("span",null,e.value)},{id:"features",Header:"Features",accessor:e=>e.attributes,Cell:({cell:e})=>{const t=Object.entries(e.value).filter((([e])=>e.startsWith("has-"))).map((([e,t])=>n.createElement(T,{key:e,annotationType:e.substring(4),present:!!t})));return n.createElement("div",{className:"emg-contig-feature-flags"},t)}}]),[a,t]);return l&&!r?n.createElement(s.Z,{size:"large"}):i||!r?n.createElement(o.Z,{error:i}):n.createElement("div",null,n.createElement(C.Z,{cols:c,data:r,showPagination:!1,title:()=>n.createElement(n.Fragment,null,"Assembly Contigs",n.createElement("span",{className:"mg-number"},r.meta.pagination.count)),initialPage:0,className:"mg-contigs-table",namespace:"contigs_",loading:l}),n.createElement(F,{paginationLinks:r.links,handleCursor:e=>t(Object.assign(Object.assign({},a),{contigsPageCursor:e}))}))};var G=a(2119),j=a(7927),B=a(3253),z=a.n(B),A=a(4063);class I extends A.default{constructor(){super("emgGFF"),this.version(1).stores({gffs:"++id, name"})}}const R=new I;var V=a(1039),q=a(9521);const H=({cols:e,data:t,className:a="",sortable:r=!1,loading:l=!1,isStale:o=!1})=>{const{getTableProps:i,getTableBodyProps:c,headerGroups:m,rows:u,prepareRow:d}=(0,q.useTable)({columns:e,data:t},q.useSortBy),g=(0,n.useRef)(null);return l&&!o?n.createElement(s.Z,{size:"small"}):n.createElement("section",null,n.createElement("div",{className:"mg-table-overlay-container"},n.createElement("div",{className:l&&o?"mg-table-overlay":void 0}),n.createElement("table",Object.assign({},i,{className:`vf-table--striped mg-table ${a}`,ref:g}),n.createElement("thead",{className:"vf-table__header"},m.map((e=>n.createElement("tr",Object.assign({},e.getHeaderGroupProps(),{className:"vf-table__row"}),e.headers.map((e=>n.createElement("th",Object.assign({},r&&e.canSort?e.getHeaderProps(e.getSortByToggleProps()):{key:e.id},{className:"vf-table__heading"}),e.render("Header"),r&&e.canSort&&n.createElement(n.Fragment,null,"Â ",n.createElement("span",null,e.isSorted?e.isSortedDesc?n.createElement("i",{className:"icon icon-common icon-sort-down"}):n.createElement("i",{className:"icon icon-common icon-sort-up"}):n.createElement("i",{className:"icon icon-common icon-sort"})))))))))),n.createElement("tbody",Object.assign({},c(),{className:"vf-table__body"}),u.map((e=>(d(e),n.createElement("tr",Object.assign({},e.getRowProps(),{className:"vf-table__row"}),e.cells.map((e=>n.createElement("td",Object.assign({},e.getCellProps(),{className:"vf-table__cell"}),e.render("Cell"))))))))))))};var M=function(e,t,a,n){return new(a||(a=Promise))((function(r,l){function s(e){try{i(n.next(e))}catch(e){l(e)}}function o(e){try{i(n.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(s,o)}i((n=n.apply(e,t||[])).next())}))};z().setAppElement("#root");const L={overlay:{zIndex:1e4},content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)"}},U=({handleGFFTrack:e})=>{const[t,a]=(0,n.useState)(!1),r=(0,n.useRef)(null),[l,s]=(0,n.useState)(null),[o,i]=(0,G.B)({gffComparisonId:null},{gffComparisonId:Number}),c=(0,V.useLiveQuery)((()=>R.gffs.toArray()));(0,n.useEffect)((()=>{o.gffComparisonId&&R.gffs.get(o.gffComparisonId).then((t=>{void 0===t?i({gffComparisonId:void 0}):e(t)}))}),[o,e,i]);const m=(0,n.useMemo)((()=>[{id:"name",Header:"GFF Filename",accessor:e=>e.name,Cell:({cell:e,row:t})=>n.createElement("button",{className:"vf-button vf-button--link vf-button--sm contig-id-button",type:"button",onClick:()=>M(void 0,void 0,void 0,(function*(){const e=yield R.gffs.get(t.original.id);i(Object.assign(Object.assign({},o),{gffComparisonId:e.id})),a(!1)}))},e.value,n.createElement(S.Z,null))},{id:"size",Header:"File size (Kb)",accessor:e=>e.size,Cell:({cell:e})=>n.createElement("span",null,e.value)},{id:"added",Header:"Added",accessor:e=>e.added,Cell:({cell:e})=>{var t;return n.createElement("span",null,null===(t=e.value)||void 0===t?void 0:t.toLocaleString())}},{id:"del",Header:"Remove",accessor:e=>e.id,Cell:({cell:e})=>n.createElement("button",{className:"vf-button vf-button--link vf-button--sm",type:"button",onClick:()=>R.gffs.delete(e.value)},"Remove")}]),[o,i]);function u(e){return M(this,void 0,void 0,(function*(){if(!e)return;const t=yield function(e){return t=this,a=void 0,r=function*(){return new Promise((t=>{const a=new FileReader;a.onload=()=>{const e=a.result;t(btoa(e))},a.readAsText(e)}))},new((n=void 0)||(n=Promise))((function(e,l){function s(e){try{i(r.next(e))}catch(e){l(e)}}function o(e){try{i(r.throw(e))}catch(e){l(e)}}function i(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n((function(e){e(a)}))).then(s,o)}i((r=r.apply(t,a||[])).next())}));var t,a,n,r}(e);try{yield R.gffs.add({name:e.name,size:e.size,added:new Date(Date.now()),encodedGFF:t}),s(null)}catch(e){s(`GFF upload error: ${e}`)}}))}return n.createElement("div",null,n.createElement(z(),{isOpen:t,onRequestClose:()=>a(!1),contentLabel:"Example Modal",style:L},n.createElement("div",{className:"vf-stack vf-stack--800"},n.createElement("h1",null,"Compare a GFF to the contig"),n.createElement("form",{className:"vf-stack vf-stack--400",action:"#",method:"get"},n.createElement("div",{className:"vf-form__item vf-stack"},n.createElement("label",{htmlFor:"upload-picker",className:"vf-form__label vf-form__label--required"},n.createElement("h2",null,"Upload a GFF file from your computer")),n.createElement("p",{className:"vf-form__helper"},"The GFF will be stored in your browser, not sent to MGnify servers."),n.createElement("input",{type:"file",id:"upload-picker",hidden:!0,ref:r,onChange:e=>u(e.target.files[0]),accept:".gff,.gff3"}),n.createElement("button",{className:"vf-button vf-button--primary vf-button--sm",onClick:()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.click()},type:"button"},"Browse for file..."),l&&n.createElement("p",{className:"vf-form__helper vf-form__helper--error"},l))),n.createElement("div",{className:"vf-stack vf-stack--200"},n.createElement("h2",null,"Previously uploaded GFFs"),n.createElement("p",{className:"vf-form__helper"},"Click the GFFâs name to view it in the browser"),n.createElement(H,{cols:m,data:c})))),n.createElement("button",{className:"vf-button vf-button--secondary vf-button--sm",type:"button",onClick:()=>a(!0)},"Load a GFF"))};var W=a(7762),Q=a(2379);const J=({contig:e})=>{const t=(0,l.Z)(),{config:a}=(0,n.useContext)(w.Z),r=e.attributes["contig-id"],i=`${a.api}analyses/${e.attributes.accession}/contigs/${r}`,{data:c,loading:m,error:u}=(0,d.ZP)(i,d.B5.TXT),g=e.attributes["has-antismash"],p=e.attributes["contig-name"],[b,v]=(0,n.useState)(null),f=(0,n.useCallback)((e=>{const l={showChromosomeWidget:!1,showTrackLabelButton:!0,showTrackLabels:!0,showCenterGuide:!1,reference:{indexed:!1,fastaURL:i},tracks:[{name:p,type:"mgnify-annotation",format:"gff3",url:`${a.api}analyses/${t}/contigs/${r}/annotations`,displayMode:"EXPANDED",label:"Functional annotation",colorAttributes:[["Default",""],["COG","COG"],["GO","GO"],["KEGG","KEGG"],["Pfam","Pfam"],["InterPro","InterPro"]],colorBy:void 0,defaultColour:void 0,labelBy:void 0}],showLegend:!0,legendParent:"#contig"};g&&l.tracks.push({colorAttributes:[],name:void 0,type:"mgnify-annotation",format:"gff3",displayMode:"EXPANDED",url:`${a.api}analyses/${t}/contigs/${r}/annotations?antismash=True`,label:"antiSMASH",colorBy:"as_type",defaultColour:"#BEBEBE",labelBy:"as_gene_clusters"}),null!==e&&k().createBrowser(e,l).then((e=>{e.on("trackclick",((e,t)=>W.renderToString(n.createElement(Q.Z,{data:t})))),v(e)}))}),[t,g,a.api,r,p,i]);return m?n.createElement(s.Z,{size:"small"}):u?n.createElement(o.Z,{error:u}):c?n.createElement("div",{id:"contig"},n.createElement("div",{ref:f}),n.createElement(U,{handleGFFTrack:e=>{b.findTracks("name",e.name).length||b.loadTrack({name:e.name,type:"annotation",url:`data:application/octet-stream;base64,${e.encodedGFF}`,format:"gff3",filterTypes:[]})}})):n.createElement(s.Z,null)},X=()=>{const e=(0,l.Z)(),[t,a]=(0,G.B)({contigsPageCursor:"",selectedContig:""}),{data:i,loading:c,error:m}=(0,r.Z)(`analyses/${e}/contigs`,{cursor:t.contigsPageCursor},{}),u=(0,n.useMemo)((()=>({contigsQueryData:{data:i,loading:c,error:m},queryParameters:t,setQueryParameters:a})),[i,m,c,t,a]),d=(0,n.useMemo)((()=>{var e,a,n;let r;if(!i)return null;const l=t.selectedContig||(null===(n=null===(a=null===(e=i.data)||void 0===e?void 0:e[0])||void 0===a?void 0:a.attributes)||void 0===n?void 0:n["contig-id"]);return l&&(r=(0,j.Z)(i.data,(e=>e.attributes["contig-id"]===l)),r)?r:null}),[i,t]);return(0,n.useEffect)((()=>{d&&d.attributes["contig-id"]!==t.selectedContig&&a(Object.assign(Object.assign({},t),{selectedContig:d.attributes["contig-id"]}))})),(0,n.useEffect)((()=>{if(t.selectedContig&&i&&!d){const{selectedContig:e}=t,n=function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(a[n[r]]=e[n[r]])}return a}(t,["selectedContig"]);a(n)}}),[i,d,t,a]),c?n.createElement(s.Z,{size:"large"}):m?n.createElement(o.Z,{error:m}):i&&d?n.createElement("div",{className:"vf-stack vf-stack--800"},n.createElement(Z.Provider,{value:u},n.createElement("section",null,n.createElement("div",{className:"vf-stack"},n.createElement("details",{open:!0},n.createElement("summary",null,n.createElement("b",null,"Contig browser")),n.createElement(J,{contig:d})))),n.createElement("section",null,n.createElement(D,null)))):n.createElement(s.Z,null)};var K=a(1274);const Y=e=>"assembly"===e.attributes["experiment-type"],ee=e=>Number(e.attributes["pipeline-version"])>=5,te=e=>"amplicon"!==e.attributes["experiment-type"],ae=()=>{const e=(0,l.Z)(),{data:t,loading:a,error:c}=(0,r.Z)(`analyses/${e}`,{include:"downloads"});if(a)return n.createElement(s.Z,{size:"large"});if(c)return n.createElement(o.Z,{error:c});if(!t)return n.createElement(s.Z,null);const{data:d,included:g}=t,p=[{label:"Overview",to:"#overview"},{label:"Quality control",to:"#qc"},{label:"Taxonomic analysis",to:"#taxonomic"},te(d)?{label:"Functional analysis",to:"#functional"}:null,(b=g,b.some((e=>{var t;return"Statistics"===(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t["group-type"])}))?{label:"Abundance and comparison",to:"#abundance"}:null),Y(d)&&ee(d)?{label:"Pathways/Systems",to:"#path-systems"}:null,Y(d)&&ee(d)?{label:"Contig Viewer",to:"#contigs-viewer"}:null,{label:"Download",to:"#download"}].filter(Boolean);var b;return n.createElement("section",{className:"vf-content"},n.createElement("h2",null,"Analysis ",e),n.createElement("h4",null,n.createElement(m.rU,{to:Y(d)?`/assemblies/${d.relationships.assembly.data.id}`:`/runs/${d.relationships.run.data.id}`},"Other Analyses")),n.createElement(i.Z,{tabs:p}),n.createElement("section",{className:"vf-grid"},n.createElement("div",{className:"vf-stack vf-stack--200"},n.createElement(K.Z,{hash:"#overview",isDefault:!0},n.createElement(u,{data:d})),n.createElement(K.Z,{hash:"#qc"},n.createElement(N,{analysisData:d})),n.createElement(K.Z,{hash:"#contigs-viewer"},n.createElement(X,null)))))}}}]);
//# sourceMappingURL=176.6a52b81a.chunk.js.map