"use strict";(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[316],{5608:(e,t,a)=>{a.d(t,{Z:()=>u});var s=a(7294),r=a(9711),l=a(402),n=a(1699),i=a(8696),c=a(8110),o=a(964),m=a(2119);const u=({rootEndpoint:e})=>{var t,a;const u=(0,o.Z)(),[d]=(0,m.B)({"assembly-page":1,"assembly-page_size":10,"assembly-order":""},{"assembly-page":Number,"assembly-page_size":Number}),p=((e,t)=>"runs"===e?`runs/${t}/assemblies`:"assemblies")(e,u),{data:g,loading:b,error:v,isStale:E,downloadURL:f}=(0,c.Z)(p,{sample_accession:"samples"===e?u:void 0,page:d["assembly-page"],ordering:d["assembly-order"],page_size:d["assembly-page_size"]});if(b&&!E)return s.createElement(l.Z,{size:"small"});if(v||!g)return s.createElement(n.Z,{error:v});if(!g.data.length)return null;const h=[{Header:"Assembly ID",accessor:"id",Cell:({cell:e})=>s.createElement(r.rU,{to:`/assemblies/${e.value}`},e.value)},{Header:"Experiment type",accessor:"attributes.experiment-type"},{Header:"WGS ID",accessor:"attributes.wgs-accession"},{Header:"Legacy ID",accessor:"attributes.legacy-accession"},{Header:"Pipeline versions",accessor:"relationships.pipelines.data",Cell:({cell:e})=>e.value.map((({id:e})=>e)).join(", ")}],Z=((null===(a=null===(t=g.meta)||void 0===t?void 0:t.pagination)||void 0===a?void 0:a.count)||1)>10;return s.createElement(i.Z,{cols:h,data:g,initialPage:d["assembly-page"]-1,initialPageSize:10,className:"mg-assembly-table",loading:b,isStale:E,namespace:"assembly-",showPagination:Z,downloadURL:f})}},1274:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(7294),r=a(6974);const l=({hash:e,isDefault:t=!1,children:a})=>{const l=(0,r.TH)(),n=(0,r.s0)();return(0,s.useEffect)((()=>{""===l.hash&&""!==e&&t&&n(e,{replace:!0})})),l.hash===e?s.createElement(s.Fragment,null,a):null}},3518:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(7294),r=a(9711),l=a(402),n=a(1699),i=a(8696),c=a(1055),o=a(8110),m=a(964),u=a(2119),d=a(5058);const p=({rootEndpoint:e})=>{var t,a;const p=(0,m.Z)(),[g]=(0,u.B)({"studies-page":1,"studies-page_size":10,"studies-order":""},{"studies-page":Number,"studies-page_size":Number}),{data:b,loading:v,error:E,isStale:f,downloadURL:h}=(0,o.Z)(`${e}/${p}/studies`,{page:g["studies-page"],ordering:g["studies-order"],page_size:g["studies-page_size"]});if(v&&!f)return s.createElement(l.Z,{size:"small"});if(E||!b)return s.createElement(n.Z,{error:E});if(!b.data.length)return null;const Z=[{id:"biome_id",Header:"Biome",accessor:e=>{var t,a;return null===(a=null===(t=e.relationships.biomes.data)||void 0===t?void 0:t[0])||void 0===a?void 0:a.id},Cell:({cell:e})=>s.createElement("span",{className:`biome_icon icon_xs ${(0,d.G)(e.value)}`,style:{float:"initial"}})},{id:"study",Header:"Study accession",accessor:"id",Cell:({cell:e})=>s.createElement(r.rU,{to:`/studies/${e.value}`},e.value)},{Header:"Name",accessor:"attributes.study-name"},{Header:"Abstract",accessor:"attributes.study-abstract",Cell:({cell:e})=>s.createElement(c.Z,{text:e.value||""})},{Header:"Samples Count",accessor:"attributes.samples-count"},{id:"last_update",Header:"Last Updated",accessor:"attributes.last-update",Cell:({cell:e})=>new Date(e.value).toLocaleDateString()}],w=((null===(a=null===(t=b.meta)||void 0===t?void 0:t.pagination)||void 0===a?void 0:a.count)||1)>10;return s.createElement(i.Z,{cols:Z,data:b,initialPage:g["studies-page"]-1,initialPageSize:10,className:"mg-studies-table",loading:v,isStale:f,namespace:"studies-",showPagination:w,downloadURL:h})}},3415:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(7294);const r=({list:e})=>s.createElement("div",{className:"vf-grid vf-grid__col-2",style:{gridTemplateColumns:"1fr 2fr",rowGap:"0.5rem"}},e.map((({key:e,value:t})=>s.createElement(s.Fragment,{key:e},s.createElement("div",{style:{textAlign:"right"}},e,":"),s.createElement("div",null,"string"==typeof t?t:s.createElement(t,null))))))},4933:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(7294),r=a(7762),l=a(6529);const n=({sample:e})=>s.createElement("div",{className:"vf-box vf-box--easy"},s.createElement("h3",{className:"vf-box__heading"},s.createElement("a",{href:`../samples/${e.id}`},e.id)),s.createElement("p",{className:"vf-box__text"},e.attributes["sample-desc"])),i=({accessions:e})=>s.createElement("div",{className:"vf-box vf-box--easy"},s.createElement("h3",{className:"vf-box__heading"},"Samples on this geographical location"),s.createElement("ul",{className:"vf-list"},e.map((e=>s.createElement("li",{ref:e},s.createElement("a",{href:`../samples/${e}`},e)))))),c=({samples:e})=>{const t=(0,s.useRef)(),[a,c]=(0,s.useState)(null),o=(0,s.useRef)(null),m=(0,s.useRef)(new google.maps.InfoWindow),u=(0,s.useRef)(new google.maps.InfoWindow),d=(0,s.useRef)(new google.maps.LatLngBounds),p=(0,s.useRef)({});return(0,s.useEffect)((()=>{if(null===a){const e=new google.maps.Map(t.current,{maxZoom:10,minZoom:2});c(e)}}),[a]),(0,s.useEffect)((()=>{a&&e&&(o.current&&o.current.clearMarkers(),e.filter((({id:e})=>!(e in p.current))).forEach((e=>{const t={lat:e.attributes.latitude,lng:e.attributes.longitude},l=new google.maps.Marker({position:t,title:e.id});d.current.extend(t),l.addListener("click",(()=>{m.current.setContent(r.renderToString(s.createElement(n,{sample:e}))),m.current.open(a,l)})),p.current[e.id]=l})),o.current=new l.Z(a,Object.values(p.current),{imagePath:"https://raw.githubusercontent.com/googlemaps/js-markerclustererplus/master/images/m",maxZoom:10}),google.maps.event.addListener(o.current,"click",(function(e){this.prevZoom_+1<=this.getMaxZoom()||e.getSize()>=10||(u.current.setPosition(e.getCenter()),u.current.setContent(r.renderToString(s.createElement(i,{accessions:e.getMarkers().map((e=>e.getTitle()))}))),u.current.open(a))})),a.fitBounds(d.current))}),[a,e]),s.createElement("div",{ref:t,id:"map",style:{height:"100%"}})}},2069:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(7294),r=a(2245),l=a(7838),n=a(402),i=a(1699);const c=e=>e===r.Status.LOADING?s.createElement(n.Z,null):e===r.Status.FAILURE?s.createElement(i.Z,{error:{status:200,type:l.ZB.OtherError,error:e}}):null},4821:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(7294),r=a(6974),l=a(9711);const n=({tabs:e})=>{const t=(0,r.TH)();return s.createElement("div",{className:"vf-tabs mg-search-tabs"},s.createElement("ul",{className:"vf-tabs__list"},e.map((({label:e,to:a})=>s.createElement("li",{className:"vf-tabs__item",key:a},s.createElement(l.rU,{className:"vf-tabs__link "+(a===t.pathname||a.startsWith("#")&&a===t.hash||"#"===a&&""===t.hash?"is-active":""),to:a},"string"==typeof e?e:s.createElement(e,null)))))))}},1055:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(7294);const r=({text:e,maxLength:t=250})=>s.createElement(s.Fragment,null,e.substring(0,t),e.length>=t&&"...")},3943:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var s=a(7294),r=a(8110),l=a(964),n=a(402),i=a(1699),c=a(4821),o=a(2245),m=a(6050),u=a(4933),d=a(2069);const p=({samples:e})=>{const{config:t}=(0,s.useContext)(m.Z),a=e.filter((e=>{try{return 0!==Number(e.attributes.longitude)&&0!==Number(e.attributes.latitude)}catch(e){return!1}}));return s.createElement("div",{className:"mg-map-container"},s.createElement("div",{className:"mg-map-wrapper"},s.createElement(o.Wrapper,{apiKey:t.googleMapsKey,render:d.Z},s.createElement(u.Z,{samples:a}))),s.createElement("div",{className:"mg-map-progress"},0===a.length&&s.createElement("div",null,"⚠️ None of the samples have geolocation co-ordinates.")))};var g=a(5478),b=a(2531),v=a(5058),E=a(8101);const f=({data:e})=>{var t;const a=e.relationships.biome.data.id;return s.createElement("section",null,s.createElement("div",{className:"vf-grid"},s.createElement("div",null,s.createElement("h4",null,"Last updated:"," ",new Date(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t["last-update"]).toDateString()),s.createElement(g.Z,{label:"Description"},e.attributes["sample-desc"]),s.createElement(g.Z,{label:"External links"},s.createElement("ul",null,s.createElement("li",null,s.createElement(b.Z,{href:E.sn+e.attributes.accession},"ENA website (",e.attributes.accession,")")),s.createElement("li",null,s.createElement(b.Z,{href:`https://www.ebi.ac.uk/biosamples/samples/${e.attributes.biosample}`},"EBI biosample (",e.attributes.biosample,")")))),s.createElement(g.Z,{label:"Classification"},s.createElement("span",{className:`biome_icon icon_sm ${(0,v.G)(a)}`,style:{float:"initial"}}),a)),s.createElement(p,{samples:[e]})))};var h=a(3518),Z=a(9711),w=a(8696),y=a(2119);const N=()=>{const e=(0,l.Z)(),[t]=(0,y.B)({"runs-page":1,"runs-page_size":10,"runs-order":""},{"runs-page":Number,"runs-page_size":Number}),{data:a,loading:c,error:o,isStale:m,downloadURL:u}=(0,r.Z)(`samples/${e}/runs`,{page:t["runs-page"],ordering:t["runs-order"],page_size:t["runs-page_size"]});if(c&&!m)return s.createElement(n.Z,{size:"small"});if(o||!a)return s.createElement(i.Z,{error:o});const d=[{id:"run",Header:"Run ID",accessor:"id",Cell:({cell:e})=>s.createElement(Z.rU,{to:`/runs/${e.value}`},e.value)},{Header:"Experiment type",accessor:"attributes.experiment-type"},{Header:"Instrument model",accessor:"attributes.instrument-model"},{Header:"Instrument platform",accessor:"attributes.instrument-platform"},{Header:"pipeline versions",accessor:"relationships.pipelines.data",Cell:({cell:e})=>e.value.map((({id:e})=>e)).join(", ")}];return s.createElement(w.Z,{cols:d,data:a,initialPage:t["runs-page"]-1,initialPageSize:10,className:"mg-runs-table",loading:c,isStale:m,namespace:"runs-",downloadURL:u})};var _=a(5608),x=a(1274),S=a(3415);const k=[{label:"Sample metadata",to:"#"},{label:"Associated studies",to:"#studies"},{label:"Analysed associated runs",to:"#runs"},{label:"Analysed associated assemblies",to:"#assemblies"}],z=()=>{var e;const t=(0,l.Z)(),{data:a,loading:o,error:m}=(0,r.Z)(`samples/${t}`);if(o)return s.createElement(n.Z,{size:"large"});if(m)return s.createElement(i.Z,{error:m});if(!a)return s.createElement(n.Z,null);const{data:u}=a;return s.createElement("section",{className:"vf-content"},s.createElement("h2",null,"Sample overview (",t,")"),s.createElement("h3",null,"Sample ",u.attributes["sample-name"]),s.createElement("section",{className:"vf-grid"},s.createElement("div",{className:"vf-stack vf-stack--200"},s.createElement(f,{data:u}),s.createElement(c.Z,{tabs:k}),s.createElement("section",{className:"vf-grid"},s.createElement("div",{className:"vf-stack vf-stack--200"},s.createElement(x.Z,{hash:"",isDefault:!0},s.createElement(S.Z,{list:(null===(e=null==u?void 0:u.attributes)||void 0===e?void 0:e["sample-metadata"])||[]})),s.createElement(x.Z,{hash:"#studies"},s.createElement(h.Z,{rootEndpoint:"samples"})),s.createElement(x.Z,{hash:"#runs"},s.createElement(N,null)),s.createElement(x.Z,{hash:"#assemblies"},s.createElement(_.Z,{rootEndpoint:"samples"})))))))}},8101:(e,t,a)=>{a.d(t,{sn:()=>s,bV:()=>r,QD:()=>l,s8:()=>n,mL:()=>i,gM:()=>c});const s="https://www.ebi.ac.uk/ena/browser/view/",r=" https://img.jgi.doe.gov/cgi-bin/m/main.cgi?section=TaxonDetail&page=taxonDetail&taxon_oid=",l="https://www.ncbi.nlm.nih.gov/assembly/",n="https://www.ncbi.nlm.nih.gov/biosample/?term=",i="https://www.ncbi.nlm.nih.gov/bioproject/",c="https://www.patricbrc.org/view/Genome/"}}]);
//# sourceMappingURL=316.e297b3e5.chunk.js.map