"use strict";(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[336],{6341:(e,t,a)=>{a.d(t,{p0:()=>r,Sf:()=>s,ZP:()=>o});var l=a(7294),n=a(4018);const i=JSON.parse('[{"title":"MGnify: the microbiome analysis resource in 2020","journal":"Nucleic Acids Research","year":2019,"link":"https://academic.oup.com/nar/article/48/D1/D570/5614179","doi":"10.1093/nar/gkz1035","authors":"Mitchell AL, Almeida A, Beracochea M, Boland M, Burgin J, Cochrane G, Crusoe MR, Kale V, Potter SC, Richardson LJ, Sakharova E, Scheremetjew M, Korobeynikov A, Shlemov A, Kunyavskaya O, Lapidus A and Finn RD","recent":true,"main":true},{"title":"A new genomic blueprint of the human gut microbiota","journal":"Nature","year":2019,"link":"https://www.nature.com/articles/s41586-019-0965-1","doi":"10.1038/s41586-019-0965-1","authors":"Almeida A, Mitchell AL, Boland M, Forster SC, Gloor GB, Tarkowska A, Lawley TD and Finn RD","recent":true},{"title":"Human gastrointestinal bacteria genome and culture collection","journal":"Nature Biotechnology","year":2019,"link":"https://www.nature.com/articles/s41587-018-0009-7","doi":"10.1038/s41587-018-0009-7","authors":"Forster SC, Kumar N, Anonye BO, Almeida A, Viciani E, Stares MD, Dunn M, Mkandawire TT, Zhu A, Browne HP, Shao Y, Pike LJ, Louie T, Mitchell AL, Neville BA, Finn RD, Lawley TD","recent":true},{"title":"Benchmarking taxonomic assignments based on 16S rRNA gene profiling of the microbiota from commonly sampled environments","journal":"GigaScience","year":2017,"link":"https://doi.org/10.1093/gigascience/giy054","doi":"10.1093/gigascience/giy054","authors":"Almeida A, Mitchell AL, Tarkowska A, Finn RD.","recent":true},{"title":"EBI Metagenomics in 2017: enriching the analysis of microbial communities, from sequence reads to assemblies","journal":"Nucleic Acids Research","year":2017,"link":"https://doi.org/10.1093/nar/gkx967","doi":"10.1093/nar/gkx967","authors":"Mitchell AL, Scheremetjew M, Denise H, Potter S, Tarkowska A, Qureshi M, Salazar GA, Pesseat S, Boland M, Hunter FMI, ten Hoopen P, Alako B, Amid C, Wilkinson DJ, Curtis TP, Cochrane G and Finn RD"},{"title":"EBI metagenomics in 2016 - an expanding and evolving resource for the analysis and archiving of metagenomic data","journal":"Nucleic Acids Research","year":2015,"link":"http://nar.oxfordjournals.org/content/44/D1/D595.full","doi":"10.1093/nar/gkv1195","authors":"Mitchell AL, Bucchini F, Cochrane G, Denise H, ten Hoopen P, Fraser M, Pesseat S, Potter S, Scheremetjew M, Sterk P and Finn RD"},{"title":"EBI metagenomics - a new resource for the analysis and archiving of metagenomic data","journal":"Nucleic Acids Research","year":2013,"link":"http://dx.doi.org/10.1093/nar/gkt961","doi":"10.1093/nar/gkt961","authors":"Hunter S, Corbett M, Denise H, Fraser M, Gonzalez-Beltran A, Hunter C, Jones P, Leinonen R, McAnulla C, Maguire E, Maslen J, Mitchell AL, Nuka G, Oisel A, Pesseat S, Radhakrishnan R, Rocca-Serra P, Scheremetjew M, Sterk P, Vaughan D, Cochrane G, Field D and Sansone SA"}]'),s=({title:e,journal:t,year:a,link:n,doi:i,authors:s,maxAuthorsLength:r})=>{const o=r&&s.length>r?((e,t)=>{const a=e.slice(0,t).split(",");return a.pop(),a.push(" et al."),a.join(",")})(s,r):s;return l.createElement("section",{className:"mg-pub"},l.createElement("span",{className:"mg-pub-title"},e,".")," ",l.createElement("span",{className:"mg-pub-journal"},t)," (",l.createElement("span",{className:"mg-pub-year"},a),")"," ",l.createElement("span",{className:"mg-pub-doi"},"doi:",l.createElement("a",{title:e,href:n,className:"mg-ext"},i)),l.createElement("div",{className:"mg-pub-authors"},o,"."))},r=()=>{var e;const t=null===(e=i.filter((e=>e.main)))||void 0===e?void 0:e[0];return l.createElement("div",{className:"embl-grid | vf-content"},l.createElement("div",{className:"vf-section-header mg-pub-section-header"},l.createElement("img",{alt:"Cover of the journal",src:n,className:"mg-pub-cover"})),l.createElement("div",null,l.createElement("p",null,"To cite MGnify, please refer to the following publication:"),t&&l.createElement(s,{title:t.title,journal:t.journal,year:t.year,link:t.link,doi:t.doi,authors:t.authors})))},o=()=>{const[e,t]=(0,l.useState)(!1);return l.createElement("section",{className:"mg-pub-section"},i.filter((t=>e||t.recent)).map((e=>l.createElement("article",{key:e.doi},l.createElement(s,{title:e.title,journal:e.journal,year:e.year,link:e.link,doi:e.doi,authors:e.authors})))),l.createElement("div",{className:"mg-right"},l.createElement("button",{type:"button",className:"vf-button vf-button--sm",onClick:()=>t(!e)},e?"Less":"More"," publications")))}},5478:(e,t,a)=>{a.d(t,{Z:()=>n});var l=a(7294);const n=({label:e,theme:t="primary",children:a})=>l.createElement("div",{className:"vf-grid"},l.createElement("div",{className:`vf-box vf-box--easy vf-box-theme--${t}`},l.createElement("h5",{className:"vf-box__heading"},e),l.createElement("div",{className:"vf-box__text"},a)))},2531:(e,t,a)=>{a.d(t,{Z:()=>n});var l=a(7294);const n=({href:e,id:t,title:a,children:n})=>l.createElement("a",{href:e,title:a,id:t,target:"_blank",rel:"noreferrer noopener",className:"mg-ext"},l.createElement("span",{className:"icon icon-common icon-external-link-alt"})," ",n)},4933:(e,t,a)=>{a.d(t,{Z:()=>o});var l=a(7294),n=a(7762),i=a(6529);const s=({sample:e})=>l.createElement("div",{className:"vf-box vf-box--easy"},l.createElement("h3",{className:"vf-box__heading"},l.createElement("a",{href:`../samples/${e.id}`},e.id)),l.createElement("p",{className:"vf-box__text"},e.attributes["sample-desc"])),r=({accessions:e})=>l.createElement("div",{className:"vf-box vf-box--easy"},l.createElement("h3",{className:"vf-box__heading"},"Samples on this geographical location"),l.createElement("ul",{className:"vf-list"},e.map((e=>l.createElement("li",{ref:e},l.createElement("a",{href:`../samples/${e}`},e)))))),o=({samples:e})=>{const t=(0,l.useRef)(),[a,o]=(0,l.useState)(null),c=(0,l.useRef)(null),u=(0,l.useRef)(new google.maps.InfoWindow),m=(0,l.useRef)(new google.maps.InfoWindow),d=(0,l.useRef)(new google.maps.LatLngBounds),v=(0,l.useRef)({});return(0,l.useEffect)((()=>{if(null===a){const e=new google.maps.Map(t.current,{maxZoom:10,minZoom:2});o(e)}}),[a]),(0,l.useEffect)((()=>{a&&e&&(c.current&&c.current.clearMarkers(),e.filter((({id:e})=>!(e in v.current))).forEach((e=>{const t={lat:e.attributes.latitude,lng:e.attributes.longitude},i=new google.maps.Marker({position:t,title:e.id});d.current.extend(t),i.addListener("click",(()=>{u.current.setContent(n.renderToString(l.createElement(s,{sample:e}))),u.current.open(a,i)})),v.current[e.id]=i})),c.current=new i.Z(a,Object.values(v.current),{imagePath:"https://raw.githubusercontent.com/googlemaps/js-markerclustererplus/master/images/m",maxZoom:10}),google.maps.event.addListener(c.current,"click",(function(e){this.prevZoom_+1<=this.getMaxZoom()||e.getSize()>=10||(m.current.setPosition(e.getCenter()),m.current.setContent(n.renderToString(l.createElement(r,{accessions:e.getMarkers().map((e=>e.getTitle()))}))),m.current.open(a))})),a.fitBounds(d.current))}),[a,e]),l.createElement("div",{ref:t,id:"map",style:{height:"100%"}})}},2069:(e,t,a)=>{a.d(t,{Z:()=>o});var l=a(7294),n=a(2245),i=a(7838),s=a(402),r=a(1699);const o=e=>e===n.Status.LOADING?l.createElement(s.Z,null):e===n.Status.FAILURE?l.createElement(r.Z,{error:{status:200,type:i.ZB.OtherError,error:e}}):null},5372:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var l=a(7294),n=a(8110),i=a(964),s=a(402),r=a(1699),o=a(4821),c=a(9711),u=a(2245);var m=a(6050),d=a(4933),v=a(2069);const p=({study:e})=>{const[t,a]=(0,l.useState)(200),{samples:i,total:s}=((e,t)=>{const[a,i]=(0,l.useState)(1),[s,r]=(0,l.useState)([]),[o,c]=(0,l.useState)(null),{data:u,isStale:m,loading:d,error:v}=(0,n.Z)("samples",{study_accession:e,page:a});return(0,l.useEffect)((()=>{var e,l,n,d,v;if((null==u?void 0:u.data)&&!m&&a===(null===(l=null===(e=null==u?void 0:u.meta)||void 0===e?void 0:e.pagination)||void 0===l?void 0:l.page)){const e=[...s,...u.data];r(e);const l=null===(d=null===(n=null==u?void 0:u.meta)||void 0===n?void 0:n.pagination)||void 0===d?void 0:d.count;o!==l&&"number"==typeof l&&c(l),(null===(v=null==u?void 0:u.links)||void 0===v?void 0:v.next)&&e.length<t&&i(a+1)}}),[u,a,t]),(0,l.useEffect)((()=>{var e;(null===(e=null==u?void 0:u.links)||void 0===e?void 0:e.next)&&s.length<t&&i(a+1)}),[t]),{samples:s,total:o,loading:d,error:v}})(e,t),{config:r}=(0,l.useContext)(m.Z),o=i.filter((e=>{try{return 0!==Number(e.attributes.longitude)&&0!==Number(e.attributes.latitude)}catch(e){return!1}}));return l.createElement("div",{className:"mg-map-container"},l.createElement("div",{className:"mg-map-wrapper"},l.createElement(u.Wrapper,{apiKey:r.googleMapsKey,render:v.Z},l.createElement(d.Z,{samples:o}))),s&&l.createElement("div",{className:"mg-map-progress"},l.createElement("progress",{max:s,value:i.length}),s>t&&l.createElement("div",null,"⚠️ We are only loading the first ",200," samples. Click"," ",l.createElement("button",{type:"button",className:"vf-button vf-button--link mg-button-as-link",onClick:()=>a(s)},"HERE")," ","to load them all."),0===o.length&&l.createElement("div",null,"⚠️ None of the ",s>t?"loaded":""," samples have geolocation co-ordinates.")))};var g=a(5478),h=a(5058),E=a(6341),f=a(6486),b=a(6313),y=a(2119);const k=()=>{var e;const t=(0,i.Z)(),[a]=(0,y.B)({"analyses-page":1,"analyses-page_size":10,"analyses-order":""},{"analyses-page":Number,"analyses-page_size":Number}),{data:o,loading:u,error:m,isStale:d}=(0,n.Z)(`studies/${t}/analyses`,{include:"sample",page:a["analyses-page"],ordering:a["analyses-order"],page_size:a["analyses-page_size"]});if(u&&!d)return l.createElement(s.Z,{size:"small"});if(m||!o)return l.createElement(r.Z,{error:m});const v={};null===(e=o.included)||void 0===e||e.filter((({type:e})=>"samples"===e)).forEach((e=>{v[e.id]={description:e.attributes["sample-desc"],biome:e.relationships.biome.data.id}}));const p=[{id:"biome_id",Header:"Biome",accessor:e=>{var t,a,l,n;return(null===(n=null==v?void 0:v[null===(l=null===(a=null===(t=null==e?void 0:e.relationships)||void 0===t?void 0:t.sample)||void 0===a?void 0:a.data)||void 0===l?void 0:l.id])||void 0===n?void 0:n.biome)||""},Cell:({cell:e})=>l.createElement("span",{className:`biome_icon icon_xs ${(0,h.G)(e.value)}`,style:{float:"initial"}})},{id:"sample",Header:"Sample accession",accessor:e=>{var t,a,l;return null===(l=null===(a=null===(t=null==e?void 0:e.relationships)||void 0===t?void 0:t.sample)||void 0===a?void 0:a.data)||void 0===l?void 0:l.id},Cell:({cell:e})=>l.createElement(c.rU,{to:`/samples/${e.value}`},e.value)},{id:"description_id",Header:"Sample description",accessor:e=>{var t,a,l,n;return(null===(n=null==v?void 0:v[null===(l=null===(a=null===(t=null==e?void 0:e.relationships)||void 0===t?void 0:t.sample)||void 0===a?void 0:a.data)||void 0===l?void 0:l.id])||void 0===n?void 0:n.description)||""},Cell:({cell:e})=>(0,f.unescape)(e.value)},{id:"assembly_id",Header:" Run / Assembly accession",accessor:e=>{var t,a,l;return(null===(l=null===(a=null===(t=null==e?void 0:e.relationships)||void 0===t?void 0:t.sample)||void 0===a?void 0:a.data)||void 0===l?void 0:l.id)||""},Cell:({cell:e})=>l.createElement(c.rU,{to:`/assemblies/${e.value}`},e.value)},{id:"pipeline_id",Header:"Pipeline version",accessor:e=>e.attributes["pipeline-version"],Cell:({cell:e})=>l.createElement(c.rU,{to:`/pipelines/${e.value}`},e.value)},{id:"analysis_id",Header:"Analysis accession",accessor:e=>e.id,Cell:({cell:e})=>l.createElement(c.rU,{to:`/analyses/${e.value}`},e.value)}];return l.createElement(b.Z,{cols:p,data:o,title:"Analyses",initialPage:a["analyses-page"]-1,initialPageSize:10,className:"mg-anlyses-table",loading:u,isStale:d,namespace:"analyses-"})};var N=a(2531);const S=({data:e,included:t})=>{var a,n,i,s,r;const{config:o}=(0,l.useContext)(m.Z),u=e.relationships.biomes.data[0].id,d=t.filter((({type:e})=>"publications"===e));return l.createElement("section",null,l.createElement("div",{className:"vf-grid"},l.createElement("div",null,l.createElement("h4",null,"Last updated:"," ",new Date(null===(a=null==e?void 0:e.attributes)||void 0===a?void 0:a["last-update"]).toDateString()),l.createElement(g.Z,{label:"Classification"},l.createElement("span",{className:`biome_icon icon_sm ${(0,h.G)(u)}`,style:{float:"initial"}}),u),l.createElement(g.Z,{label:"Description"},e.attributes["study-abstract"])),l.createElement(p,{study:e.id})),l.createElement("br",null),l.createElement("div",{className:"mg-flex"},(null===(s=null===(i=null===(n=null==e?void 0:e.relationships)||void 0===n?void 0:n.studies)||void 0===i?void 0:i.data)||void 0===s?void 0:s.length)>0&&l.createElement(g.Z,{label:"Related studies"},l.createElement("ul",{className:"vf-list"},e.relationships.studies.data.map((({id:e})=>l.createElement("li",{key:e},l.createElement(c.rU,{to:`/studies/${e}`},e)))))),l.createElement("div",null,(null===(r=null==e?void 0:e.attributes)||void 0===r?void 0:r["is-public"])&&l.createElement(g.Z,{label:"External links"},l.createElement("ul",{className:"vf-list"},l.createElement("li",null,l.createElement(N.Z,{href:`${o.enaURL}/${e.attributes["secondary-accession"]}`},"ENA website (",e.attributes["secondary-accession"],")")))),(null==d?void 0:d.length)>0&&l.createElement(g.Z,{label:"Publications"},l.createElement("ul",{className:"vf-list"},d.map((({attributes:e,id:t})=>l.createElement("li",{key:t},l.createElement(E.Sf,{title:e["pub-title"],journal:e["iso-journal"],year:e["published-year"],link:`http://${e.doi}`,doi:e.doi,authors:e.authors,maxAuthorsLength:70})))))))),l.createElement("br",null),l.createElement("div",null,l.createElement(k,null)))},A=({accession:e})=>{const{data:t,loading:a,error:i}=(0,n.Z)(`studies/${e}/downloads`),o={};return((null==t?void 0:t.data)||[]).forEach((e=>{var t,a,l,n,i,s;const r=null===(l=null===(a=null===(t=null==e?void 0:e.relationships)||void 0===t?void 0:t.pipeline)||void 0===a?void 0:a.data)||void 0===l?void 0:l.id,c=null===(n=null==e?void 0:e.attributes)||void 0===n?void 0:n["group-type"],u=null===(i=null==e?void 0:e.attributes)||void 0===i?void 0:i.description.label,m=null===(s=null==e?void 0:e.links)||void 0===s?void 0:s.self;o[r]||(o[r]={}),o[r][c]||(o[r][c]=[]),o[r][c].push({label:u,link:m})})),l.createElement("section",null,l.createElement("p",null,"In this section you can download the different results matrix files summarising the study. Each downloadable file contains an aggregation of the analysis results from the individual study's runs. To visualise and download the analysis results for individual runs, please access their respective pages."),a&&l.createElement(s.Z,null),i&&l.createElement(r.Z,{error:i}),l.createElement("ul",{className:"vf-list"},Object.entries(o).map((([e,t])=>l.createElement("li",{key:e,className:"vf-list__item mg-list__item"},l.createElement("h4",null,"Pipeline version: ",e),l.createElement("ul",{className:"vf-list"},Object.entries(t).map((([e,t])=>l.createElement("li",{key:e,className:"vf-list__item mg-list__item"},l.createElement("h6",null,e),l.createElement("ul",{className:"vf-list"},t.map((({label:e,link:t})=>l.createElement("li",{key:t,className:"vf-list__item mg-list__item"},l.createElement("a",{href:t,download:!0},l.createElement("span",{className:"icon icon-common icon-download"})," ",e))))))))),l.createElement("hr",null))))))};var w=a(1274);const Z=[{label:"Overview",to:"#overview"},{label:"Analysis summary",to:"#analysis"}],x=()=>{const e=(0,i.Z)(),{data:t,loading:a,error:c}=(0,n.Z)(`studies/${e}`,{include:"publications"});if(a)return l.createElement(s.Z,{size:"large"});if(c)return l.createElement(r.Z,{error:c});if(!t)return l.createElement(s.Z,null);const{data:u,included:m}=t;return l.createElement("section",{className:"vf-content"},l.createElement("h2",null,"Study ",e),l.createElement("h3",null,u.attributes["study-name"]),l.createElement(o.Z,{tabs:Z}),l.createElement("section",{className:"vf-grid"},l.createElement("div",{className:"vf-stack vf-stack--200"},l.createElement(w.Z,{hash:"#overview",isDefault:!0},l.createElement(S,{data:u,included:m||[]})),l.createElement(w.Z,{hash:"#analysis"},l.createElement(A,{accession:e})))))}},4018:(e,t,a)=>{e.exports=a.p+"static/bef88e0e94ffc23af445.gif"}}]);
//# sourceMappingURL=336.d0897064.chunk.js.map