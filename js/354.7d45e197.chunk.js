(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[354],{9170:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});var n=t(7294),l=t(9521);const r=({currentPageIndex:e,pageIndex:a,gotoPage:t})=>e===a?n.createElement("li",{className:"vf-pagination__item vf-pagination__item--is-active"},n.createElement("span",{className:"vf-pagination__label","aria-current":"page"},n.createElement("span",{className:"vf-u-sr-only"},"Page "),e+1)):n.createElement("li",{className:"vf-pagination__item"},n.createElement("button",{type:"button",onClick:()=>t(a),className:"vf-button vf-button--link vf-pagination__link"},n.createElement("span",{className:"vf-u-sr-only"}," page"),a+1)),s=({cols:e,data:a,title:t,fetchPage:s,onChangeSort:o,initialPage:c=0})=>{const{getTableProps:i,getTableBodyProps:m,headerGroups:u,rows:d,prepareRow:v,canPreviousPage:p,canNextPage:f,pageCount:g,gotoPage:E,nextPage:_,previousPage:h,state:{pageIndex:b,pageSize:y,sortBy:N}}=(0,l.useTable)({columns:e,data:a.data,initialState:{pageIndex:c},pageCount:a.meta.pagination.pages,manualPagination:!0,manualSortBy:!0},l.useSortBy,l.usePagination);n.useEffect((()=>{s&&s(b,y)}),[s,b,y]),n.useEffect((()=>{o&&o(N)}),[o,N]);const P=n.useMemo((()=>function(e,a){const t=a>1?[0,1]:[0],n=a>2?[Math.max(2,e-2)]:[];for(let e=n[0]+1;e<a-2&&n.length<5;e+=1)n.push(e);let l=[];return a>7?l=[a-2,a-1]:a>6&&(l=[a-1]),{startingPages:t,endingPages:l,adjacentPages:n,hasJumpFromStart:!!n.length&&n[0]>t[t.length-1]+1,hasJumpToEnd:!!l.length&&!!n.length&&l[0]>n[n.length-1]+1}}(b,g)),[b,g]);return n.createElement("section",null,n.createElement("table",Object.assign({},i,{className:"vf-table--striped"}),n.createElement("caption",{className:"vf-table__caption"},t),n.createElement("thead",{className:"vf-table__header"},u.map((e=>n.createElement("tr",Object.assign({},e.getHeaderGroupProps(),{className:"vf-table__row"}),e.headers.map((e=>n.createElement("th",Object.assign({},e.getHeaderProps(e.getSortByToggleProps()),{className:"vf-table__heading"}),e.render("Header"),o&&n.createElement(n.Fragment,null,"Â ",n.createElement("span",null,e.isSorted?e.isSortedDesc?n.createElement("i",{className:"icon icon-common icon-sort-down"}):n.createElement("i",{className:"icon icon-common icon-sort-up"}):n.createElement("i",{className:"icon icon-common icon-sort"})))))))))),n.createElement("tbody",Object.assign({},m(),{className:"vf-table__body"}),d.map((e=>(v(e),n.createElement("tr",Object.assign({},e.getRowProps(),{className:"vf-table__row"}),e.cells.map((e=>n.createElement("td",Object.assign({},e.getCellProps(),{className:"vf-table__cell"}),e.render("Cell")))))))))),s&&n.createElement("nav",{className:"vf-pagination","aria-label":"Pagination"},n.createElement("ul",{className:"vf-pagination__list"},n.createElement("li",{className:"vf-pagination__item vf-pagination__item--previous-page"},n.createElement("button",{disabled:!p,type:"button",onClick:h,className:"vf-button vf-button--link vf-pagination__link"},"Previous",n.createElement("span",{className:"vf-u-sr-only"}," page"))),P.startingPages.map((e=>n.createElement(r,{key:e,currentPageIndex:b,pageIndex:e,gotoPage:E}))),P.hasJumpFromStart&&n.createElement("li",{className:"vf-pagination__item"},n.createElement("span",{className:"vf-pagination__label"},"...")),P.adjacentPages.map((e=>n.createElement(r,{key:e,currentPageIndex:b,pageIndex:e,gotoPage:E}))),P.hasJumpToEnd&&n.createElement("li",{className:"vf-pagination__item"},n.createElement("span",{className:"vf-pagination__label"},"...")),P.endingPages.map((e=>n.createElement(r,{key:e,currentPageIndex:b,pageIndex:e,gotoPage:E}))),n.createElement("li",{className:"vf-pagination__item vf-pagination__item--next-page"},n.createElement("button",{disabled:!f,type:"button",onClick:_,className:"vf-button vf-button--link vf-pagination__link"},"Next",n.createElement("span",{className:"vf-u-sr-only"}," page"))))))}},1699:(e,a,t)=>{"use strict";t.d(a,{Z:()=>s});var n=t(7294),l=t(3647);const r=()=>{window.location.reload()},s=({error:e})=>e&&e.type!==l.ZB.NullURL?n.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy",style:{backgroundColor:"lemonchiffon"}},n.createElement("h3",{className:"vf-box__heading"},n.createElement("span",{className:"icon icon-common icon-exclamation-triangle"})," Error Fetching Data"),n.createElement("p",{className:"vf-box__text"},(null==e?void 0:e.type)===l.ZB.FetchError&&`There were problems with the request. [${e.error}]`,(null==e?void 0:e.type)===l.ZB.NotOK&&`The response from the server was not OK [Status: ${e.status}].`,(null==e?void 0:e.type)===l.ZB.JSONError&&`The recovered resource didn't follow the expected format [${e.error}].`),n.createElement("div",{className:"mg-right"},n.createElement("button",{type:"button",className:"vf-button vf-button--tertiary vf-button--sm ",onClick:r},"Refresh"))):null},3647:(e,a,t)=>{"use strict";t.d(a,{ZB:()=>n,Yg:()=>c,XE:()=>i,nh:()=>m});var n,l=t(7294),r=t(150);!function(e){e[e.FetchError=0]="FetchError",e[e.NotOK=1]="NotOK",e[e.JSONError=2]="JSONError",e[e.NullURL=3]="NullURL"}(n||(n={}));const s={data:null,loading:!1,error:{type:n.NullURL,error:"The queried URL is null"}},o=e=>{const[a,t]=(0,l.useState)({data:null,loading:!0,error:null}),r=e=>{t((a=>Object.assign(Object.assign({},a),e)))};return(0,l.useEffect)((()=>{e?function(e,a){var t,l,r,s;t=this,l=void 0,s=function*(){let t=null,l=null;try{t=yield fetch(e)}catch(e){return void a({error:{error:e,type:n.FetchError},loading:!1})}if(t.ok){try{l=yield t.json()}catch(e){return void a({error:{error:e,type:n.JSONError},loading:!1})}a({data:l,loading:!1,error:null})}else a({error:{status:t.status,response:t,type:n.NotOK},loading:!1})},new((r=void 0)||(r=Promise))((function(e,a){function n(e){try{c(s.next(e))}catch(e){a(e)}}function o(e){try{c(s.throw(e))}catch(e){a(e)}}function c(a){var t;a.done?e(a.value):(t=a.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,o)}c((s=s.apply(t,l||[])).next())}))}(e,r):t(s)}),[e]),a},c=(e,a={})=>{const t=Object.assign(Object.assign({},{format:"json",start:0}),a),n=`${r.l0}${e}?${Object.entries(t).map((([e,a])=>`${e}=${a}`)).join("&")}`;return o([null,void 0].includes(e)?null:n)},i=(e,a={})=>{const t=Object.assign(Object.assign({},{}),a);let n=`${r.hi}${e}`;return Object.keys(t).length>0&&(n+=`?${Object.entries(t).map((([e,a])=>`${e}=${a}`)).join("&")}`),o([null,void 0].includes(e)?null:n)},m=e=>o([null,void 0].includes(e)?null:`${r.tQ}${e}`)},2119:(e,a,t)=>{"use strict";t.d(a,{B:()=>s});var n=t(7294),l=t(1153);const r=(e,a,t)=>{const n={},l=new URLSearchParams(a);return Object.entries(e).forEach((([e,a])=>{const r=t[e]||String;n[e]=r(l.get(e)||a)})),n},s=(e,a={})=>{const t=(0,l.TH)(),s=(0,l.k6)(),o=(0,n.useMemo)((()=>r(e,t.search,a)),[e,t.search,a]),[c,i]=(0,n.useState)(o);return(0,n.useEffect)((()=>{const n=r(e,t.search,a);JSON.stringify(n)!==JSON.stringify(c)&&i(n)}),[t.search,c,e,a]),[c,a=>{if(JSON.stringify(a)===JSON.stringify(c))return;const n=new URLSearchParams(t.search);let l=!1;Object.entries(e).forEach((([e,t])=>{const r=e in a?a[e]:t;a[e]!==c[e]&&(n.set(e,String(r)),r===t&&n.delete(e),l=!0)})),l&&(t.search=n.toString(),s.push(t))}]}},6354:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>_});var n=t(7294),l=t(1153);const r=n.createContext({searchData:{"/search/studies":{data:null,loading:!1,error:null},"/search/samples":{data:null,loading:!1,error:null},"/search/analyses":{data:null,loading:!1,error:null}},queryParameters:{},setQueryParameters:e=>{}});var s=t(402);const o=()=>{const e=(0,l.TH)(),{searchData:a,queryParameters:t,setQueryParameters:o}=(0,n.useContext)(r),c=(0,n.useMemo)((()=>{var t,n,l;return null===(l=((null===(n=null===(t=null==a?void 0:a[e.pathname])||void 0===t?void 0:t.data)||void 0===n?void 0:n.facets)||[]).filter((e=>"centre_name"===e.id)))||void 0===l?void 0:l[0]}),[e.pathname,a]),[i,m]=(0,n.useState)(t.centre_name.split(",").filter(Boolean));if((0,n.useEffect)((()=>{m(t.centre_name.split(",").filter(Boolean))}),[t.centre_name]),null==a?void 0:a[e.pathname].loading)return n.createElement(s.Z,null);if(null==a?void 0:a[e.pathname].error)return null;if(!c)return null;const u=e=>{const{value:a,checked:n}=e.target;let l=[...i];n&&!i.includes(a)?l.push(a):l=i.filter((e=>e!==a)),o(Object.assign(Object.assign({},t),{centre_name:l.sort().join(",")}))};return n.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400"},n.createElement("legend",{className:"vf-form__legend"},"Centre name"),c.facetValues.map((({label:e,value:a,count:t})=>n.createElement("div",{className:"vf-form__item vf-form__item--checkbox",key:a},n.createElement("input",{type:"checkbox",name:a,value:a,id:a,className:"vf-form__checkbox",onChange:u,checked:i.includes(a)}),n.createElement("label",{className:"vf-form__label",htmlFor:a},n.createElement("span",{className:"mg-filter-checkbox-label"},e," ",n.createElement("span",{className:"mg-number"},t)))))))};var c=t(3727);const i=[{label:"Studies",to:"/search/studies"},{label:"Samples",to:"/search/samples"},{label:"Analyses",to:"/search/analyses"}],m=()=>{const e=(0,l.TH)(),a=(0,l.k6)(),{searchData:t}=(0,n.useContext)(r);return(0,n.useEffect)((()=>{i.some((({to:a})=>a===e.pathname))||a.replace(Object.assign(Object.assign({},e),{pathname:i[0].to}))}),[e,a]),n.createElement("div",{className:"vf-tabs"},n.createElement("ul",{className:"vf-tabs__list"},i.map((({label:a,to:l})=>{var r,s;return n.createElement("li",{className:"vf-tabs__item",key:a},n.createElement(c.rU,{className:"vf-tabs__link "+(l===e.pathname?"is-active":""),to:l},a,n.createElement("span",{className:"mg-number"},(null===(s=null===(r=null==t?void 0:t[l])||void 0===r?void 0:r.data)||void 0===s?void 0:s.hitCount)||"")))}))))},u=()=>{const{queryParameters:e,setQueryParameters:a}=(0,n.useContext)(r),[t,l]=(0,n.useState)(e.query);return(0,n.useEffect)((()=>{l(e.query)}),[e.query]),n.createElement("div",{className:"vf-form vf-form--search vf-form--search--responsive vf-sidebar vf-sidebar--end"},n.createElement("div",{className:"vf-sidebar__inner"},n.createElement("div",{className:"vf-form__item | vf-search__item"},n.createElement("input",{type:"text",placeholder:"Enter your search terms",id:"text",className:"vf-form__input | st-default-search-input",value:t,onChange:e=>{l(e.target.value)}})),n.createElement("button",{type:"button",className:"vf-search__button | vf-button vf-button--primary",onClick:()=>{a(Object.assign(Object.assign({},e),{query:t}))}},n.createElement("span",{className:"vf-button__text"},"Search "),n.createElement("span",{className:"icon icon-common icon-search"})),n.createElement("button",{type:"button",className:"vf-search__button | vf-button vf-button--tertiary",onClick:()=>{a({})}},n.createElement("span",{className:"vf-button__text"},"Clear All "),n.createElement("span",{className:"icon icon-common icon-times-circle"}))))};var d=t(1699),v=t(9170);const p={"/search/studies":{columns:[{id:"study_id",Header:"MGnify ID",accessor:e=>e.id,Cell:({cell:e})=>n.createElement(c.rU,{to:`/studies/${e.value}`},e.value)},{id:"ena_id",Header:"ENA accession",accessor:e=>{var a,t;return(null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.ENA_PROJECT)||void 0===t?void 0:t[0])||""},Cell:({cell:e})=>n.createElement("span",null,n.createElement("a",{href:`https://www.ebi.ac.uk/ena/browser/view/${e.value}`,className:"ext"},e.value))},{id:"biome",Header:"Biome",accessor:e=>{var a,t;return null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.biome_name)||void 0===t?void 0:t.join(":")},Cell:({cell:e})=>n.createElement("span",null,e.value)},{id:"centre",Header:"Centre name",accessor:e=>{var a,t;return null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.centre_name)||void 0===t?void 0:t[0]},Cell:({cell:e})=>n.createElement("span",null,e.value)}]},"/search/samples":{columns:[{id:"sample_id",Header:"Sample",accessor:e=>e.id,Cell:({cell:e})=>n.createElement(c.rU,{to:`/samples/${e.value}`},e.value)},{id:"mgnify_id",Header:"MGnify ID",accessor:e=>{var a,t;return(null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.METAGENOMICS_PROJECTS)||void 0===t?void 0:t[0])||""},Cell:({cell:e})=>n.createElement(c.rU,{to:`/studies/${e.value}`},e.value)},{id:"sample_name",Header:"Name",pathnames:["/search/studies"],accessor:e=>{var a,t;return null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.name)||void 0===t?void 0:t[0]},Cell:({cell:e})=>n.createElement("span",null,e.value)},{id:"sample_description",Header:"Description",pathnames:["/search/studies"],accessor:e=>{var a,t;return null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.description)||void 0===t?void 0:t[0]},Cell:({cell:e})=>n.createElement("span",null,e.value)}]},"/search/analyses":{columns:[{id:"analyses_id",Header:"Analysis",accessor:e=>(e.id||"").split("_"),Cell:({cell:e})=>n.createElement(c.rU,{to:`/analyses/${e.value[0]}?version=${e.value[1]}`},e.value[0])},{id:"pipeline",Header:"Pipeline version",accessor:e=>{var a,t;return(null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.pipeline_version)||void 0===t?void 0:t[0])||""},Cell:({cell:e})=>n.createElement("span",null,n.createElement(c.rU,{to:`/pipelines/${e.value}`},e.value))},{id:"sample_id",Header:"Sample",accessor:e=>{var a,t;return null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.METAGENOMICS_SAMPLES)||void 0===t?void 0:t[0]},Cell:({cell:e})=>n.createElement(c.rU,{to:`/samples/${e.value}`},e.value)},{id:"mgnify_id",Header:"MGnify ID",accessor:e=>{var a,t;return(null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.METAGENOMICS_PROJECTS)||void 0===t?void 0:t[0])||""},Cell:({cell:e})=>n.createElement(c.rU,{to:`/studies/${e.value}`},e.value)},{id:"experiment",Header:"Experiment type",accessor:e=>{var a,t;return null===(t=null===(a=null==e?void 0:e.fields)||void 0===a?void 0:a.experiment_type)||void 0===t?void 0:t[0]},Cell:({cell:e})=>n.createElement("span",null,e.value)}]}},f=()=>{const{pathname:e}=(0,l.TH)(),{searchData:a}=(0,n.useContext)(r),{data:t,loading:o,error:c}=(null==a?void 0:a[e])||{},i=(0,n.useMemo)((()=>{var a;return null===(a=null==p?void 0:p[e])||void 0===a?void 0:a.columns}),[e]);if(o)return n.createElement(s.Z,{size:"small"});if(c||!t)return n.createElement(d.Z,{error:c});const m={data:t.entries,meta:{pagination:{pages:Math.ceil(t.hitCount/25)}}};return n.createElement(v.Z,{cols:i,data:m,title:`Studies (${t.hitCount})`,initialPage:1})};var g=t(3647),E=t(2119);const _=()=>{const[e,a]=(0,E.B)({query:"",centre_name:""});var t;const s={searchData:{"/search/studies":(0,g.Yg)("metagenomics_projects",{query:(null==e?void 0:e.query)||"domain_source:metagenomics_projects",size:25,fields:"ENA_PROJECT,biome_name,centre_name",facetcount:10,facetsdepth:2,facets:`${t=e.centre_name,t.split(",").filter(Boolean).map((e=>`centre_name:${e}`)).join(",")}`}),"/search/samples":(0,g.Yg)("metagenomics_samples",{query:(null==e?void 0:e.query)||"domain_source:metagenomics_samples",size:25,fields:"METAGENOMICS_PROJECTS,name,description",facetcount:10,facetsdepth:2,facets:""}),"/search/analyses":(0,g.Yg)("metagenomics_analyses",{query:(null==e?void 0:e.query)||"domain_source:metagenomics_analyses",size:25,fields:"METAGENOMICS_PROJECTS,METAGENOMICS_SAMPLES,pipeline_version,experiment_type",facetcount:10,facetsdepth:2,facets:""})},queryParameters:e,setQueryParameters:a};return n.createElement("section",{className:"vf-content"},n.createElement("h2",null,"Text Search."),n.createElement(r.Provider,{value:s},n.createElement(u,null),n.createElement(m,null),n.createElement("section",{className:"embl-grid"},n.createElement("div",{className:"vf-stack vf-stack--400"},n.createElement(l.rs,null,n.createElement(l.AW,{path:"/search/studies"},n.createElement(o,null)))),n.createElement(f,null))))}}}]);
//# sourceMappingURL=354.7d45e197.chunk.js.map