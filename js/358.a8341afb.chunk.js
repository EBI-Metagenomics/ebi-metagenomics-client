"use strict";(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[358],{5608:(e,t,a)=>{a.d(t,{Z:()=>u});var s=a(7294),l=a(9711),n=a(402),r=a(1699),i=a(6313),o=a(8110),c=a(964),m=a(9980),d=a(121);const u=({rootEndpoint:e})=>{var t,a;const u=(0,c.Z)(),[p]=(0,d.Z)("assembly-page",1,Number),[v]=(0,d.Z)("assembly-search",""),[b]=(0,d.Z)("assembly-page_size",10,Number),[g]=(0,d.Z)("assembly-order",""),E=((e,t)=>"runs"===e?`runs/${t}/assemblies`:"assemblies")(e,u),{data:h,loading:f,error:Z,isStale:y,downloadURL:x}=(0,o.Z)(E,{sample_accession:"samples"===e?u:void 0,page:p,ordering:g,page_size:b,search:v});if(f&&!y)return s.createElement(n.Z,{size:"small"});if(Z||!h)return s.createElement(r.Z,{error:Z});if(!h.data.length&&!v)return s.createElement(m.Z,{type:"info",title:"No associated assemblies found."});const N=[{Header:"Assembly ID",id:"accession",accessor:"id",Cell:({cell:e})=>s.createElement(l.rU,{to:`/assemblies/${e.value}`},e.value)},{Header:"Experiment type",accessor:"attributes.experiment-type",disableSortBy:!0},{Header:"WGS ID",accessor:"attributes.wgs-accession",disableSortBy:!0},{Header:"Legacy ID",accessor:"attributes.legacy-accession",disableSortBy:!0},{Header:"Pipeline versions",accessor:"relationships.pipelines.data",disableSortBy:!0,Cell:({cell:e})=>e.value.map((({id:e})=>e)).join(", ")}],_=((null===(a=null===(t=h.meta)||void 0===t?void 0:t.pagination)||void 0===a?void 0:a.count)||1)>10;return s.createElement(i.Z,{cols:N,data:h,initialPage:p-1,initialPageSize:10,className:"mg-assembly-table",loading:f,isStale:y,sortable:!0,showTextFilter:!0,namespace:"assembly-",showPagination:_,downloadURL:x})}},1274:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(7294),l=a(6974);const n=({hash:e,isDefault:t=!1,children:a})=>{const n=(0,l.TH)(),r=(0,l.s0)();return(0,s.useEffect)((()=>{""===n.hash&&""!==e&&t&&r(e,{replace:!0})})),n.hash===e?s.createElement("div",{id:`tab-${e.slice(1)||"default"}`},a):null}},3518:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(7294),l=a(9711),n=a(402),r=a(1699),i=a(6313),o=a(1055),c=a(8110),m=a(964),d=a(5058),u=a(121);const p=({rootEndpoint:e})=>{var t,a;const p=(0,m.Z)(),[v]=(0,u.Z)("studies-page",1,Number),[b]=(0,u.Z)("studies-page_size",10,Number),[g]=(0,u.Z)("studies-order",""),{data:E,loading:h,error:f,isStale:Z,downloadURL:y}=(0,c.Z)(`${e}/${p}/studies`,{page:v,ordering:g,page_size:b});if(h&&!Z)return s.createElement(n.Z,{size:"small"});if(f||!E)return s.createElement(r.Z,{error:f});if(!E.data.length)return null;const x=[{id:"biome_id",Header:"Biome",accessor:e=>{var t,a;return null===(a=null===(t=e.relationships.biomes.data)||void 0===t?void 0:t[0])||void 0===a?void 0:a.id},Cell:({cell:e})=>s.createElement("span",{className:`biome_icon icon_xs ${(0,d.G)(e.value)}`,style:{float:"initial"}}),className:"mg-biome"},{id:"study",Header:"Study accession",accessor:"id",Cell:({cell:e})=>s.createElement(l.rU,{to:`/studies/${e.value}`},e.value)},{Header:"Name",accessor:"attributes.study-name"},{Header:"Abstract",accessor:"attributes.study-abstract",Cell:({cell:e})=>s.createElement(o.Z,{text:e.value||""})},{Header:"Samples Count",accessor:"attributes.samples-count"},{id:"last_update",Header:"Last Updated",accessor:"attributes.last-update",Cell:({cell:e})=>new Date(e.value).toLocaleDateString()}],N=((null===(a=null===(t=E.meta)||void 0===t?void 0:t.pagination)||void 0===a?void 0:a.count)||1)>10;return s.createElement(i.Z,{cols:x,data:E,initialPage:v-1,initialPageSize:10,className:"mg-studies-table",loading:h,isStale:Z,namespace:"studies-",showPagination:N,downloadURL:y,dataCy:"associated-studies"})}},5478:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(7294);const l=({label:e,theme:t="primary",children:a,dataCy:l})=>s.createElement("div",{className:"vf-grid","data-cy":l},s.createElement("div",{className:`vf-box vf-box--easy vf-box-theme--${t}`},s.createElement("h5",{className:"vf-box__heading"},e),s.createElement("div",{className:"vf-box__text"},a)))},3415:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(7294);const l=({list:e,dataCy:t})=>s.createElement("div",{className:"vf-grid vf-grid__col-2",style:{gridTemplateColumns:"1fr 2fr",rowGap:"0.5rem"},"data-cy":t},e.map((({key:e,value:t})=>s.createElement(s.Fragment,{key:e},s.createElement("div",{style:{textAlign:"right"}},e,":"),s.createElement("div",null,"string"==typeof t?t:s.createElement(t,null))))))},4933:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(7294),l=a(7762),n=a(6529);const r=({sample:e})=>s.createElement("div",{className:"vf-box vf-box--easy"},s.createElement("h3",{className:"vf-box__heading"},s.createElement("a",{href:`../samples/${e.id}`},e.id)),s.createElement("p",{className:"vf-box__text"},e.attributes["sample-desc"])),i=({accessions:e})=>s.createElement("div",{className:"vf-box vf-box--easy"},s.createElement("h3",{className:"vf-box__heading"},"Samples on this geographical location"),s.createElement("ul",{className:"vf-list"},e.map((e=>s.createElement("li",{ref:e},s.createElement("a",{href:`../samples/${e}`},e)))))),o=({samples:e})=>{const t=(0,s.useRef)(),[a,o]=(0,s.useState)(null),c=(0,s.useRef)(null),m=(0,s.useRef)(new google.maps.InfoWindow),d=(0,s.useRef)(new google.maps.InfoWindow),u=(0,s.useRef)(new google.maps.LatLngBounds),p=(0,s.useRef)({});return(0,s.useEffect)((()=>{if(null===a){const e=new google.maps.Map(t.current,{maxZoom:10,minZoom:2});o(e)}}),[a]),(0,s.useEffect)((()=>{a&&e&&(c.current&&c.current.clearMarkers(),e.filter((({id:e})=>!(e in p.current))).forEach((e=>{const t={lat:e.attributes.latitude,lng:e.attributes.longitude},n=new google.maps.Marker({position:t,title:e.id});u.current.extend(t),n.addListener("click",(()=>{m.current.setContent(l.renderToString(s.createElement(r,{sample:e}))),m.current.open(a,n)})),p.current[e.id]=n})),c.current=new n.Z(a,Object.values(p.current),{imagePath:"https://raw.githubusercontent.com/googlemaps/js-markerclustererplus/master/images/m",maxZoom:10}),google.maps.event.addListener(c.current,"click",(function(e){this.prevZoom_+1<=this.getMaxZoom()||e.getSize()>=10||(d.current.setPosition(e.getCenter()),d.current.setContent(l.renderToString(s.createElement(i,{accessions:e.getMarkers().map((e=>e.getTitle()))}))),d.current.open(a))})),a.fitBounds(u.current))}),[a,e]),s.createElement("div",{ref:t,id:"map",style:{height:"100%"}})}},7318:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(7294),l=a(2245),n=a(7838),r=a(402),i=a(1699);const o=e=>e===l.Status.LOADING?s.createElement(r.Z,null):e===l.Status.FAILURE?s.createElement(i.Z,{error:{status:200,type:n.ZB.OtherError,error:e}}):null},4821:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(7294),l=a(6974),n=a(9711);const r=({tabs:e,preservedQueryParameters:t})=>{const a=(0,l.TH)(),r=(0,s.useMemo)((()=>{if(!t)return"";const e=new URLSearchParams,s=new URLSearchParams(a.search);let l=!1;return t.forEach((t=>{s.has(t)&&e.append(t,s.get(t)),l=!0})),l?`?${e.toString()}`:""}),[t,a.search]);return s.createElement("div",{className:"vf-tabs mg-search-tabs"},s.createElement("ul",{className:"vf-tabs__list"},e.map((({label:e,to:t})=>s.createElement("li",{className:"vf-tabs__item",key:t},s.createElement(n.rU,{className:"vf-tabs__link "+(t===a.pathname||t.startsWith("#")&&t===a.hash||"#"===t&&""===a.hash?"is-active":""),to:t+r},"string"==typeof e?e:s.createElement(e,null)))))))}},1055:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(7294),l=a(7565);const n=({text:e,maxLength:t=250,withTooltip:a=!1})=>{const n=e.length>=t,r=s.createElement(s.Fragment,null,e.substring(0,t),n&&"...");return a&&n?s.createElement(l.Z,{content:e},s.createElement("span",null,r)):r}},7565:(e,t,a)=>{a.d(t,{Z:()=>n});var s=a(7294),l=a(7275);a(3751);const n=({content:e,children:t,interactive:a=!1})=>s.createElement(l.ZP,{content:e,interactive:a},t)},964:(e,t,a)=>{a.d(t,{Z:()=>l});var s=a(6974);const l=()=>{const e=(0,s.TH)();let{pathname:t}=e;t.trim().endsWith("/")&&(t=t.trim().slice(0,-1));const a=t.split("/");return null==a?void 0:a[a.length-1]}},3655:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var s=a(7294),l=a(8110),n=a(964),r=a(402),i=a(1699),o=a(4821),c=a(2245),m=a(6050),d=a(4933),u=a(7318);const p=({samples:e})=>{const{config:t}=(0,s.useContext)(m.ZP),a=e.filter((e=>{try{return 0!==Number(e.attributes.longitude)&&0!==Number(e.attributes.latitude)}catch(e){return!1}}));return s.createElement("div",{className:"mg-map-container"},s.createElement("div",{className:"mg-map-wrapper"},s.createElement(c.Wrapper,{apiKey:t.googleMapsKey,render:u.Z},s.createElement(d.Z,{samples:a}))),s.createElement("div",{className:"mg-map-progress"},0===a.length&&s.createElement("div",null,"⚠️ None of the samples have geolocation co-ordinates.")))};var v=a(5478),b=a(2531),g=a(5058),E=a(8101);const h=({data:e})=>{var t;const a=e.relationships.biome.data.id;return s.createElement("section",null,s.createElement("div",{className:"vf-grid"},s.createElement("div",null,s.createElement("h4",null,"Last updated:"," ",new Date(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t["last-update"]).toDateString()),s.createElement(v.Z,{label:"Description",dataCy:"sample-description"},e.attributes["sample-desc"]),s.createElement(v.Z,{label:"External links"},s.createElement("ul",{"data-cy":"sample-external-links"},s.createElement("li",null,s.createElement(b.Z,{href:E.sn+e.attributes.accession},"ENA website (",e.attributes.accession,")")),s.createElement("li",null,s.createElement(b.Z,{href:`https://www.ebi.ac.uk/biosamples/samples/${e.attributes.biosample}`},"EBI biosample (",e.attributes.biosample,")")))),s.createElement(v.Z,{label:"Classification"},s.createElement("span",{className:`biome_icon icon_sm ${(0,g.G)(a)}`,style:{float:"initial"}}),a)),s.createElement(p,{samples:[e]})))};var f=a(3518),Z=a(9711),y=a(6313),x=a(121);const N=()=>{const e=(0,n.Z)(),[t]=(0,x.Z)("runs-page",1,Number),[a]=(0,x.Z)("runs-page_size",10,Number),[o]=(0,x.Z)("runs-order",""),[c]=(0,x.Z)("runs-search",""),{data:m,loading:d,error:u,isStale:p,downloadURL:v}=(0,l.Z)(`samples/${e}/runs`,{page:t,ordering:o,page_size:a,search:c});if(d&&!p)return s.createElement(r.Z,{size:"small"});if(u||!m)return s.createElement(i.Z,{error:u});const b=[{id:"accession",Header:"Run ID",accessor:"id",Cell:({cell:e})=>s.createElement(Z.rU,{to:`/runs/${e.value}`},e.value)},{Header:"Experiment type",accessor:"attributes.experiment-type",disableSortBy:!0},{Header:"Instrument model",accessor:"attributes.instrument-model",disableSortBy:!0},{Header:"Instrument platform",accessor:"attributes.instrument-platform",disableSortBy:!0},{Header:"Pipeline versions",accessor:"relationships.pipelines.data",disableSortBy:!0,Cell:({cell:e})=>e.value.map((({id:e})=>e)).join(", ")}];return s.createElement(y.Z,{cols:b,data:m,initialPage:t-1,initialPageSize:10,className:"mg-runs-table",loading:d,isStale:p,sortable:!0,showTextFilter:!0,namespace:"runs-",downloadURL:v})};var _=a(5608),w=a(1274),S=a(3415),C=a(9763);const k=({sampleAccession:e})=>{const{data:t,loading:a,error:n}=(0,l.Z)(`samples/${e}/studies_publications_annotations_existence`);if(a)return s.createElement(r.Z,{size:"large"});if(n)return s.createElement(i.Z,{error:n});const o=t.data,c=Object.keys((0,C.Z)(o.study_has_annotations)),m=c.length>0;return o.query_possible?m?s.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy"},s.createElement("h6",{className:"vf-box__heading"},"Additional metadata from Publications"),s.createElement("p",{className:"vf-box__text"},"Additional metadata that may relate to this sample is available via publications in the following associated"," ",c.length>1?"studies":"study",":"," ",c.map((e=>s.createElement(s.Fragment,{key:e},s.createElement(Z.rU,{to:`/studies/${e}`},e)," ")))),s.createElement("p",{className:"vf-box__text"},"These additional metadata are extracted by"," ",s.createElement(b.Z,{href:"https://europepmc.org"},"Europe PMC")," using text-mining on the publications. Browse the studies to explore further.")):null:s.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy",style:{backgroundColor:"lemonchiffon"}},s.createElement("h6",{className:"vf-box__heading"},s.createElement("span",{className:"icon icon-common icon-exclamation-triangle"}),"Couldn’t check all studies for metadata"),s.createElement("p",{className:"vf-box__text"},"Additional metadata for this sample may be available via annotations on the publications linked to by the associated studies in the table below. Unfortunately these couldn’t be fetched at this time – please view each study to explore more."))};var H=a(7565);const L=({sampleAccession:e})=>{const{data:t,loading:a,error:n}=(0,l.Z)(`samples/${e}/contextual_data_clearing_house_metadata`);if(a)return s.createElement(r.Z,{size:"large"});if(n)return s.createElement(i.Z,{error:n});const o=t.data;return o.length>0?s.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy",id:"cdch-sample-metadata"},s.createElement("h6",{className:"vf-box__heading"},"Additional metadata from Elixir’s Contextual Data Clearing House"),s.createElement("p",{className:"vf-box__text"},"Additional metadata for this sample has been added to the"," ",s.createElement(b.Z,{href:"https://elixir-europe.org/internal-projects/commissioned-services/establishment-data-clearinghouse"},"Contextual Data Clearing House.")),s.createElement("div",null,s.createElement("details",null,s.createElement("summary",null,s.createElement("b",null,"Curations for sample ",e)),s.createElement("div",{className:"vf-box__text"},s.createElement(S.Z,{list:o.map((e=>{const t=e.assertionEvidences.map((e=>s.createElement(b.Z,{className:"link-in-tooltip",href:`https://evidenceontology.org/term/${e.identifier.replace("_",":")}/`},e.label)));return{key:e.attributePost,value:()=>s.createElement("div",null,s.createElement("span",{className:"vf-text-body"},e.valuePost)," ",s.createElement(H.Z,{content:s.createElement(s.Fragment,null,"Updated"," ",new Date(e.updatedTimestamp).toLocaleDateString(),".",s.createElement("br",null),"Evidence: ",t,"."),interactive:!0},s.createElement("span",{className:"icon icon-common icon-info tooltip-icon"})))}}))}))))):null},P=[{label:"Sample metadata",to:"#"},{label:"Associated studies",to:"#studies"},{label:"Analysed associated runs",to:"#runs"},{label:"Analysed associated assemblies",to:"#assemblies"}],$=()=>{var e,t;const a=(0,n.Z)(),{data:c,loading:m,error:d}=(0,l.Z)(`samples/${a}`);if(m)return s.createElement(r.Z,{size:"large"});if(d)return s.createElement(i.Z,{error:d});if(!c)return s.createElement(r.Z,null);const{data:u}=c;return s.createElement("section",{className:"vf-content"},s.createElement("h2",null,"Sample overview (",a,")"),s.createElement("h3",null,"Sample ",u.attributes["sample-name"]),s.createElement("section",{className:"vf-grid"},s.createElement("div",{className:"vf-stack vf-stack--200"},s.createElement(h,{data:u}),s.createElement(o.Z,{tabs:P}),s.createElement("section",{className:"vf-grid"},s.createElement("div",{className:"vf-stack vf-stack--200"},s.createElement(w.Z,{hash:"",isDefault:!0},s.createElement(S.Z,{dataCy:"sample-metadata",list:(null===(e=null==u?void 0:u.attributes)||void 0===e?void 0:e["sample-metadata"])||[]}),!(null===(t=null==u?void 0:u.attributes)||void 0===t?void 0:t["sample-metadata"]).length&&s.createElement("div",{className:"vf-box"},s.createElement("h3",{className:"vf-box__heading"},s.createElement("span",{className:"icon icon-common icon-info"})," No metadata to be displayed.")),s.createElement(L,{sampleAccession:a}),s.createElement(k,{sampleAccession:a})),s.createElement(w.Z,{hash:"#studies"},s.createElement(f.Z,{rootEndpoint:"samples"})),s.createElement(w.Z,{hash:"#runs"},s.createElement(N,null)),s.createElement(w.Z,{hash:"#assemblies"},s.createElement(_.Z,{rootEndpoint:"samples"})))))))}},8101:(e,t,a)=>{a.d(t,{sn:()=>s,bV:()=>l,QD:()=>n,s8:()=>r,mL:()=>i,gM:()=>o});const s="https://www.ebi.ac.uk/ena/browser/view/",l=" https://img.jgi.doe.gov/cgi-bin/m/main.cgi?section=TaxonDetail&page=taxonDetail&taxon_oid=",n="https://www.ncbi.nlm.nih.gov/assembly/",r="https://www.ncbi.nlm.nih.gov/biosample/?term=",i="https://www.ncbi.nlm.nih.gov/bioproject/",o="https://www.patricbrc.org/view/Genome/"}}]);
//# sourceMappingURL=358.a8341afb.chunk.js.map