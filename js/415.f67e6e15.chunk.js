"use strict";(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[415],{4821:(e,t,a)=>{a.d(t,{Z:()=>r});var l=a(7294),n=a(6974),s=a(9711);const r=({tabs:e})=>{const t=(0,n.TH)();return l.createElement("div",{className:"vf-tabs mg-search-tabs"},l.createElement("ul",{className:"vf-tabs__list"},e.map((({label:e,to:a})=>l.createElement("li",{className:"vf-tabs__item",key:a},l.createElement(s.rU,{className:"vf-tabs__link "+(a===t.pathname||a.startsWith("#")&&a===t.hash||"#"===a&&""===t.hash?"is-active":""),to:a},"string"==typeof e?e:l.createElement(e,null)))))))}},7565:(e,t,a)=>{a.d(t,{Z:()=>s});var l=a(7294),n=a(7275);a(3751);const s=({content:e,children:t})=>l.createElement(n.ZP,{content:e},t)},7832:(e,t,a)=>{a.d(t,{Z:()=>r});var l=a(7294),n=a(7838),s=a(6050);const r=(e,t={})=>{const{config:a}=(0,l.useContext)(s.ZP),r=Object.assign(Object.assign({},{format:"json",start:0}),t),i=`${a.ebisearch}${e}?${Object.entries(r).map((([e,t])=>`${e}=${t}`)).join("&")}`,c=(0,n.ZP)([null,void 0].includes(e)?null:i);return c.getDownloadURL=((e,t,a)=>l=>{const n=Object.assign(Object.assign({},a),{total:l,facetcount:void 0,facetsdepth:void 0});return`${e}ebi-search-download/${t}?${Object.entries(n).filter((([,e])=>Boolean(e))).map((([e,t])=>`${e}=${t}`)).join("&")}`})(a.api,e,r),c}},8328:(e,t,a)=>{a.r(t),a.d(t,{default:()=>q});var l=a(7294),n=a(6974),s=a(2054);const r=l.createContext({searchData:{"/search/studies":{data:null,loading:!1,error:null},"/search/samples":{data:null,loading:!1,error:null},"/search/analyses":{data:null,loading:!1,error:null}},queryParameters:{},setQueryParameters:s.Z});var i=a(3329);const c=({facetName:e,header:t,includeTextFilter:a=!1,sortFn:s})=>{const c=(0,n.TH)(),{searchData:m,queryParameters:o,setQueryParameters:u}=(0,l.useContext)(r),[d,v]=(0,l.useState)(o[e].split(",").filter(Boolean)),[p,h]=(0,l.useState)("");(0,l.useEffect)((()=>{v(o[e].split(",").filter(Boolean))}),[o,e]);const f=(0,l.useMemo)((()=>{var t,a,l,n;const r=null===(n=null===(l=((null===(a=null===(t=null==m?void 0:m[c.pathname])||void 0===t?void 0:t.data)||void 0===a?void 0:a.facets)||[]).filter((t=>t.id===e)))||void 0===l?void 0:l[0])||void 0===n?void 0:n.facetValues;return r&&"function"==typeof s&&r.sort(s),r}),[c.pathname,m,e,s]);if(null==m?void 0:m[c.pathname].error)return null;if(!f)return null;const E=t=>{const{value:a,checked:l}=t.target;let n=[...d];l&&!d.includes(a)?n.push(a):n=d.filter((e=>e!==a)),u(Object.assign(Object.assign({},o),{[e]:n.sort().join(",")}))};return l.createElement(i.Z,{loading:null==m?void 0:m[c.pathname].loading},l.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400"},l.createElement("legend",{className:"vf-form__legend"},t),a&&l.createElement("input",{type:"text",placeholder:"Filter the list",className:"vf-form__input",value:p,onChange:e=>h(e.target.value)}),f.filter((({label:e,value:t})=>""===p||e.toLowerCase().includes(p.toLowerCase())||t.toLowerCase().includes(p.toLowerCase()))).map((({label:e,value:t,count:a})=>l.createElement("div",{className:"vf-form__item vf-form__item--checkbox",key:t},l.createElement("input",{type:"checkbox",name:t,value:t,id:t,className:"vf-form__checkbox",onChange:E,checked:d.includes(t)}),l.createElement("label",{className:"vf-form__label",htmlFor:t},l.createElement("span",{className:"mg-filter-checkbox-label"},e," ",l.createElement("span",{className:"mg-number"},a))))))))},m=({value:e,label:t,count:a,optionChildren:n,depth:s=0,shouldExpand:r,handleSelection:i,isSelected:c})=>{const[o,u]=(0,l.useState)(r(e));return l.createElement("div",{style:{marginLeft:.5*s+"rem"}},l.createElement("div",{className:"mg-hierarchy-selector"},(null==n?void 0:n.length)?l.createElement("button",{type:"button",className:"mg-expander",onClick:()=>u(!o)},o?"▾":"▸"):l.createElement("span",{className:"mg-hierarchy-spacer"}),l.createElement("div",{className:"vf-form__item vf-form__item--checkbox"},l.createElement("input",{type:"checkbox",name:e,value:e,id:e,className:"vf-form__checkbox",onChange:i,checked:c(e)}),l.createElement("label",{className:"vf-form__label",htmlFor:e},l.createElement("span",{className:"mg-filter-checkbox-label"},t," ",l.createElement("span",{className:"mg-number"},a))))),n&&n.length&&o&&n.map((({label:t,value:a,count:n,children:o})=>l.createElement(m,{key:`${e}/${a}`,label:t,value:`${e}/${a}`,count:n,depth:s+1,optionChildren:o,handleSelection:i,isSelected:c,shouldExpand:r}))))},o=({facetName:e,header:t})=>{const a=(0,n.TH)(),{searchData:s,queryParameters:c,setQueryParameters:o}=(0,l.useContext)(r),[u,d]=(0,l.useState)(c[e].split(",").filter(Boolean));(0,l.useEffect)((()=>{d(c[e].split(",").filter(Boolean))}),[c,e]);const v=(0,l.useMemo)((()=>{var t,l,n;return null===(n=((null===(l=null===(t=null==s?void 0:s[a.pathname])||void 0===t?void 0:t.data)||void 0===l?void 0:l.facets)||[]).filter((t=>t.id===e)))||void 0===n?void 0:n[0]}),[a.pathname,s,e]);if(null==s?void 0:s[a.pathname].error)return null;if(!v)return null;const p=t=>{const{value:a,checked:l}=t.target;let n=[...u];l&&!u.includes(a)?n.push(a):n=u.filter((e=>e!==a)),o(Object.assign(Object.assign({},c),{[e]:n.sort().join(",")}))};return l.createElement(i.Z,{loading:null==s?void 0:s[a.pathname].loading},l.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400"},l.createElement("legend",{className:"vf-form__legend"},t),v.facetValues.map((({label:e,value:t,count:a,children:n})=>l.createElement(m,{key:t,label:e,value:t,count:a,optionChildren:n,handleSelection:p,isSelected:e=>u.includes(e),shouldExpand:e=>u.some((t=>t.startsWith(e)))})))))};var u=a(9111);const d=(e,t)=>e.max===t.max&&e.min===t.min,v=({min:e,max:t,isEnabled:a=!0,selection:n=null,onChange:s=(e=>e)})=>{const[r,i]=(0,l.useState)({min:n&&"min"in n?n.min:e,max:n&&"max"in n?n.max:t}),c=(0,l.useCallback)((0,u.Z)(s,300),[]);return(0,l.useEffect)((()=>{d(r,n)||c(r)}),[r]),(0,l.useEffect)((()=>{d(r,n)||i(n)}),[n]),l.createElement("div",{className:"mg-multirange-wrapper"},l.createElement("input",{type:"range",min:e,max:t,name:"min",value:r.min,className:"original",disabled:!a,onChange:e=>{i({min:Number(e.target.value),max:r.max})}}),l.createElement("input",{type:"range",min:e,max:t,name:"max",value:r.max,className:"ghost",disabled:!a,onChange:e=>{i({max:Number(e.target.value),min:r.min})}}),l.createElement("div",{className:"labels"},l.createElement("div",{className:"label-min"},l.createElement("span",null,Math.min(r.min,r.max))),l.createElement("div",{className:"label-max"},l.createElement("span",null,Math.max(r.min,r.max)))))},p=({id:e,onChange:t=(e=>e),isOn:a=!1})=>{const[n,s]=(0,l.useState)(a);return(0,l.useEffect)((()=>{s(a),t(a)}),[a,t]),l.createElement("div",null,l.createElement("input",{className:"mg-switch",type:"checkbox",id:e,checked:n,onChange:()=>{t(!n),s(!n)}}))},h=(0,l.memo)((()=>{const{queryParameters:e,setQueryParameters:t}=(0,l.useContext)(r),[a,n]=(0,l.useState)(!!e.temperature),[s,i]=(0,l.useState)(e.temperature.split(",").filter(Boolean).map(Number));return(0,l.useEffect)((()=>{const t=e.temperature.split(",").filter(Boolean).map(Number);i(t)}),[e.temperature]),l.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400 mg-temperature-filter"},l.createElement("legend",{className:"vf-form__legend"},"Temperature (°C)"),l.createElement("div",{className:"mg-switch-and-slider"},l.createElement(p,{id:"temp_filter",onChange:a=>{n(a),a||t(Object.assign(Object.assign({},e),{temperature:""}))},isOn:a}),l.createElement(v,{min:-20,max:100,isEnabled:a,selection:{min:(null==s?void 0:s[0])||-20,max:(null==s?void 0:s[1])||100},onChange:({min:a,max:l})=>{t(Object.assign(Object.assign({},e),{temperature:`${a},${l}`}))}})))})),f=(0,l.memo)((()=>{const{queryParameters:e,setQueryParameters:t}=(0,l.useContext)(r),[a,n]=(0,l.useState)(!!e.depth),[s,i]=(0,l.useState)(e.depth.split(",").filter(Boolean).map(Number));return(0,l.useEffect)((()=>{const t=e.depth.split(",").filter(Boolean).map(Number);i(t)}),[e.depth]),l.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400 mg-depth-filter"},l.createElement("legend",{className:"vf-form__legend"},"Depth (meters)"),l.createElement("div",{className:"mg-switch-and-slider"},l.createElement(p,{id:"temp_filter",onChange:a=>{n(a),a||t(Object.assign(Object.assign({},e),{depth:""}))},isOn:a}),l.createElement(v,{min:0,max:2e3,isEnabled:a,selection:{min:(null==s?void 0:s[0])||0,max:(null==s?void 0:s[1])||2e3},onChange:({min:a,max:l})=>{t(Object.assign(Object.assign({},e),{depth:`${a},${l}`}))}})))}));var E=a(4821);const g=()=>{const{queryParameters:e,setQueryParameters:t}=(0,l.useContext)(r),[a,n]=(0,l.useState)(e.query);return(0,l.useEffect)((()=>{n(e.query)}),[e.query]),l.createElement("div",{className:"vf-form vf-form--search vf-sidebar vf-sidebar--end mg-text-search"},l.createElement("div",{className:"vf-sidebar__inner"},l.createElement("div",{className:"vf-form__item | vf-search__item"},l.createElement("input",{type:"text",placeholder:"Enter your search terms",id:"mg-text-search",className:"vf-form__input | st-default-search-input mg-text-search-textfield",value:a,onChange:e=>{n(e.target.value)}})),l.createElement("div",{className:"vf-form__item | vf-search__item"},l.createElement("button",{type:"button",className:"vf-search__button | vf-button vf-button--primary mg-text-search-button",onClick:()=>{t(Object.assign(Object.assign({},e),{query:a}))}},l.createElement("span",{className:"vf-button__text"},"Search "),l.createElement("span",{className:"icon icon-common icon-search"})),l.createElement("button",{type:"button",className:"vf-search__button | vf-button vf-button--tertiary mg-text-search-clear",onClick:()=>{t({})}},l.createElement("span",{className:"vf-button__text"},"Clear All "),l.createElement("span",{className:"icon icon-common icon-times-circle"})))))};var b=a(9711),_=a(402),N=a(1699),y=a(8696),x=a(2531),C=a(7565),O=a(8101);const S={"/search/studies":{label:"Studies",columns:[{id:"study_id",Header:"MGnify ID",accessor:e=>e.id,Cell:({cell:e})=>l.createElement(b.rU,{to:`/studies/${e.value}`},e.value)},{id:"ena_id",Header:"ENA accession",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.ENA_PROJECT)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement("span",null,l.createElement(x.Z,{href:O.sn+e.value},e.value))},{id:"biome",Header:"Biome",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.biome_name)||void 0===a?void 0:a.join(":")},Cell:({cell:e})=>l.createElement("span",null,e.value)},{id:"centre",Header:"Centre name",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.centre_name)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)}]},"/search/samples":{label:"Samples",columns:[{id:"sample_id",Header:"Sample",accessor:e=>e.id,Cell:({cell:e})=>l.createElement(b.rU,{to:`/samples/${e.value}`},e.value)},{id:"mgnify_id",Header:"MGnify ID",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.METAGENOMICS_PROJECTS)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement(b.rU,{to:`/studies/${e.value}`},e.value)},{id:"sample_name",Header:"Name",pathnames:["/search/studies"],accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.name)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)},{id:"sample_description",Header:"Description",pathnames:["/search/studies"],accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.description)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)}]},"/search/analyses":{label:"Analyses",columns:[{id:"analyses_id",Header:"Analysis",accessor:e=>(e.id||"").split("_"),Cell:({cell:e})=>l.createElement(b.rU,{to:`/analyses/${e.value[0]}?version=${e.value[1]}`},e.value[0])},{id:"pipeline",Header:"Pipeline version",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.pipeline_version)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement("span",null,l.createElement(b.rU,{to:`/pipelines/${e.value}`},e.value))},{id:"sample_id",Header:"Sample",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.METAGENOMICS_SAMPLES)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement(b.rU,{to:`/samples/${e.value}`},e.value)},{id:"mgnify_id",Header:"MGnify ID",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.METAGENOMICS_PROJECTS)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement(b.rU,{to:`/studies/${e.value}`},e.value)},{id:"experiment",Header:"Experiment type",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.experiment_type)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)}]}},k=()=>{const{pathname:e}=(0,n.TH)(),{searchData:t}=(0,l.useContext)(r),{data:a,loading:s,error:i,isStale:c,getDownloadURL:m}=(null==t?void 0:t[e])||{},o=(0,l.useMemo)((()=>{var t;return null===(t=null==S?void 0:S[e])||void 0===t?void 0:t.columns}),[e]);if(s&&(!c||!a))return l.createElement(_.Z,{size:"large"});if(i||!a)return l.createElement(N.Z,{error:i});const u={data:a.entries,links:{},meta:{pagination:{pages:Math.ceil(a.hitCount/25),count:25,page:1}}};return l.createElement(y.Z,{cols:o,data:u,title:()=>{var t;return l.createElement("div",null,(null===(t=null==S?void 0:S[e])||void 0===t?void 0:t.label)||""," ",l.createElement("span",{className:"mg-number"},a.hitCount),a.hitCount>100&&l.createElement(C.Z,{content:"CSV download limited to 100 results."},l.createElement("sup",null,l.createElement("span",{className:"icon icon-common icon-info"}))))},initialPage:0,className:"mg-search-result",loading:s,isStale:c,downloadURL:a.hitCount>100?null:m(a.hitCount)})};var w=a(7832),P=a(2119);const j=(e,t)=>e.map((e=>{return a=e,t[e].split(",").filter(Boolean).map((e=>`${a}:${e}`)).join(",");var a})).filter(Boolean).join(","),$=(e,t,a)=>{const l=e.map((e=>{switch(e){case"query":return t[e];case"temperature":case"depth":{const a=t[e].split(",").filter(Boolean).map(Number);return 2===a.length?`${e}:[${Math.min(...a)} TO ${Math.max(...a)}]`:""}default:return""}})).filter(Boolean);return l.length?l.join(" AND "):a},T=({to:e,label:t})=>{var a,n;const{searchData:s}=(0,l.useContext)(r);return l.createElement(l.Fragment,null,t,l.createElement("span",{className:"mg-number"},(null===(n=null===(a=null==s?void 0:s[e])||void 0===a?void 0:a.data)||void 0===n?void 0:n.hitCount)||""))},M=[{to:"/search/studies",label:()=>l.createElement(T,{to:"/search/studies",label:"Studies"})},{to:"/search/samples",label:()=>l.createElement(T,{to:"/search/samples",label:"Samples"})},{to:"/search/analyses",label:()=>l.createElement(T,{to:"/search/analyses",label:"Analyses"})}],q=()=>{const[e,t]=(0,P.B)({query:"",centre_name:"",biome:"",temperature:"",depth:"",experiment_type:"",sequencing_method:"",location_name:"",disease_status:"",phenotype:"",organism:"",pipeline_version:"",GO:"",INTERPRO:""}),a=(0,w.Z)("metagenomics_projects",{query:$(["query"],e,"domain_source:metagenomics_projects"),size:25,fields:"ENA_PROJECT,biome_name,centre_name",facetcount:10,facetsdepth:4,facets:j(["centre_name","biome"],e)}),s=(0,w.Z)("metagenomics_samples",{query:$(["query","temperature","depth"],e,"domain_source:metagenomics_samples"),size:25,fields:"METAGENOMICS_PROJECTS,name,description",facetcount:10,facetsdepth:4,facets:j(["biome","experiment_type","location_name","disease_status","sequencing_method","phenotype"],e)}),i=(0,w.Z)("metagenomics_analyses",{query:$(["query","temperature","depth"],e,"domain_source:metagenomics_analyses"),size:25,fields:"METAGENOMICS_PROJECTS,METAGENOMICS_SAMPLES,pipeline_version,experiment_type",facetcount:10,facetsdepth:4,facets:j(["biome","organism","pipeline_version","experiment_type","GO","INTERPRO"],e)}),m=(0,l.useMemo)((()=>({searchData:{"/search/studies":a,"/search/samples":s,"/search/analyses":i},queryParameters:e,setQueryParameters:t})),[a,s,i,e,t]);return l.createElement("section",{className:"vf-content mg-page-search"},l.createElement("h2",null,"Text Search."),l.createElement(r.Provider,{value:m},l.createElement(g,null),l.createElement(E.Z,{tabs:M}),l.createElement("section",{className:"vf-grid mg-grid-search"},l.createElement("div",{className:"vf-stack vf-stack--200"},l.createElement(n.Z5,null,l.createElement(n.AW,{path:"studies",element:l.createElement(l.Fragment,null,l.createElement(o,{facetName:"biome",header:"Biome"}),l.createElement(c,{facetName:"centre_name",header:"Centre Name",includeTextFilter:!0}))}),l.createElement(n.AW,{path:"samples",element:l.createElement(l.Fragment,null,l.createElement(h,null),l.createElement(f,null),l.createElement(o,{facetName:"biome",header:"Biome"}),l.createElement(c,{facetName:"experiment_type",header:"Experiment type"}),l.createElement(c,{facetName:"sequencing_method",header:"Sequencing method"}),l.createElement(c,{facetName:"location_name",header:"Location name",includeTextFilter:!0}),l.createElement(c,{facetName:"disease_status",header:"Disease status"}),l.createElement(c,{facetName:"phenotype",header:"Phenotype"}))}),l.createElement(n.AW,{path:"analyses",element:l.createElement(l.Fragment,null,l.createElement(h,null),l.createElement(f,null),l.createElement(o,{facetName:"organism",header:"Organism"}),l.createElement(o,{facetName:"biome",header:"Biome"}),l.createElement(c,{facetName:"pipeline_version",header:"Pipeline version",sortFn:({value:e},{value:t})=>Number(t)-Number(e)}),l.createElement(c,{facetName:"experiment_type",header:"Experiment type"}),l.createElement(c,{facetName:"GO",header:"GO",includeTextFilter:!0}),l.createElement(c,{facetName:"INTERPRO",header:"InterPro",includeTextFilter:!0}))}),l.createElement(n.AW,{index:!0,element:l.createElement(n.Fg,{to:"studies",replace:!0})}))),l.createElement(k,null))))}},8101:(e,t,a)=>{a.d(t,{sn:()=>l,bV:()=>n,QD:()=>s,s8:()=>r,mL:()=>i,gM:()=>c});const l="https://www.ebi.ac.uk/ena/browser/view/",n=" https://img.jgi.doe.gov/cgi-bin/m/main.cgi?section=TaxonDetail&page=taxonDetail&taxon_oid=",s="https://www.ncbi.nlm.nih.gov/assembly/",r="https://www.ncbi.nlm.nih.gov/biosample/?term=",i="https://www.ncbi.nlm.nih.gov/bioproject/",c="https://www.patricbrc.org/view/Genome/"}}]);
//# sourceMappingURL=415.f67e6e15.chunk.js.map