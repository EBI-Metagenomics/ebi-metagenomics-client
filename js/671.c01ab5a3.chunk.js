(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[671],{1699:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var r=a(7294),o=a(7838);const n=()=>{window.location.reload()},s=({error:e})=>e&&e.type!==o.ZB.NullURL?r.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy",style:{backgroundColor:"lemonchiffon"}},r.createElement("h3",{className:"vf-box__heading"},r.createElement("span",{className:"icon icon-common icon-exclamation-triangle"})," Error Fetching Data"),r.createElement("p",{className:"vf-box__text"},(null==e?void 0:e.type)===o.ZB.FetchError&&`There were problems with the request. [${e.error}]`,(null==e?void 0:e.type)===o.ZB.NotOK&&`The response from the server was not OK [Status: ${e.status}].`,(null==e?void 0:e.type)===o.ZB.JSONError&&`The recovered resource didn't follow the expected format [${e.error}].`),r.createElement("div",{className:"mg-right"},r.createElement("button",{type:"button",className:"vf-button vf-button--tertiary vf-button--sm ",onClick:n},"Refresh"))):null},4671:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>E});var r=a(7294),o=a(3727),n=a(1153),s=a(8110);var l=a(402),i=a(1699);const c=({tabs:e})=>{const t=(0,n.TH)();return r.createElement("div",{className:"vf-tabs mg-search-tabs"},r.createElement("ul",{className:"vf-tabs__list"},e.map((({label:e,to:a})=>r.createElement("li",{className:"vf-tabs__item",key:e},r.createElement(o.rU,{className:"vf-tabs__link "+(a===t.pathname?"is-active":""),to:a},e))))))};var m=a(7212),u=a(6529);var d=a(7838),v=a(150);const b=e=>e===m.Status.LOADING?r.createElement(l.Z,null):e===m.Status.FAILURE?r.createElement(i.Z,{error:{status:200,type:d.ZB.OtherError,error:e}}):null,h=({data:e})=>{const t=(0,r.useRef)(),[a,o]=(0,r.useState)(null),n=new google.maps.InfoWindow,s={};let l=null;return(0,r.useEffect)((()=>{if(null===a){const e=new google.maps.Map(t.current,{maxZoom:10});o(e)}}),[]),(0,r.useEffect)((()=>{if(a&&e){l&&l.clearMarkers();const t=new google.maps.LatLngBounds;e.filter((({id:e})=>!(e in s))).forEach((e=>{const r={lat:e.attributes.latitude,lng:e.attributes.longitude},o=new google.maps.Marker({position:r});t.extend(r),o.addListener("click",(()=>{n.setContent("new SamplePopUpView(sample).render().el"),n.open(a,o)})),s[e.id]=o})),l=new u.Z(a,Object.values(s),{imagePath:"https://googlemaps.github.io/js-markerclustererplus/images/m",maxZoom:18}),a.fitBounds(t)}}),[a,e]),r.createElement("div",{ref:t,id:"map",style:{height:"100%"}})},f=({study:e})=>{const[t,a]=(0,r.useState)(200),{samples:o,total:n}=((e,t)=>{const[a,o]=(0,r.useState)(1),[n,l]=(0,r.useState)([]),[i,c]=(0,r.useState)(null),{data:m,isStale:u,loading:d,error:v}=(0,s.Z)("samples",{study_accession:e,page:a});return(0,r.useEffect)((()=>{var e,r,s,d,v;if((null==m?void 0:m.data)&&!u&&a===(null===(r=null===(e=null==m?void 0:m.meta)||void 0===e?void 0:e.pagination)||void 0===r?void 0:r.page)){const e=[...n,...m.data];l(e);const r=null===(d=null===(s=null==m?void 0:m.meta)||void 0===s?void 0:s.pagination)||void 0===d?void 0:d.count;i!==r&&"number"==typeof r&&c(r),(null===(v=null==m?void 0:m.links)||void 0===v?void 0:v.next)&&e.length<t&&o(a+1)}}),[m,a,t]),(0,r.useEffect)((()=>{var e;(null===(e=null==m?void 0:m.links)||void 0===e?void 0:e.next)&&n.length<t&&o(a+1)}),[t]),{samples:n,total:i,loading:d,error:v}})(e,t),l=o.filter((e=>!!(e.attributes&&"longitude"in e.attributes&&"latitude"in e.attributes)&&0!==e.attributes.longitude&&0!==e.attributes.latitude));return r.createElement("div",{className:"mg-map-container"},r.createElement("div",{className:"mg-map-wrapper"},r.createElement(m.Wrapper,{apiKey:v.SC,render:b},r.createElement(h,{data:l}))),n&&r.createElement("div",{className:"mg-map-progress"},r.createElement("progress",{max:n,value:l.length}),n>t&&r.createElement("div",null,"We are only loading the first ",200," samples. Click"," ",r.createElement("button",{type:"button",className:"vf-button vf-button--link mg-button-as-link",onClick:()=>a(n)},"HERE")," ","to load them all.")))};var p=a(5058);const g=({data:e})=>{var t;const a=e.relationships.biomes.data[0].id;return r.createElement("section",null,r.createElement("div",{className:"vf-grid"},r.createElement("div",null,r.createElement("h4",null,"Last updated:"," ",new Date(null===(t=null==e?void 0:e.attributes)||void 0===t?void 0:t["last-update"]).toDateString()),r.createElement("div",{className:"vf-box vf-box--easy vf-box-theme--primary"},r.createElement("h5",{className:"vf-box__heading"},"Classification"),r.createElement("p",{className:"vf-box__text"},r.createElement("span",{className:`biome_icon icon_sm ${(0,p.G)(a)}`,style:{float:"initial"}}),a)),r.createElement("div",{className:"vf-box vf-box--easy vf-box-theme--primary"},r.createElement("h5",{className:"vf-box__heading"},"Description"),r.createElement("p",{className:"vf-box__text"},e.attributes["study-abstract"]))),r.createElement(f,{study:e.id})),r.createElement("div",{className:"vf-box vf-box--easy vf-box-theme--primary"},r.createElement("h5",{className:"vf-box__heading"},"Related studies"),r.createElement("p",{className:"vf-box__text"})))},_=[{label:"Overview",to:"/overview"},{label:"Analysis summary",to:"/analysis"}],E=()=>{const e=(()=>{const e=(0,n.TH)().pathname.split("/");return null==e?void 0:e[e.length-1]})(),{data:t,loading:a,error:m}=(0,s.Z)(`studies/${e}`,{include:"publications"});if(a)return r.createElement(l.Z,{size:"large"});if(m)return r.createElement(i.Z,{error:m});if(!t)return r.createElement(l.Z,null);const u=t.data;return r.createElement("section",{className:"vf-content"},r.createElement("h2",null,"Study ",e),r.createElement("h3",null,u.attributes["study-name"]),r.createElement(o.UT,null,r.createElement(c,{tabs:_}),r.createElement("section",{className:"vf-grid"},r.createElement("div",{className:"vf-stack vf-stack--200"},r.createElement(n.rs,null,r.createElement(n.AW,{path:"/overview"},r.createElement(g,{data:u})),r.createElement(n.AW,{path:"/analysis"},r.createElement("div",null,"analysis")))))))}},5058:(e,t,a)=>{"use strict";a.d(t,{G:()=>i});const r={"root:engineered":"engineered_b"},o={"root:engineered:wastewater":"wastewater_b","root:environmental:air":"air_b","root:host-associated:amphibia":"amphibian_b","root:host-associated:arthropoda":"arthropoda_b","root:host-associated:fish":"fish_b","root:host-associated:human":"human_host_b","root:host-associated:insecta":"insect_b","root:host-associated:mammals":"mammals_b","root:host-associated:mollusca":"mollusca_b","root:host-associated:plants":"plant_host_b","root:host-associated:porifera":"porifera_b"},n={"root:environmental:aquatic:freshwater":"freshwater_b","root:environmental:aquatic:marine":"marine_b","root:environmental:aquatic:thermal springs":"hotspring_b","root:environmental:terrestrial:soil":"soil_b","root:environmental:terrestrial:volcanic":"vulcano_b","root:host-associated:human:digestive system":"human_gut_b","root:host-associated:human:skin":"skin_b"},s={"root:environmental:aquatic:freshwater:drinking water":"drinking_water_b","root:environmental:aquatic:freshwater:groundwater":"groundwater_b","root:environmental:aquatic:freshwater:ice":"ice_b","root:environmental:aquatic:freshwater:lake":"lake_b","root:environmental:aquatic:freshwater:lotic":"river_b","root:environmental:aquatic:marine:hydrothermal vents":"hydrothermal_vents_b","root:environmental:terrestrial:soil:wetlands":"wetlands_b","root:host-associated:human:digestive system:oral":"mouth_b","root:host-associated:human:respiratory system:pulmonary system":"lung_b","root:host-associated:mammals:nervous system:brain":"brain_b"},l={"root:environmental:aquatic:freshwater:groundwater:cave water":"cave_b","root:environmental:aquatic:freshwater:ice:glacier":"glacier_b","root:environmental:terrestrial:soil:grasslands":"grassland_b","root:environmental:terrestrial:soil:loam:forest soil":"forest_b","root:environmental:terrestrial:soil:sand:desert":"desert_b"};function i(e){const t=(e||"").split(":").map((e=>e.toLowerCase())),a=t.slice(0,2).join(":"),i=t.slice(0,3).join(":"),c=t.slice(0,4).join(":"),m=t.slice(0,5).join(":"),u=t.slice(0,6).join(":");return l[u]||s[m]||n[c]||o[i]||r[a]||"default_b"}}}]);
//# sourceMappingURL=671.c01ab5a3.chunk.js.map