{"version":3,"file":"js/685.cecb0699.chunk.js","mappings":"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","sources":["webpack://mgportalv2/./src/components/Nav/RouteForHash/index.tsx","webpack://mgportalv2/./src/components/UI/FileUploaderButton/index.tsx","webpack://mgportalv2/./src/components/UI/Hierarchy/index.tsx","webpack://mgportalv2/./src/components/UI/Tabs/index.tsx","webpack://mgportalv2/./src/components/UI/Tooltip/index.tsx","webpack://mgportalv2/./src/hooks/useURLAccession/index.tsx","webpack://mgportalv2/./src/components/Genomes/Table/index.tsx","webpack://mgportalv2/./src/components/Genomes/PhyloTree/index.tsx","webpack://mgportalv2/./src/hooks/data/useMgnifyCobsSearch/index.tsx","webpack://mgportalv2/./src/components/Genomes/Cobs/Results.tsx","webpack://mgportalv2/./src/components/Genomes/Cobs/index.tsx","webpack://mgportalv2/./src/hooks/useSearchStorage/index.tsx","webpack://mgportalv2/./src/components/Genomes/Sourmash/History/index.tsx","webpack://mgportalv2/./src/components/Genomes/Sourmash/Form/index.tsx","webpack://mgportalv2/./src/hooks/data/useMgnifySourmashSearch/index.tsx","webpack://mgportalv2/./src/hooks/data/useMgnifySourmashStatus/index.tsx","webpack://mgportalv2/./src/components/Genomes/Sourmash/Results/Table.tsx","webpack://mgportalv2/./src/components/Genomes/Sourmash/Results/index.tsx","webpack://mgportalv2/./src/components/Genomes/Sourmash/index.tsx","webpack://mgportalv2/./src/pages/GenomeCatalogue/index.tsx","webpack://mgportalv2/./src/utils/taxon.ts"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\n\ntype PropsType = {\n  hash: string;\n  isDefault?: boolean;\n};\nconst RouteForHash: React.FC<PropsType> = ({\n  hash,\n  isDefault = false,\n  children,\n}) => {\n  const location = useLocation();\n  const navigate = useNavigate();\n  useEffect(() => {\n    if (location.hash === '' && hash !== '' && isDefault) {\n      navigate(hash, { replace: true });\n    }\n  });\n\n  if (location.hash === hash) {\n    // eslint-disable-next-line react/jsx-no-useless-fragment\n    return <div id={`tab-${hash.slice(1) || 'default'}`}>{children}</div>;\n  }\n  return null;\n};\n\nexport default RouteForHash;\n","import React, { useRef, FormEvent } from 'react';\n\ntype FileUploaderButtonProps = {\n  onChange: (event: FormEvent) => void;\n  accept?: string;\n};\nconst FileUploaderButton: React.FC<FileUploaderButtonProps> = ({\n  onChange,\n  accept,\n}) => {\n  const fileInput = useRef(null);\n  return (\n    <>\n      <input\n        type=\"file\"\n        hidden\n        ref={fileInput}\n        onChange={onChange}\n        accept={accept}\n      />\n      <button\n        className=\"vf-button vf-button--primary vf-button--sm\"\n        onClick={() => fileInput.current?.click()}\n        type=\"button\"\n      >\n        Browse for file...\n      </button>\n    </>\n  );\n};\n\nexport default FileUploaderButton;\n","import React, { useState, useEffect } from 'react';\nimport './style.css';\n\nconst ANIMATION_TIME = 400;\n\nexport type Node = {\n  name: string;\n  countgen?: number;\n  type?: string;\n  children?: Node[];\n  [key: string]: unknown;\n};\n\ninterface HierarchyNodeProps {\n  tree: Node;\n  depth?: number;\n  shouldExpand?: boolean;\n  collapsing?: boolean;\n  getLabel?: (node: Node) => string | React.ReactElement;\n  triggerExpandAll?: boolean;\n  triggerCollapseAll?: boolean;\n}\nconst HierarchyNode: React.FC<HierarchyNodeProps> = ({\n  tree,\n  depth = 0,\n  shouldExpand = true,\n  collapsing = false,\n  getLabel = (node) => node.name,\n  triggerExpandAll = false,\n  triggerCollapseAll = false,\n}) => {\n  const [displayChildren, setDisplayChildren] = useState(shouldExpand);\n  const [triggerExpandAllChildren, setTriggerExpandAllChildren] =\n    useState(triggerExpandAll);\n  const [show, setShow] = useState(false);\n  const [hideChildren, setHideChildren] = useState(false);\n  useEffect(() => setShow(true), []);\n  useEffect(() => {\n    if (hideChildren) {\n      setTimeout(() => setDisplayChildren(false), ANIMATION_TIME);\n    }\n  }, [hideChildren]);\n  useEffect(() => {\n    if (triggerExpandAll) {\n      setDisplayChildren(true);\n      setTriggerExpandAllChildren(true);\n      setTimeout(() => setTriggerExpandAllChildren(false), ANIMATION_TIME);\n    }\n  }, [triggerExpandAll]);\n  useEffect(() => {\n    if (triggerCollapseAll) {\n      setDisplayChildren(false);\n    }\n  }, [triggerCollapseAll]);\n  const handleExpanderClick = (): void => {\n    setHideChildren(displayChildren);\n    if (!displayChildren) setDisplayChildren(true);\n  };\n  return (\n    <div\n      style={{\n        marginLeft: `${depth * 0.5}rem`,\n      }}\n    >\n      <div\n        className={`mg-hierarchy-selector ${show && !collapsing ? 'show' : ''}`}\n      >\n        {tree.children?.length ? (\n          <button\n            type=\"button\"\n            className=\"mg-expander\"\n            onClick={handleExpanderClick}\n          >\n            {displayChildren ? '▾' : '▸'}\n          </button>\n        ) : (\n          <span className=\"mg-hierarchy-spacer\" />\n        )}\n        <div>\n          <span className=\"mg-hierarchy-label\">\n            {getLabel(tree)}{' '}\n            {tree.countgen && (\n              <span className=\"mg-number\">{tree.countgen}</span>\n            )}\n          </span>\n        </div>\n      </div>\n      {tree.children &&\n        tree.children.length > 0 &&\n        displayChildren &&\n        tree.children.map((child) => (\n          <HierarchyNode\n            key={child.name}\n            tree={child}\n            depth={depth + 1}\n            shouldExpand={tree.countgen === 1 && child.countgen === 1}\n            getLabel={getLabel}\n            collapsing={hideChildren}\n            triggerExpandAll={triggerExpandAllChildren}\n          />\n        ))}\n    </div>\n  );\n};\n\nexport default HierarchyNode;\n","import React, { useMemo } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\n\nexport const Tab: React.FC = () => null;\n\ntype TabsProps = {\n  tabs: Array<{\n    label: string | React.ElementType;\n    to: string;\n  }>;\n  preservedQueryParameters?: string[];\n};\nconst Tabs: React.FC<TabsProps> = ({ tabs, preservedQueryParameters }) => {\n  const location = useLocation();\n  const queryParamString = useMemo(() => {\n    if (!preservedQueryParameters) return '';\n    const preserved = new URLSearchParams();\n    const existing = new URLSearchParams(location.search);\n    let anyPreserved = false;\n    preservedQueryParameters.forEach((queryParam) => {\n      if (existing.has(queryParam))\n        preserved.append(queryParam, existing.get(queryParam));\n      anyPreserved = true;\n    });\n    return anyPreserved ? `?${preserved.toString()}` : '';\n  }, [preservedQueryParameters, location.search]);\n  return (\n    <div className=\"vf-tabs mg-search-tabs\">\n      <ul className=\"vf-tabs__list\">\n        {tabs.map(({ label: Label, to }) => (\n          <li className=\"vf-tabs__item\" key={to}>\n            <Link\n              className={`vf-tabs__link ${\n                to === location.pathname ||\n                (to.startsWith('#') && to === location.hash) ||\n                (to === '#' && location.hash === '')\n                  ? 'is-active'\n                  : ''\n              }`}\n              to={to + queryParamString}\n            >\n              {typeof Label === 'string' ? Label : <Label />}\n            </Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n};\n\nexport default Tabs;\n","import React from 'react';\nimport Tippy from '@tippyjs/react';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport 'tippy.js/dist/tippy.css';\nimport './style.css';\n\ntype TooltipProps = {\n  content: React.ReactNode;\n  children?: React.ReactNode;\n  interactive?: boolean;\n};\n\nconst Tooltip: React.FC<TooltipProps> = ({\n  content,\n  children,\n  interactive = false,\n}) => (\n  <Tippy content={content} interactive={interactive}>\n    {children as React.ReactElement}\n  </Tippy>\n);\nexport default Tooltip;\n","import { useLocation } from 'react-router-dom';\n\nconst useURLAccession = (): string | undefined => {\n  const location = useLocation();\n  let { pathname } = location;\n  if (pathname.trim().endsWith('/')) pathname = pathname.trim().slice(0, -1);\n  const parts = pathname.split('/');\n  return parts?.[parts.length - 1];\n};\n\nexport default useURLAccession;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport Loading from 'components/UI/Loading';\nimport FetchError from 'components/UI/FetchError';\nimport EMGTable from 'components/UI/EMGTable';\nimport useMGnifyData from 'hooks/data/useMGnifyData';\nimport { MGnifyResponseList } from 'hooks/data/useData';\nimport useURLAccession from 'hooks/useURLAccession';\nimport { getBiomeIcon } from 'utils/biomes';\nimport { getSimpleTaxLineage } from 'utils/taxon';\nimport useQueryParamState from 'hooks/queryParamState/useQueryParamState';\n\nconst initialPageSize = 10;\nconst GenomesTable: React.FC = () => {\n  const accession = useURLAccession();\n  const [genomesPage] = useQueryParamState('genomes-page', 1, Number);\n  const [genomesPageSize] = useQueryParamState(\n    'genomes-page_size',\n    initialPageSize,\n    Number\n  );\n  const [genomesOrder] = useQueryParamState('genomes-order', '');\n  const [genomeSearchParam] = useQueryParamState('genomes-search', '');\n  const { data, loading, error, isStale } = useMGnifyData(\n    `genome-catalogues/${accession}/genomes`,\n    {\n      page: genomesPage as number,\n      ordering: genomesOrder as string,\n      page_size: genomesPageSize as number,\n      search: genomeSearchParam as string,\n    }\n  );\n  if (loading && !isStale) return <Loading size=\"small\" />;\n  if (error || !data) return <FetchError error={error} />;\n\n  const columns = [\n    {\n      id: 'biome_id',\n      Header: 'Biome',\n      accessor: (genome) => genome.relationships.biome.data?.id,\n      Cell: ({ cell }) => (\n        <span\n          className={`biome_icon icon_xs ${getBiomeIcon(cell.value)}`}\n          style={{ float: 'initial' }}\n        />\n      ),\n      disableSortBy: true,\n      className: 'mg-biome',\n    },\n    {\n      id: 'genome',\n      Header: 'Accession',\n      accessor: 'id',\n      Cell: ({ cell }) => (\n        <Link to={`/genomes/${cell.value}`}>{cell.value}</Link>\n      ),\n    },\n    {\n      Header: 'Length',\n      accessor: 'attributes.length',\n    },\n    {\n      Header: 'Num. of genomes',\n      accessor: 'attributes.num-genomes-total',\n    },\n    {\n      Header: 'Completeness',\n      accessor: 'attributes.completeness',\n    },\n    {\n      Header: 'Contamination',\n      accessor: 'attributes.contamination',\n    },\n    {\n      Header: 'Type',\n      accessor: 'attributes.type',\n      disableSortBy: true,\n    },\n    {\n      Header: 'Taxonomy',\n      accessor: 'attributes.taxon-lineage',\n      Cell: ({ cell }) => getSimpleTaxLineage(cell.value, true),\n      disableSortBy: true,\n    },\n    {\n      id: 'last_update',\n      Header: 'Last Updated',\n      accessor: 'attributes.last-update',\n      Cell: ({ cell }) => new Date(cell.value).toLocaleDateString(),\n    },\n  ];\n\n  return (\n    <EMGTable\n      Title=\"Species-level cluster representatives\"\n      cols={columns}\n      data={data as MGnifyResponseList}\n      initialPage={(genomesPage as number) - 1}\n      initialPageSize={initialPageSize}\n      className=\"mg-anlyses-table\"\n      loading={loading}\n      isStale={isStale}\n      namespace=\"genomes-\"\n      showTextFilter\n      sortable\n    />\n  );\n};\n\nexport default GenomesTable;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport Loading from 'components/UI/Loading';\nimport FetchError from 'components/UI/FetchError';\nimport HierarchyNode, { Node } from 'components/UI/Hierarchy';\nimport useMGnifyData from 'hooks/data/useMGnifyData';\nimport useURLAccession from 'hooks/useURLAccession';\n\nconst PhyloTree: React.FC = () => {\n  const accession = useURLAccession();\n  const { data, loading, error } = useMGnifyData(\n    `genome-catalogues/${accession}/downloads/phylo_tree.json`\n  );\n  if (loading) return <Loading size=\"large\" />;\n  if (error) return <FetchError error={error} />;\n  if (!data) return <Loading />;\n  return (\n    <HierarchyNode\n      tree={data as unknown as Node}\n      getLabel={(node) => {\n        const label = node.name.split('__').pop();\n        if (node.type === 'genome') {\n          return (\n            <Link to={`/genomes/${label}`} style={{ backgroundColor: 'white' }}>\n              {label}\n            </Link>\n          );\n        }\n\n        return label || 'Unknown';\n      }}\n    />\n  );\n};\nexport default PhyloTree;\n","import { useContext } from 'react';\n\nimport useData, {\n  ErrorFromFetch,\n  KeyValue,\n  ResponseFormat,\n} from 'hooks/data/useData';\nimport UserContext from 'pages/Login/UserContext';\n\nexport interface CobsResponse {\n  data: {\n    data: {\n      errors?: {\n        [fieldName: string]: string;\n      };\n      results: [\n        {\n          cobs: KeyValue;\n          mgnify: KeyValue;\n        }\n      ];\n    };\n  };\n  error: ErrorFromFetch | null;\n  loading: boolean;\n}\n\nconst useMgnifyCobsSearch: (\n  sequence: string,\n  threshold: number,\n  cataloguesFilter: string\n) => CobsResponse = (sequence, threshold, cataloguesFilter) => {\n  const { config } = useContext(UserContext);\n  const formData = new FormData();\n  formData.append('seq', sequence);\n  formData.append('threshold', String(threshold));\n  formData.append('catalogues_filter', cataloguesFilter);\n\n  const data = useData(\n    sequence.length && String(threshold).length && cataloguesFilter.length\n      ? `${config.api}genome-search`\n      : null,\n    ResponseFormat.JSON,\n    {\n      method: 'POST',\n      body: formData,\n    }\n  );\n  return data as unknown as CobsResponse;\n};\n\nexport default useMgnifyCobsSearch;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport useMgnifyCobsSearch from 'hooks/data/useMgnifyCobsSearch';\nimport Loading from 'components/UI/Loading';\nimport FetchError from 'components/UI/FetchError';\nimport EMGTable from 'components/UI/EMGTable';\nimport { getSimpleTaxLineage, cleanTaxLineage } from 'utils/taxon';\nimport Tooltip from 'components/UI/Tooltip';\n\ntype ResultsProps = {\n  sequence: string;\n  threshold: number;\n  cataloguesFilter: string;\n};\nconst Results: React.FC<ResultsProps> = ({\n  sequence,\n  threshold,\n  cataloguesFilter,\n}) => {\n  const { data, loading, error } = useMgnifyCobsSearch(\n    sequence,\n    threshold,\n    cataloguesFilter\n  );\n  if (loading) return <Loading />;\n  if (error) return <FetchError error={error} />;\n  if (data?.data?.errors) {\n    return (\n      <div\n        className=\"vf-box vf-box-theme--primary vf-box--easy\"\n        style={{\n          backgroundColor: 'lemonchiffon',\n        }}\n      >\n        <h3 className=\"vf-box__heading\">\n          <span className=\"icon icon-common icon-exclamation-triangle\" />\n          Error with your search\n        </h3>\n        {Object.entries(data.data.errors).map(([field, err]) => (\n          <p className=\"vf-box__text\">\n            {field}: {err}\n          </p>\n        ))}\n      </div>\n    );\n  }\n  const columns = [\n    {\n      Header: 'Genome accession',\n      accessor: 'cobs.genome',\n      Cell: ({ cell }) => (\n        <Link to={`/genomes/${cell.value}`}>{cell.value}</Link>\n      ),\n    },\n    {\n      Header: 'Taxonomic assignment',\n      accessor: 'mgnify.taxon_lineage',\n      Cell: ({ cell }) => (\n        <>\n          {getSimpleTaxLineage(cell.value, true)}{' '}\n          <Tooltip content={cleanTaxLineage(cell.value, ' > ')}>\n            <sup>\n              <span className=\"icon icon-common icon-info\" />\n            </sup>\n          </Tooltip>\n        </>\n      ),\n    },\n    {\n      Header: 'Genome length',\n      accessor: 'mgnify.length',\n    },\n    {\n      Header: 'Num. contigs',\n      accessor: 'mgnify.num_contigs',\n    },\n    {\n      Header: 'Genome completeness',\n      accessor: 'mgnify.completeness',\n    },\n    {\n      Header: 'Genome contamination',\n      accessor: 'mgnify.contamination',\n    },\n    {\n      Header: 'Geographic origin',\n      accessor: 'mgnify.geographic_origin',\n    },\n    {\n      Header: 'Num. K-mers in query',\n      accessor: 'cobs.num_kmers',\n    },\n    {\n      Header: 'Num. K-mers found in genome',\n      accessor: 'cobs.num_kmers_found',\n    },\n    {\n      Header: '% K-mers found',\n      accessor: 'cobs.percent_kmers_found',\n    },\n  ];\n  if (!data) return null;\n\n  return (\n    <section>\n      <h3>COBS Results</h3>\n      <EMGTable\n        cols={columns}\n        data={data.data.results as Record<string, unknown>[]}\n        initialPageSize={100}\n        className=\"mg-anlyses-table\"\n        loading={loading}\n        showPagination={false}\n      />\n    </section>\n  );\n};\n\nexport default Results;\n","import React, { useState, useRef, useEffect } from 'react';\nimport 'textarea-sequence/dist/textarea-sequence';\n\nimport ExtLink from 'components/UI/ExtLink';\nimport Tooltip from 'components/UI/Tooltip';\n\nimport InfoBanner from 'components/UI/InfoBanner';\nimport FileUploaderButton from 'components/UI/FileUploaderButton';\nimport CobsResults from './Results';\n\nimport example1 from './examples/human-gut-v2-0.txt';\nimport example2 from './examples/marine-v1-0.txt';\nimport example3 from './examples/cow-rumen-v1-0.txt';\nimport example4 from './examples/human-oral-v1-0.txt';\nimport './style.css';\n\nconst KMERS_DEFAULT = 0.4;\nconst MIN_BASES = 50;\n\nconst examples = {\n  'human-gut-v2-0': example1,\n  'marine-v1-0': example2,\n  'rumen-v1-0': example3,\n  'human-oral-v1-0': example4,\n};\n\ntype CobsProps = {\n  catalogueName: string;\n  catalogueID: string;\n};\nconst CobsSearch: React.FC<CobsProps> = ({ catalogueName, catalogueID }) => {\n  const textareaSeq = useRef(null);\n  const [shouldSearch, setShouldSearch] = useState(false);\n  const [kmers, setKmers] = useState(KMERS_DEFAULT);\n  const [errors, setErrors] = useState<{\n    tooShort?: boolean;\n    multipleSequences?: boolean;\n    hasInvalidCharacters?: boolean;\n  }>({});\n  const [valid, setValid] = useState(false);\n  useEffect(() => {\n    textareaSeq.current.addEventListener('error-change', (e) => {\n      setErrors(e.detail.errors);\n      setValid(textareaSeq.current.quill.valid);\n    });\n  }, []);\n\n  const setSequence = (seq: string): void => {\n    textareaSeq.current.quill.setText(seq);\n  };\n\n  const handleExampleClick = (): void => {\n    if (catalogueID in examples) setSequence(examples[catalogueID]);\n    else setSequence(example1);\n  };\n\n  const handleKmersChange = (event): void => {\n    setKmers(Math.min(1, Math.max(0, Number(event.target.value))));\n  };\n  const handleClear = (): void => {\n    setSequence('');\n    setKmers(KMERS_DEFAULT);\n    setShouldSearch(false);\n  };\n\n  const handleFileLoad = (event): void => {\n    const { files } = event.target;\n    const reader = new FileReader();\n\n    reader.addEventListener(\n      'load',\n      () => setSequence(reader.result as string),\n      false\n    );\n\n    if (files && files.length) {\n      reader.readAsText(files[0]);\n    }\n  };\n\n  const handleCleanup = (): void => {\n    textareaSeq.current.cleanUp();\n  };\n  return (\n    <section id=\"genome-search\">\n      <section>\n        <h3>Search DNA fragments in the {catalogueName} catalogue</h3>\n        <p>\n          This is a{' '}\n          <ExtLink href=\"https://arxiv.org/abs/1905.09624\">COBS-based</ExtLink>{' '}\n          search engine designed to query short sequence fragments (50-5,000 bp\n          in length) against representative genomes from the catalogue.\n        </p>\n      </section>\n      <section>\n        <div>\n          <h5>Enter a sequence</h5>\n          <p>You can use any of these methods to enter your sequence:</p>\n          <ul>\n            <li>Paste in your sequence in the area below.</li>\n            <li>\n              <label\n                htmlFor=\"sequence\"\n                id=\"example-seq\"\n                style={{ cursor: 'pointer' }}\n              >\n                Use the{' '}\n                <button\n                  type=\"button\"\n                  className=\"vf-button vf-button--link mg-button-as-link\"\n                  onClick={handleExampleClick}\n                >\n                  example.\n                </button>\n              </label>\n            </li>\n            <li>\n              <label htmlFor=\"fasta-file\" style={{ cursor: 'pointer' }}>\n                Upload a fasta file{' '}\n                <FileUploaderButton\n                  onChange={handleFileLoad}\n                  accept=\".fasta, .fna, .ffn, .frn, .fa, .txt\"\n                />\n              </label>\n            </li>\n          </ul>\n        </div>\n\n        <section>\n          <div />\n          <div>\n            <textarea-sequence\n              id=\"textareaID\"\n              height=\"10em\"\n              min-sequence-length={MIN_BASES}\n              single=\"true\"\n              ref={textareaSeq}\n              className=\"mg-sequence\"\n              disable-header-check\n            />\n          </div>\n          <div className=\"row\">\n            <label htmlFor=\"threshold\">\n              <Tooltip\n                content={`The minimum proportion of K-mers from the query that must be\n              matched (default: ${KMERS_DEFAULT})`}\n              >\n                <sup>\n                  <span className=\"icon icon-common icon-info\" />\n                </sup>\n              </Tooltip>{' '}\n              Threshold:\n            </label>{' '}\n            <input\n              id=\"threshold\"\n              name=\"threshold\"\n              type=\"number\"\n              min=\"0.1\"\n              max=\"1.0\"\n              value={kmers}\n              step=\"0.1\"\n              onChange={handleKmersChange}\n              className=\"vf-form__input mg-threshold\"\n            />\n          </div>\n          {!valid && (\n            <InfoBanner>\n              <div>\n                <p>\n                  The sequence above has the following errors and can&apos;t be\n                  submitted.\n                </p>\n                <ul>\n                  {errors.tooShort && (\n                    <li>\n                      The sequence has to have at least {MIN_BASES} nucleotides\n                    </li>\n                  )}\n                  {errors.hasInvalidCharacters && (\n                    <li>The sequence has invalid characters</li>\n                  )}\n                  {errors.multipleSequences && (\n                    <li>\n                      There are multiple sequences and only 1 is supported\n                    </li>\n                  )}\n                </ul>\n              </div>\n            </InfoBanner>\n          )}\n          <div className=\"mg-right\">\n            {!valid && (\n              <button\n                type=\"button\"\n                className=\"vf-button vf-button--sm vf-button--tertiary mg-button\"\n                onClick={handleCleanup}\n              >\n                CleanUp Sequence\n              </button>\n            )}\n            {valid && (\n              <button\n                id=\"search-button\"\n                type=\"button\"\n                className=\"vf-button vf-button--sm vf-button--primary\"\n                onClick={() => setShouldSearch(true)}\n              >\n                Search\n              </button>\n            )}\n            <button\n              id=\"clear-button\"\n              type=\"button\"\n              className=\"vf-button vf-button--sm vf-button--tertiary\"\n              onClick={handleClear}\n            >\n              Clear\n            </button>\n          </div>\n        </section>\n\n        {shouldSearch && (\n          <CobsResults\n            sequence={textareaSeq.current.sequence}\n            threshold={kmers}\n            cataloguesFilter={catalogueID}\n          />\n        )}\n\n        <section>\n          <div id=\"results-section\" className=\"hidden\">\n            <div className=\"row\">\n              <div id=\"results-table\" className=\"columns\" />\n            </div>\n          </div>\n        </section>\n      </section>\n    </section>\n  );\n};\n\nexport default CobsSearch;\n","import { useState } from 'react';\n\nconst useSearchStorage = (\n  namespace: string\n): {\n  jobs: Map<string, { time: number }>;\n  saveStorage: () => void;\n  addToStorage: (jobID: string) => void;\n  removeFromStorage: (jobID: string) => void;\n} => {\n  const [jobs, setJobs] = useState(\n    new Map<string, { time: number }>(\n      JSON.parse(localStorage.getItem(namespace) || '[]')\n    )\n  );\n  const saveStorage = (): void => {\n    localStorage.setItem(namespace, JSON.stringify(Array.from(jobs.entries())));\n    setJobs(new Map(jobs));\n  };\n\n  const addToStorage = (jobID: string): void => {\n    if (!jobs.has(jobID)) {\n      jobs.set(jobID, { time: Date.now() });\n      saveStorage();\n    }\n  };\n  const removeFromStorage = (jobID: string): void => {\n    if (jobs.has(jobID)) {\n      jobs.delete(jobID);\n      saveStorage();\n    }\n  };\n\n  const pruneOldJobs = (): void => {\n    const now = Date.now();\n    const okTime = 1000 * 60 * 60 * 24 * 30; // 30 days\n    let hasDeleted = false;\n    Array.from(jobs.entries()).forEach(([jobID, { time }]) => {\n      if (time < now - okTime) {\n        jobs.delete(jobID);\n        hasDeleted = true;\n      }\n    });\n    if (hasDeleted) {\n      saveStorage();\n    }\n  };\n  pruneOldJobs();\n  return {\n    jobs,\n    saveStorage,\n    addToStorage,\n    removeFromStorage,\n  };\n};\n\nexport default useSearchStorage;\n","import React from 'react';\nimport useQueryParamState from 'hooks/queryParamState/useQueryParamState';\n\ntype HistoryProps = {\n  jobs: Map<string, { time: number }>;\n  removeFromStorage: (jobID: string) => void;\n};\n\nconst SourmashHistory: React.FC<HistoryProps> = ({\n  jobs,\n  removeFromStorage,\n}) => {\n  const [, setJobId] = useQueryParamState('job_id', '');\n  return (\n    <section>\n      <details>\n        <summary>\n          <h4 style={{ display: 'inline', cursor: 'pointer' }}>\n            Search History\n          </h4>\n        </summary>\n        <div>\n          <p>Here is a list of previous searches in this catalog:</p>\n          <div className=\"genome-search-history\">\n            {jobs.size === 0 ? (\n              \"We can't find any previous search jobs in this browser.\"\n            ) : (\n              <ul>\n                {Array.from(jobs.keys()).map((j) => (\n                  <li key={j}>\n                    <button\n                      type=\"button\"\n                      className=\"vf-button vf-button--link mg-button-as-link\"\n                      onClick={() => setJobId(j)}\n                    >\n                      {j}\n                    </button>\n                    <button\n                      type=\"button\"\n                      className=\"vf-button--outline vf-button--sm \"\n                      onClick={() => {\n                        removeFromStorage(j);\n                      }}\n                    >\n                      Remove\n                    </button>\n                  </li>\n                ))}\n              </ul>\n            )}\n          </div>\n          <p className=\"small\">\n            <b>Notice</b>: Results are only kept in our servers for 30 days.\n          </p>\n        </div>\n      </details>\n    </section>\n  );\n};\nexport default SourmashHistory;\n","import React, { useRef, useState, useEffect } from 'react';\nimport 'mgnify-sourmash-component';\n\nimport Loading from 'components/UI/Loading';\nimport FetchError from 'components/UI/FetchError';\nimport useMgnifySourmashSearch from 'hooks/data/useMgnifySourmashSearch';\nimport useQueryParamState from 'hooks/queryParamState/useQueryParamState';\n\ntype SourmashFormProps = {\n  catalogueID: string;\n};\nconst SourmashForm: React.FC<SourmashFormProps> = ({ catalogueID }) => {\n  const sourmash = useRef(null);\n  const [jobId, setJobId] = useQueryParamState('job_id', '');\n  const [shouldSearch, setShouldSearch] = useState(false);\n  const [{ signatures, errors }, setSourmashState] = useState({\n    signatures: null,\n    errors: null,\n  });\n  const { data, error, loading } = useMgnifySourmashSearch(\n    shouldSearch ? 'gather' : '',\n    catalogueID,\n    signatures\n  );\n\n  useEffect(() => {\n    let sourmashElement;\n    const sketchedAll = (event): void => {\n      setSourmashState({\n        signatures: event.detail.signatures,\n        errors: event.detail.errors,\n      });\n    };\n    const changedFiles = (): void => {\n      setSourmashState({\n        signatures: null,\n        errors: null,\n      });\n    };\n    if (sourmash.current) {\n      sourmashElement = sourmash.current;\n      sourmashElement.addEventListener('sketchedall', sketchedAll);\n      sourmashElement.addEventListener('change', changedFiles);\n    }\n    return () => {\n      if (sourmashElement) {\n        sourmashElement.removeEventListener('sketchedall', sketchedAll);\n        sourmashElement.removeEventListener('change', changedFiles);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [sourmash.current]);\n\n  useEffect(() => {\n    if (!loading && !error && data) {\n      // The signatures were succesfully sent and now we have job_id\n      setJobId((data.data as Record<string, string>).job_id);\n      setShouldSearch(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [data, error, loading]);\n\n  const handleSearch = (): void => {\n    setShouldSearch(true);\n  };\n\n  const handleClear = (): void => {\n    sourmash.current?.clear();\n    setShouldSearch(false);\n    setSourmashState({\n      signatures: null,\n      errors: null,\n    });\n  };\n  if (jobId) {\n    return null;\n  }\n  return (\n    <section id=\"search-mag-section\">\n      <mgnify-sourmash-component\n        id=\"sourmash\"\n        ref={sourmash}\n        show_directory_checkbox\n      />\n      <div>\n        <button\n          id=\"search-button-mag\"\n          type=\"button\"\n          className=\"vf-button vf-button--sm vf-button--primary mg-button\"\n          disabled={\n            Object.keys(signatures || {})?.length === 0 ||\n            Object.keys(errors || {}).length > 0\n          }\n          onClick={handleSearch}\n        >\n          Search\n        </button>\n        <button\n          id=\"clear-button-mag\"\n          type=\"button\"\n          className=\"vf-button vf-button--sm vf-button--tertiary\"\n          onClick={handleClear}\n        >\n          Clear\n        </button>\n      </div>\n      {loading && <Loading />}\n      {!loading && error && <FetchError error={error} />}\n    </section>\n  );\n};\n\nexport default SourmashForm;\n","import { useContext } from 'react';\n\nimport useData, {\n  MGnifyResponseGenericObj,\n  ResponseFormat,\n} from 'hooks/data/useData';\nimport UserContext from 'pages/Login/UserContext';\n\nconst useMgnifySourmashSearch: (\n  endpoint: 'gather' | '',\n  catalog: string,\n  signatures: { [filename: string]: string }\n) => MGnifyResponseGenericObj = (endpoint, catalog, signatures) => {\n  const { config } = useContext(UserContext);\n  const formdata = new FormData();\n  formdata.append('mag_catalog', catalog);\n  Object.entries(signatures || {}).forEach(([filename, signature]) => {\n    formdata.append(\n      'file_uploaded',\n      new Blob([signature], {\n        type: 'text/plain',\n      }),\n      filename\n    );\n  });\n  const data = useData(\n    endpoint.length && catalog.length && Object.keys(signatures || {}).length\n      ? `${config.api}genomes-search/${endpoint}`\n      : null,\n    ResponseFormat.JSON,\n    {\n      method: 'POST',\n      body: formdata,\n    }\n  );\n  return data as MGnifyResponseGenericObj;\n};\n\nexport default useMgnifySourmashSearch;\n","import { useContext } from 'react';\n\nimport useData, {\n  MGnifyResponseGenericObj,\n  ResponseFormat,\n} from 'hooks/data/useData';\nimport UserContext from 'pages/Login/UserContext';\n\nconst useMgnifySourmashStatus: (\n  endpoint: 'status' | '',\n  catalog: string,\n  jobID: string\n) => MGnifyResponseGenericObj = (endpoint, catalog, jobID) => {\n  const { config } = useContext(UserContext);\n\n  const data = useData(\n    endpoint.length && catalog.length\n      ? `${config.api}genomes-search/${endpoint}/${jobID}`\n      : null,\n    ResponseFormat.JSON,\n    {\n      method: 'GET',\n      cache: 'no-store',\n    }\n  );\n  return data as MGnifyResponseGenericObj;\n};\n\nexport default useMgnifySourmashStatus;\n","import React, { useMemo } from 'react';\nimport EMGTable from 'components/UI/EMGTable';\nimport { Link } from 'react-router-dom';\n\nconst emoji = {\n  SUCCESS: '✅',\n  FAILURE: '❌',\n  IN_QUEUE: '🕛',\n  NO_RESULTS: '🔸',\n  RUNNING: '🏃🏻‍♀️',\n};\n\ntype SourmashResultsTableProps = {\n  results: Array<Record<string, unknown>>;\n  loading: boolean;\n};\nconst SourmashResultsTable: React.FC<SourmashResultsTableProps> = ({\n  results,\n  loading,\n}) => {\n  const columns = useMemo(\n    () => [\n      {\n        Header: 'Filename',\n        accessor: 'filename',\n      },\n      {\n        Header: 'Status',\n        accessor: (r) => ({\n          status: r.status,\n          resultStatus: r.result?.status,\n        }),\n        Cell: ({ cell }) => (\n          <span style={{ whiteSpace: 'nowrap' }}>\n            {emoji[cell.value.resultStatus || cell.value.status]}{' '}\n            {cell.value.resultStatus || cell.value.status}\n          </span>\n        ),\n      },\n      {\n        id: 'match',\n        Header: (\n          <>\n            Best Match\n            <br />\n            (% query covered)\n          </>\n        ),\n        accessor: (x) => x,\n        Cell: ({ cell }) => {\n          if (\n            cell.value.status === 'SUCCESS' &&\n            cell.value.result?.status === 'NO_RESULTS'\n          )\n            return \"We couldn't find any matches with your query\";\n          if (cell.value.status === 'IN_QUEUE')\n            return `Position: ${cell.value.position_in_queue}`;\n          if (\n            cell.value.status === 'SUCCESS' &&\n            cell.value.result?.status !== 'NO_RESULTS'\n          )\n            return (\n              <span style={{ whiteSpace: 'nowrap' }}>\n                <Link to={`/genomes/${cell.value.result.match}`}>\n                  {cell.value.result.match}\n                </Link>{' '}\n                ({cell.value.result.p_query})\n              </span>\n            );\n\n          return cell.value.reason || null;\n        },\n        colspan: (cell) =>\n          cell.value.status === 'SUCCESS' &&\n          cell.value.result?.status !== 'NO_RESULTS'\n            ? 1\n            : 3,\n      },\n      {\n        Header: 'Total No. of matches',\n        accessor: 'result.matches',\n      },\n      {\n        Header: 'Download',\n        accessor: (x) => x,\n        Cell: ({ cell }) =>\n          cell.value.status === 'SUCCESS' &&\n          cell.value.result?.status !== 'NO_RESULTS' ? (\n            <a\n              download={`${cell.value.filename}.csv`}\n              href={cell.value.results_url}\n            >\n              <span className=\"icon icon-fileformats icon-CSV\" />\n            </a>\n          ) : null,\n      },\n    ],\n    []\n  );\n  return (\n    <EMGTable\n      cols={columns}\n      data={results.sort((s1, s2) => (s1.status < s2.status ? 1 : -1))}\n      initialPageSize={100}\n      className=\"mg-anlyses-table\"\n      loading={loading}\n      showPagination={false}\n    />\n  );\n};\n\nexport default SourmashResultsTable;\n","import React, { useEffect, useState } from 'react';\nimport 'mgnify-sourmash-component';\n\nimport useInterval from 'hooks/useInterval';\nimport useMgnifySourmashStatus from 'hooks/data/useMgnifySourmashStatus';\nimport Loading from 'components/UI/Loading';\nimport FetchError from 'components/UI/FetchError';\nimport useQueryParamState from 'hooks/queryParamState/useQueryParamState';\nimport SourmashResultsTable from './Table';\n\nconst INTERVAL_TIME = 1000;\nconst COUNT_TO = 5;\ntype SourmashResultsProps = {\n  catalogueID: string;\n  addToStorage: (jobID: string) => void;\n};\n\nconst SourmashResults: React.FC<SourmashResultsProps> = ({\n  catalogueID,\n  addToStorage,\n}) => {\n  const [jobId, setJobId] = useQueryParamState('job_id', '');\n  const [count, setCount] = useState(-1);\n  const [shouldCheck, setShouldCheck] = useState(false);\n  const [jobRetrieved, setJobRetrieved] = useState(false);\n  const [job, setJob] = useState(null);\n\n  useInterval(() => {\n    if (!jobId || jobRetrieved) return;\n    if (count % COUNT_TO === 0) {\n      setShouldCheck(true);\n    }\n    setCount((c) => c + 1);\n  }, INTERVAL_TIME);\n  const { data, error, loading } = useMgnifySourmashStatus(\n    shouldCheck && !jobRetrieved ? `status` : '',\n    catalogueID,\n    jobId\n  );\n  useEffect(() => {\n    if (!loading && !error && data) {\n      const results = data?.data as Record<string, Array<{ status: string }>>;\n      // Got the status of the job\n      if (\n        !(results?.signatures || []).some((s) =>\n          ['PENDING', 'IN_QUEUE', 'RUNNING'].includes(s.status)\n        )\n      ) {\n        setJobRetrieved(true);\n        addToStorage(jobId);\n      }\n      setJob(data.data);\n      setCount(0);\n      setShouldCheck(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [data, error, loading]);\n\n  useEffect(() => {\n    setJob(null);\n    setShouldCheck(true);\n    setJobRetrieved(false);\n    setCount(-1);\n  }, [jobId]);\n\n  const handleNewSearch = (): void => {\n    setJobId('');\n  };\n  if (!jobId) return null;\n  return (\n    <section>\n      <div className=\"vf-stack\">\n        <div>\n          <h4>Search Results</h4>\n          <div>\n            {jobRetrieved && <p>✅ Here are the results of your Job.</p>}\n            {!loading && error && <FetchError error={error} />}\n            {!jobRetrieved && !error && (\n              <p>🔎 Getting the results of your Job</p>\n            )}\n          </div>\n          <h5>Job Information</h5>\n          <dl className=\"vf-list vf-list--definition\">\n            <dt>Job ID</dt>\n            <dd>{jobId}</dd>\n            <dt>Status</dt>\n            <dd>\n              <span>{jobRetrieved ? 'FINISH' : 'Retrieving'}</span>{' '}\n              {loading && <Loading size=\"small\" />}{' '}\n              {!jobRetrieved && !loading && (\n                <span>Checking status in {COUNT_TO - (count % COUNT_TO)}</span>\n              )}\n            </dd>\n            <dt>Link</dt>\n            <dd id=\"results-link\">\n              <a href={window.location.href}>{window.location.href}</a>\n              {jobRetrieved &&\n                job?.signatures.some(({ status }) => status === 'SUCCESS') && (\n                  <a\n                    className=\"vf-button vf-button--sm\"\n                    download={`${job.group_id}.tgz`}\n                    href={job.results_url}\n                  >\n                    <span className=\"icon icon-common icon-download\" />\n                    Download all Results [.tgz]\n                  </a>\n                )}\n            </dd>\n            {job && (\n              <>\n                <dt>Processed Files</dt>\n                <dd>\n                  <SourmashResultsTable\n                    results={job.signatures}\n                    loading={loading}\n                  />\n                </dd>\n              </>\n            )}\n          </dl>\n        </div>\n        <div className=\"columns text-center\">\n          <button\n            type=\"button\"\n            className=\"vf-button vf-button--sm\"\n            onClick={handleNewSearch}\n          >\n            Start a new search\n          </button>\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default SourmashResults;\n","import React from 'react';\nimport 'mgnify-sourmash-component';\nimport SourmashLogo from 'images/sourmash_logo.png';\nimport InfoBanner from 'components/UI/InfoBanner';\nimport useSearchStorage from 'hooks/useSearchStorage';\nimport SourmashHistory from './History';\nimport SourmashForm from './Form';\nimport SourmashResults from './Results';\n\ntype SourmashProps = {\n  catalogueName: string;\n  catalogueID: string;\n};\n\nconst SourmashSearch: React.FC<SourmashProps> = ({\n  catalogueName,\n  catalogueID,\n}) => {\n  const { jobs, addToStorage, removeFromStorage } = useSearchStorage(\n    `sourmashJobs-${catalogueID}`\n  );\n  return (\n    <section id=\"genome-search-mag\">\n      <section className=\"vf-stack\">\n        <div style={{ width: '100%', textAlign: 'right' }}>\n          Powered by <a href=\"https://sourmash.readthedocs.io/\">Sourmash</a>.\n          <img\n            src={SourmashLogo}\n            style={{ height: '2em' }}\n            alt=\"Sourmash logo\"\n          />\n        </div>\n\n        <h3>Search MAG files in the {catalogueName} catalogue</h3>\n        <p>\n          Compare your MAG file or your MAG collection against this catalog to\n          see if they are novel.\n          <br />\n        </p>\n        <InfoBanner>\n          <details className=\"mg-sourmash-readmore\">\n            <summary>Instructions</summary>\n            <p>\n              Use the browse button below to upload either a single FastA file,\n              or multiple files by holding [ctrl] or [shift] while clicking in\n              the file explorer. Alternatively you can select a whole directory\n              of files using the directory mode (select this option below the\n              Browse button). In this mode, the tool will process all FastA\n              files in the selected directory, however it will not descend into\n              subdirectories.\n            </p>\n            <p>\n              Your files are not uploaded into our servers. Rather, Sourmash\n              generates a signature of your file(s) in your browser, and\n              compares this against our MAG catalogue.\n            </p>\n            <p>\n              Successful searches create a CSV result file for each signature\n              submitted. These are compiled into a TGZ allowing you to fetch all\n              your results in one click. These result files are only stored in\n              our servers for 30 days, so please be sure to download them before\n              they expire.\n            </p>\n          </details>\n        </InfoBanner>\n        <SourmashForm catalogueID={catalogueID} />\n        <SourmashResults\n          catalogueID={catalogueID}\n          addToStorage={addToStorage}\n        />\n        <SourmashHistory jobs={jobs} removeFromStorage={removeFromStorage} />\n      </section>\n    </section>\n  );\n};\n\nexport default SourmashSearch;\n","import React from 'react';\nimport ReactMarkdown from 'react-markdown';\n\nimport useMGnifyData from 'hooks/data/useMGnifyData';\nimport { MGnifyResponseObj } from 'hooks/data/useData';\nimport useURLAccession from 'hooks/useURLAccession';\nimport Loading from 'components/UI/Loading';\nimport FetchError from 'components/UI/FetchError';\nimport Tabs from 'components/UI/Tabs';\nimport GenomesTable from 'components/Genomes/Table';\nimport PhyloTree from 'components/Genomes/PhyloTree';\nimport CobsSearch from 'components/Genomes/Cobs';\nimport SourmashSearch from 'components/Genomes/Sourmash';\nimport RouteForHash from 'components/Nav/RouteForHash';\n\nconst tabs = [\n  { label: 'Genome list', to: '#' },\n  { label: 'Taxonomy tree', to: '#phylo-tab' },\n  { label: 'Protein catalogue', to: '#protein-catalog-tab' },\n  { label: 'Search by Gene', to: '#genome-search-tab' },\n  { label: 'Search by MAG', to: '#genome-search-mag-tab' },\n];\n\nconst GenomePage: React.FC = () => {\n  const accession = useURLAccession();\n  const { data, loading, error } = useMGnifyData(\n    `genome-catalogues/${accession}`\n  );\n  if (loading) return <Loading size=\"large\" />;\n  if (error) return <FetchError error={error} />;\n  if (!data) return <Loading />;\n  const { data: genomeData } = data as MGnifyResponseObj;\n  return (\n    <section className=\"vf-content\">\n      <h2>{genomeData.attributes.name}</h2>\n      <div>\n        <ReactMarkdown>\n          {genomeData.attributes.description as string}\n        </ReactMarkdown>\n      </div>\n      <Tabs tabs={tabs} />\n      <section className=\"vf-grid\">\n        <div className=\"vf-stack vf-stack--200\">\n          <RouteForHash hash=\"\" isDefault>\n            <GenomesTable />\n          </RouteForHash>\n          <RouteForHash hash=\"#phylo-tab\">\n            <PhyloTree />\n          </RouteForHash>\n          <RouteForHash hash=\"#genome-search-tab\">\n            <CobsSearch\n              catalogueName={genomeData.attributes.name as string}\n              catalogueID={genomeData.id}\n            />\n          </RouteForHash>\n          <RouteForHash hash=\"#genome-search-mag-tab\">\n            <SourmashSearch\n              catalogueName={genomeData.attributes.name as string}\n              catalogueID={genomeData.id}\n            />\n          </RouteForHash>\n          <RouteForHash hash=\"#protein-catalog-tab\">\n            <h3>{genomeData.attributes['protein-catalogue-name'] as string}</h3>\n            <ReactMarkdown>\n              {genomeData.attributes['protein-catalogue-description'] as string}\n            </ReactMarkdown>\n          </RouteForHash>\n        </div>\n      </section>\n    </section>\n  );\n};\n\nexport default GenomePage;\n","/**\n * Remove the s__ prefixes from a lineage.\n * @param {string} lineage string with the lineage `d__Bacteria;p__Proteobacteria;c__Gammapr...`\n * @param {string} replace replace string\n * @return {string}\n */\nexport function cleanTaxLineage(lineage: string, replace = ''): string {\n  let cleaned = lineage\n    .replace(/;/g, '')\n    .replace(/[d|p|c|o|f|g|s]__/g, replace);\n  if (cleaned.startsWith(replace)) {\n    cleaned = cleaned.substring(replace.length).trimStart();\n  }\n  return cleaned;\n}\n\n/**\n * Retrieve a non-blank taxonomic identity from the species level or upwards\n * @param {string} fullLineage\n * @param {bool} removePrefix true if this should remove the 'd|p|c|o|f|g|s__' prefix\n * @return {string}\n */\nexport function getSimpleTaxLineage(\n  fullLineage: string,\n  removePrefix: boolean\n): string {\n  const l = fullLineage.split(';');\n  let head = l.pop();\n  // Remove all until species\n  while (head.indexOf('s__') === -1) {\n    head = l.pop();\n  }\n  // Find first non-null\n  while (head.length <= 3) {\n    head = l.pop();\n  }\n  if (removePrefix && head) {\n    return cleanTaxLineage(head);\n  }\n  return head;\n}\n\nexport const TAXONOMY_COLOURS = [\n  '#ABD3DB',\n  '#F2D9D0',\n  '#F2A477',\n  '#5F9595',\n  '#D9C4B8',\n  '#EEEEAB',\n  '#8990B3',\n  '#DEFFE3',\n  '#A0B392',\n  '#DEE3FF',\n  '#F2F2F2',\n];\n"],"names":["hash","isDefault","children","location","navigate","useEffect","replace","id","slice","onChange","accept","fileInput","useRef","type","hidden","ref","className","onClick","current","click","HierarchyNode","tree","depth","shouldExpand","collapsing","getLabel","node","name","triggerExpandAll","triggerCollapseAll","displayChildren","setDisplayChildren","useState","triggerExpandAllChildren","setTriggerExpandAllChildren","show","setShow","hideChildren","setHideChildren","setTimeout","style","marginLeft","length","countgen","map","child","key","tabs","preservedQueryParameters","queryParamString","useMemo","preserved","URLSearchParams","existing","search","anyPreserved","forEach","queryParam","has","append","get","toString","label","Label","to","pathname","startsWith","content","interactive","trim","endsWith","parts","split","accession","useURLAccession","genomesPage","useQueryParamState","Number","genomesPageSize","genomesOrder","genomeSearchParam","data","loading","error","isStale","useMGnifyData","page","ordering","page_size","Loading","size","FetchError","columns","Header","accessor","genome","relationships","biome","Cell","cell","value","float","disableSortBy","Date","toLocaleDateString","EMGTable","Title","cols","initialPage","initialPageSize","namespace","showTextFilter","sortable","Hierarchy","pop","backgroundColor","sequence","threshold","cataloguesFilter","config","useContext","UserContext","formData","FormData","String","useData","api","method","body","errors","Object","entries","field","err","Tooltip","results","showPagination","examples","catalogueName","catalogueID","textareaSeq","shouldSearch","setShouldSearch","kmers","setKmers","setErrors","valid","setValid","addEventListener","e","detail","quill","setSequence","seq","setText","ExtLink","href","htmlFor","cursor","FileUploaderButton","event","files","target","reader","FileReader","result","readAsText","height","single","min","max","step","Math","InfoBanner","tooShort","hasInvalidCharacters","multipleSequences","cleanUp","jobs","removeFromStorage","setJobId","display","Array","from","keys","j","sourmash","jobId","signatures","setSourmashState","endpoint","catalog","formdata","filename","signature","Blob","sourmashElement","sketchedAll","changedFiles","removeEventListener","job_id","show_directory_checkbox","disabled","clear","emoji","SUCCESS","FAILURE","IN_QUEUE","NO_RESULTS","RUNNING","r","status","resultStatus","whiteSpace","x","position_in_queue","match","p_query","reason","colspan","download","results_url","sort","s1","s2","addToStorage","count","setCount","shouldCheck","setShouldCheck","jobRetrieved","setJobRetrieved","job","setJob","useInterval","c","jobID","cache","some","s","includes","window","group_id","setJobs","Map","JSON","parse","localStorage","getItem","saveStorage","setItem","stringify","now","hasDeleted","time","delete","pruneOldJobs","set","width","textAlign","src","alt","genomeData","attributes","description","Tabs","RouteForHash","Cobs","Sourmash","cleanTaxLineage","lineage","cleaned","substring","trimStart","getSimpleTaxLineage","fullLineage","removePrefix","l","head","indexOf","TAXONOMY_COLOURS"],"sourceRoot":""}