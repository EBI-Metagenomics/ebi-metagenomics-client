"use strict";(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[735],{7735:(e,a,t)=>{t.r(a),t.d(a,{default:()=>b});var n=t(7294),s=t(8840),r=t(5708),i=t.n(r),o=t(402),l=t(1699),c=t(6313),g=t(8110),m=t(964),p=t(2119),u=t(6581),d=t(5457);const b=({includePangenomes:e=!0})=>{const a=(0,n.useRef)(null),t=(0,m.Z)(),[r]=(0,p.B)({"kegg-page":1,"kegg-page_size":10,"kegg-order":""},{"kegg-page":Number,"kegg-page_size":Number}),{columns:b,options:f}=(0,u.Z)(),{data:E,loading:_,isStale:v,error:N}=(0,g.Z)(`genomes/${t}/kegg-class`,{page:r["kegg-page"],ordering:r["kegg-order"],page_size:r["kegg-page_size"]});if(_)return n.createElement(o.Z,{size:"large"});if(N)return n.createElement(l.Z,{error:N});if(!E)return n.createElement(o.Z,null);let h=0;const P=E.data.map((e=>String(e.attributes.name))),k=E.data.reduce(((e,a)=>(e[a.attributes.name]=a.attributes.description,e)),{}),y=E.data.map((e=>{const a=Number(e.attributes["genome-count"]);return h+=a,a})),S=E.data.map((e=>e.attributes["pangenome-count"]));return b[0]={Header:"Class ID",accessor:"attributes.class-id"},b[1].accessor="attributes.name",f.title={text:"Top 10 KEGG brite categories"},f.subtitle={text:`Total: ${h} KEGG matches - Drag to zoom in/out`},f.xAxis={categories:P},f.tooltip={formatter(){const e=k[this.key];let a=`${this.series.name}<br/>Count: ${this.y}`;return e&&(a+=`<br />KEGG Class: ${e}`),a}},f.series=[{name:"Genome",type:"column",data:y.slice(0,10),colors:d.DC,stack:"genome"}],e&&f.series.push({name:"Pan-genome",type:"column",data:S.slice(0,10),colors:d.DC,stack:"pangenome"}),n.createElement("div",{className:"vf-stack vf-stack--200"},n.createElement(i(),{highcharts:s,options:f,ref:a}),n.createElement(c.Z,{cols:b,data:E,title:`All ${E.meta.pagination.count} KEGG classes`,loading:_,initialPage:r["kegg-page"]-1,initialPageSize:10,namespace:"kegg-",isStale:v}))}},6313:(e,a,t)=>{t.d(a,{Z:()=>l});var n=t(7294),s=t(9521),r=t(402),i=t(2119);const o=({currentPageIndex:e,pageIndex:a,gotoPage:t})=>e===a?n.createElement("li",{className:"vf-pagination__item vf-pagination__item--is-active"},n.createElement("span",{className:"vf-pagination__label","aria-current":"page"},n.createElement("span",{className:"vf-u-sr-only"},"Page "),e+1)):n.createElement("li",{className:"vf-pagination__item"},n.createElement("button",{type:"button",onClick:()=>t(a),className:"vf-button vf-button--link vf-pagination__link"},n.createElement("span",{className:"vf-u-sr-only"}," page"),a+1)),l=({cols:e,data:a,title:t,initialPage:l=0,initialPageSize:c=25,className:g="",namespace:m="",showPagination:p=!0,sortable:u=!1,loading:d=!1,isStale:b=!1})=>{const[f,E]=(0,i.B)({[`${m}page`]:1,[`${m}order`]:"",[`${m}page_size`]:c},{[`${m}page`]:Number,[`${m}page_size`]:Number}),{getTableProps:_,getTableBodyProps:v,headerGroups:N,rows:h,prepareRow:P,canPreviousPage:k,canNextPage:y,pageCount:S,gotoPage:$,setPageSize:x,nextPage:z,previousPage:O,state:{pageIndex:C,pageSize:j,sortBy:w}}=(0,s.useTable)({columns:e,data:a.data,initialState:{pageIndex:l,pageSize:f[`${m}page_size`]},pageCount:a.meta.pagination.pages,manualPagination:!0,manualSortBy:!0},s.useSortBy,s.usePagination),I=(0,n.useRef)(null),[G,T]=(0,n.useState)(!1);(0,n.useEffect)((()=>{p&&f[`${m}page`]!==C+1&&(E(Object.assign(Object.assign({},f),{[`${m}page`]:C+1})),I.current&&G&&(I.current.scrollIntoView(),T(!1)))}),[p,E,C]),(0,n.useEffect)((()=>{p&&f[`${m}page_size`]!==j&&(E(Object.assign(Object.assign({},f),{[`${m}page_size`]:j})),I.current&&G&&(I.current.scrollIntoView(),T(!1)))}),[p,E,j]),(0,n.useEffect)((()=>{if(u){const e=function(e){if(!e.length)return"";const a=e[0];return`${a.desc?"-":""}${a.id.replace(/attributes./g,"").replace(/-/g,"_")}`}(w);if(e===f[`${m}order`])return;E(Object.assign(Object.assign({},f),{[`${m}order`]:e,[`${m}page`]:1})),I.current&&G&&(I.current.scrollIntoView(),T(!1))}}),[p,E,w,u]);const Z=(0,n.useMemo)((()=>function(e,a){const t=a>1?[0,1]:[0],n=a>2?[Math.max(2,e-2)]:[];for(let e=n[0]+1;e<a-2&&n.length<5;e+=1)n.push(e);let s=[];return a>7?s=[a-2,a-1]:a>6&&(s=[a-1]),{startingPages:t,endingPages:s,adjacentPages:n,hasJumpFromStart:!!n.length&&n[0]>t[t.length-1]+1,hasJumpToEnd:!!s.length&&!!n.length&&s[0]>n[n.length-1]+1}}(C,S)),[C,S]),B=e=>(T(!0),$(e)),H=e=>(T(!0),x(+e.target.value));return d&&!b?n.createElement(r.Z,{size:"small"}):n.createElement("section",null,n.createElement("div",{className:"mg-table-overlay-container"},n.createElement("div",{className:d&&b?"mg-table-overlay":void 0}),n.createElement("table",Object.assign({},_,{className:`vf-table--striped ${g}`,ref:I}),t&&n.createElement("caption",{className:"vf-table__caption"},"string"==typeof t?t:n.createElement(t,null)),n.createElement("thead",{className:"vf-table__header"},N.map((e=>n.createElement("tr",Object.assign({},e.getHeaderGroupProps(),{className:"vf-table__row"}),e.headers.map((e=>n.createElement("th",Object.assign({},u&&e.canSort?e.getHeaderProps(e.getSortByToggleProps()):{key:e.id},{className:"vf-table__heading"}),e.render("Header"),u&&e.canSort&&n.createElement(n.Fragment,null,"Â ",n.createElement("span",null,e.isSorted?e.isSortedDesc?n.createElement("i",{className:"icon icon-common icon-sort-down"}):n.createElement("i",{className:"icon icon-common icon-sort-up"}):n.createElement("i",{className:"icon icon-common icon-sort"})))))))))),n.createElement("tbody",Object.assign({},v(),{className:"vf-table__body"}),h.map((e=>(P(e),n.createElement("tr",Object.assign({},e.getRowProps(),{className:"vf-table__row"}),e.cells.map((e=>n.createElement("td",Object.assign({},e.getCellProps(),{className:"vf-table__cell"}),e.render("Cell"))))))))))),p&&n.createElement("section",{className:"mg-table-footer"},n.createElement("label",{className:"vf-form__label"},"Page Size:",n.createElement("select",{className:"vf-form__select",value:f[`${m}page_size`],onBlur:H,onChange:H},[10,25,50].map((e=>n.createElement("option",{key:e,value:e},"Show ",e))))),n.createElement("nav",{className:"vf-pagination","aria-label":"Pagination"},n.createElement("ul",{className:"vf-pagination__list"},n.createElement("li",{className:"vf-pagination__item vf-pagination__item--previous-page"},n.createElement("button",{disabled:!k,type:"button",onClick:O,className:"vf-button vf-button--link vf-pagination__link"},"Previous",n.createElement("span",{className:"vf-u-sr-only"}," page"))),Z.startingPages.map((e=>n.createElement(o,{key:e,currentPageIndex:C,pageIndex:e,gotoPage:B}))),Z.hasJumpFromStart&&n.createElement("li",{className:"vf-pagination__item"},n.createElement("span",{className:"vf-pagination__label"},"...")),Z.adjacentPages.map((e=>n.createElement(o,{key:e,currentPageIndex:C,pageIndex:e,gotoPage:B}))),Z.hasJumpToEnd&&n.createElement("li",{className:"vf-pagination__item"},n.createElement("span",{className:"vf-pagination__label"},"...")),Z.endingPages.map((e=>n.createElement(o,{key:e,currentPageIndex:C,pageIndex:e,gotoPage:B}))),n.createElement("li",{className:"vf-pagination__item vf-pagination__item--next-page"},n.createElement("button",{disabled:!y,type:"button",onClick:z,className:"vf-button vf-button--link vf-pagination__link"},"Next",n.createElement("span",{className:"vf-u-sr-only"}," page")))))))}},6581:(e,a,t)=>{t.d(a,{Z:()=>r});var n=t(7294),s=t(5457);const r=()=>({columns:(0,n.useMemo)((()=>[{Header:"COG ID",accessor:"attributes.name"},{Header:"Description",accessor:"attributes.description"},{Header:"Genome Count",accessor:"attributes.genome-count"},{Header:"Pan-genome count",accessor:"attributes.pangenome-count"}]),[]),options:{chart:{type:"column",height:400,zoomType:"xy",renderTo:"container"},yAxis:{min:0,title:{text:"Number of matches"}},plotOptions:{series:{stacking:"normal"},column:{allowPointSelect:!0,cursor:"pointer",colors:s.DC}},credits:{enabled:!1},legend:{enabled:!0}}})},2119:(e,a,t)=>{t.d(a,{B:()=>i});var n=t(7294),s=t(6974);const r=(e,a,t)=>{const n={},s=new URLSearchParams(a);return Object.entries(e).forEach((([e,a])=>{const r=t[e]||String;n[e]=r(s.get(e)||a)})),n},i=(e,a={})=>{const t=(0,s.TH)(),i=(0,s.s0)(),o=(0,n.useMemo)((()=>r(e,t.search,a)),[e,t.search,a]),[l,c]=(0,n.useState)(o);return(0,n.useEffect)((()=>{const n=r(e,t.search,a);JSON.stringify(n)!==JSON.stringify(l)&&c(n)}),[t.search,l,e,a]),[l,a=>{if(JSON.stringify(a)===JSON.stringify(l))return;const n=new URLSearchParams(t.search);let s=!1;Object.entries(e).forEach((([e,t])=>{const r=e in a?a[e]:t;a[e]!==l[e]&&(n.set(e,String(r)),r===t&&n.delete(e),s=!0)})),s&&(t.search=n.toString(),i(t))}]}}}]);
//# sourceMappingURL=735.aaa458d6.chunk.js.map