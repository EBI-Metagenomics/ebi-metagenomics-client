(self.webpackChunkmgportalv2=self.webpackChunkmgportalv2||[]).push([[879],{9170:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var l=a(7294),n=a(9521);const r=({currentPageIndex:e,pageIndex:t,gotoPage:a})=>e===t?l.createElement("li",{className:"vf-pagination__item vf-pagination__item--is-active"},l.createElement("span",{className:"vf-pagination__label","aria-current":"page"},l.createElement("span",{className:"vf-u-sr-only"},"Page "),e+1)):l.createElement("li",{className:"vf-pagination__item"},l.createElement("button",{type:"button",onClick:()=>a(t),className:"vf-button vf-button--link vf-pagination__link"},l.createElement("span",{className:"vf-u-sr-only"}," page"),t+1)),s=({cols:e,data:t,title:a,fetchPage:s,onChangeSort:c,initialPage:o=0})=>{const{getTableProps:i,getTableBodyProps:m,headerGroups:u,rows:d,prepareRow:v,canPreviousPage:p,canNextPage:f,pageCount:g,gotoPage:E,nextPage:h,previousPage:b,state:{pageIndex:_,pageSize:N,sortBy:y}}=(0,n.useTable)({columns:e,data:t.data,initialState:{pageIndex:o},pageCount:t.meta.pagination.pages,manualPagination:!0,manualSortBy:!0},n.useSortBy,n.usePagination);l.useEffect((()=>{s&&s(_,N)}),[s,_,N]),l.useEffect((()=>{c&&c(y)}),[c,y]);const C=l.useMemo((()=>function(e,t){const a=t>1?[0,1]:[0],l=t>2?[Math.max(2,e-2)]:[];for(let e=l[0]+1;e<t-2&&l.length<5;e+=1)l.push(e);let n=[];return t>7?n=[t-2,t-1]:t>6&&(n=[t-1]),{startingPages:a,endingPages:n,adjacentPages:l,hasJumpFromStart:!!l.length&&l[0]>a[a.length-1]+1,hasJumpToEnd:!!n.length&&!!l.length&&n[0]>l[l.length-1]+1}}(_,g)),[_,g]);return l.createElement("section",null,l.createElement("table",Object.assign({},i,{className:"vf-table--striped"}),l.createElement("caption",{className:"vf-table__caption"},a),l.createElement("thead",{className:"vf-table__header"},u.map((e=>l.createElement("tr",Object.assign({},e.getHeaderGroupProps(),{className:"vf-table__row"}),e.headers.map((e=>l.createElement("th",Object.assign({},e.getHeaderProps(e.getSortByToggleProps()),{className:"vf-table__heading"}),e.render("Header"),c&&l.createElement(l.Fragment,null," ",l.createElement("span",null,e.isSorted?e.isSortedDesc?l.createElement("i",{className:"icon icon-common icon-sort-down"}):l.createElement("i",{className:"icon icon-common icon-sort-up"}):l.createElement("i",{className:"icon icon-common icon-sort"})))))))))),l.createElement("tbody",Object.assign({},m(),{className:"vf-table__body"}),d.map((e=>(v(e),l.createElement("tr",Object.assign({},e.getRowProps(),{className:"vf-table__row"}),e.cells.map((e=>l.createElement("td",Object.assign({},e.getCellProps(),{className:"vf-table__cell"}),e.render("Cell")))))))))),s&&l.createElement("nav",{className:"vf-pagination","aria-label":"Pagination"},l.createElement("ul",{className:"vf-pagination__list"},l.createElement("li",{className:"vf-pagination__item vf-pagination__item--previous-page"},l.createElement("button",{disabled:!p,type:"button",onClick:b,className:"vf-button vf-button--link vf-pagination__link"},"Previous",l.createElement("span",{className:"vf-u-sr-only"}," page"))),C.startingPages.map((e=>l.createElement(r,{key:e,currentPageIndex:_,pageIndex:e,gotoPage:E}))),C.hasJumpFromStart&&l.createElement("li",{className:"vf-pagination__item"},l.createElement("span",{className:"vf-pagination__label"},"...")),C.adjacentPages.map((e=>l.createElement(r,{key:e,currentPageIndex:_,pageIndex:e,gotoPage:E}))),C.hasJumpToEnd&&l.createElement("li",{className:"vf-pagination__item"},l.createElement("span",{className:"vf-pagination__label"},"...")),C.endingPages.map((e=>l.createElement(r,{key:e,currentPageIndex:_,pageIndex:e,gotoPage:E}))),l.createElement("li",{className:"vf-pagination__item vf-pagination__item--next-page"},l.createElement("button",{disabled:!f,type:"button",onClick:h,className:"vf-button vf-button--link vf-pagination__link"},"Next",l.createElement("span",{className:"vf-u-sr-only"}," page"))))))}},1699:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});var l=a(7294),n=a(3647);const r=()=>{window.location.reload()},s=({error:e})=>e&&e.type!==n.ZB.NullURL?l.createElement("div",{className:"vf-box vf-box-theme--primary vf-box--easy",style:{backgroundColor:"lemonchiffon"}},l.createElement("h3",{className:"vf-box__heading"},l.createElement("span",{className:"icon icon-common icon-exclamation-triangle"})," Error Fetching Data"),l.createElement("p",{className:"vf-box__text"},(null==e?void 0:e.type)===n.ZB.FetchError&&`There were problems with the request. [${e.error}]`,(null==e?void 0:e.type)===n.ZB.NotOK&&`The response from the server was not OK [Status: ${e.status}].`,(null==e?void 0:e.type)===n.ZB.JSONError&&`The recovered resource didn't follow the expected format [${e.error}].`),l.createElement("div",{className:"mg-right"},l.createElement("button",{type:"button",className:"vf-button vf-button--tertiary vf-button--sm ",onClick:r},"Refresh"))):null},3647:(e,t,a)=>{"use strict";a.d(t,{ZB:()=>l,Yg:()=>o,XE:()=>i,nh:()=>m});var l,n=a(7294),r=a(150);!function(e){e[e.FetchError=0]="FetchError",e[e.NotOK=1]="NotOK",e[e.JSONError=2]="JSONError",e[e.NullURL=3]="NullURL"}(l||(l={}));const s={data:null,loading:!1,error:{type:l.NullURL,error:"The queried URL is null"}},c=e=>{const[t,a]=(0,n.useState)({data:null,loading:!0,error:null}),r=e=>{a((t=>Object.assign(Object.assign({},t),e)))};return(0,n.useEffect)((()=>{e?function(e,t){var a,n,r,s;a=this,n=void 0,s=function*(){let a=null,n=null;try{a=yield fetch(e)}catch(e){return void t({error:{error:e,type:l.FetchError},loading:!1})}if(a.ok){try{n=yield a.json()}catch(e){return void t({error:{error:e,type:l.JSONError},loading:!1})}t({data:n,loading:!1,error:null})}else t({error:{status:a.status,response:a,type:l.NotOK},loading:!1})},new((r=void 0)||(r=Promise))((function(e,t){function l(e){try{o(s.next(e))}catch(e){t(e)}}function c(e){try{o(s.throw(e))}catch(e){t(e)}}function o(t){var a;t.done?e(t.value):(a=t.value,a instanceof r?a:new r((function(e){e(a)}))).then(l,c)}o((s=s.apply(a,n||[])).next())}))}(e,r):a(s)}),[e]),t},o=(e,t={})=>{const a=Object.assign(Object.assign({},{format:"json",start:0}),t),l=`${r.l0}${e}?${Object.entries(a).map((([e,t])=>`${e}=${t}`)).join("&")}`;return c([null,void 0].includes(e)?null:l)},i=(e,t={})=>{const a=Object.assign(Object.assign({},{}),t);let l=`${r.hi}${e}`;return Object.keys(a).length>0&&(l+=`?${Object.entries(a).map((([e,t])=>`${e}=${t}`)).join("&")}`),c([null,void 0].includes(e)?null:l)},m=e=>c([null,void 0].includes(e)?null:`${r.tQ}${e}`)},2119:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var l=a(7294),n=a(1153);const r=(e,t,a)=>{const l={},n=new URLSearchParams(t);return Object.entries(e).forEach((([e,t])=>{const r=a[e]||String;l[e]=r(n.get(e)||t)})),l},s=(e,t={})=>{const a=(0,n.TH)(),s=(0,n.k6)(),c=(0,l.useMemo)((()=>r(e,a.search,t)),[e,a.search,t]),[o,i]=(0,l.useState)(c);return(0,l.useEffect)((()=>{const l=r(e,a.search,t);JSON.stringify(l)!==JSON.stringify(o)&&i(l)}),[a.search,o,e,t]),[o,t=>{if(JSON.stringify(t)===JSON.stringify(o))return;const l=new URLSearchParams(a.search);let n=!1;Object.entries(e).forEach((([e,a])=>{const r=e in t?t[e]:a;t[e]!==o[e]&&(l.set(e,String(r)),r===a&&l.delete(e),n=!0)})),n&&(a.search=l.toString(),s.push(a))}]}},7879:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var l=a(7294),n=a(1153);const r=l.createContext({searchData:{"/search/studies":{data:null,loading:!1,error:null},"/search/samples":{data:null,loading:!1,error:null},"/search/analyses":{data:null,loading:!1,error:null}},queryParameters:{},setQueryParameters:e=>{}});var s=a(402);const c=()=>{const e=(0,n.TH)(),{searchData:t,queryParameters:a,setQueryParameters:c}=(0,l.useContext)(r),[o,i]=(0,l.useState)(a.centre_name.split(",").filter(Boolean));(0,l.useEffect)((()=>{i(a.centre_name.split(",").filter(Boolean))}),[a.centre_name]);const m=(0,l.useMemo)((()=>{var a,l,n;return null===(n=((null===(l=null===(a=null==t?void 0:t[e.pathname])||void 0===a?void 0:a.data)||void 0===l?void 0:l.facets)||[]).filter((e=>"centre_name"===e.id)))||void 0===n?void 0:n[0]}),[e.pathname,t]);if(null==t?void 0:t[e.pathname].loading)return l.createElement(s.Z,null);if(null==t?void 0:t[e.pathname].error)return null;if(!m)return null;const u=e=>{const{value:t,checked:l}=e.target;let n=[...o];l&&!o.includes(t)?n.push(t):n=o.filter((e=>e!==t)),c(Object.assign(Object.assign({},a),{centre_name:n.sort().join(",")}))};return l.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400"},l.createElement("legend",{className:"vf-form__legend"},"Centre name"),m.facetValues.map((({label:e,value:t,count:a})=>l.createElement("div",{className:"vf-form__item vf-form__item--checkbox",key:t},l.createElement("input",{type:"checkbox",name:t,value:t,id:t,className:"vf-form__checkbox",onChange:u,checked:o.includes(t)}),l.createElement("label",{className:"vf-form__label",htmlFor:t},l.createElement("span",{className:"mg-filter-checkbox-label"},e," ",l.createElement("span",{className:"mg-number"},a)))))))},o=({value:e,label:t,count:a,biomeChildren:n,depth:r=0,handleSelection:s,isSelected:c})=>{const[i,m]=(0,l.useState)(!1);return l.createElement("div",{style:{marginLeft:`${r}rem`}},l.createElement("div",{className:"mg-biome-selector"},(null==n?void 0:n.length)?l.createElement("button",{type:"button",className:"mg-expander",onClick:()=>m(!i)},i?"▾":"▸"):l.createElement("span",{className:"mg-biome-spacer"}),l.createElement("div",{className:"vf-form__item vf-form__item--checkbox"},l.createElement("input",{type:"checkbox",name:e,value:e,id:e,className:"vf-form__checkbox",onChange:s,checked:c(e)}),l.createElement("label",{className:"vf-form__label",htmlFor:e},l.createElement("span",{className:"mg-filter-checkbox-label"},t," ",l.createElement("span",{className:"mg-number"},a))))),n&&n.length&&i&&n.map((({label:t,value:a,count:n,biomeChildren:i})=>l.createElement(o,{key:`${e}/${a}`,label:t,value:`${e}/${a}`,count:n,depth:r+1,biomeChildren:i,handleSelection:s,isSelected:c}))))},i=()=>{const e=(0,n.TH)(),{searchData:t,queryParameters:a,setQueryParameters:c}=(0,l.useContext)(r),[i,m]=(0,l.useState)(a.biome.split(",").filter(Boolean));(0,l.useEffect)((()=>{m(a.biome.split(",").filter(Boolean))}),[a.biome]);const u=(0,l.useMemo)((()=>{var a,l,n;return null===(n=((null===(l=null===(a=null==t?void 0:t[e.pathname])||void 0===a?void 0:a.data)||void 0===l?void 0:l.facets)||[]).filter((e=>"biome"===e.id)))||void 0===n?void 0:n[0]}),[e.pathname,t]);if(null==t?void 0:t[e.pathname].loading)return l.createElement(s.Z,null);if(null==t?void 0:t[e.pathname].error)return null;if(!u)return null;const d=e=>{const{value:t,checked:l}=e.target;let n=[...i];l&&!i.includes(t)?n.push(t):n=i.filter((e=>e!==t)),c(Object.assign(Object.assign({},a),{biome:n.sort().join(",")}))};return l.createElement("fieldset",{className:"vf-form__fieldset vf-stack vf-stack--400"},l.createElement("legend",{className:"vf-form__legend"},"Biome"),u.facetValues.map((({label:e,value:t,count:a,children:n})=>l.createElement(o,{key:t,label:e,value:t,count:a,biomeChildren:n,handleSelection:d,isSelected:e=>i.includes(e)}))))};var m=a(3727);const u=[{label:"Studies",to:"/search/studies"},{label:"Samples",to:"/search/samples"},{label:"Analyses",to:"/search/analyses"}],d=()=>{const e=(0,n.TH)(),t=(0,n.k6)(),{searchData:a}=(0,l.useContext)(r);return(0,l.useEffect)((()=>{u.some((({to:t})=>t===e.pathname))||t.replace(Object.assign(Object.assign({},e),{pathname:u[0].to}))}),[e,t]),l.createElement("div",{className:"vf-tabs"},l.createElement("ul",{className:"vf-tabs__list"},u.map((({label:t,to:n})=>{var r,s;return l.createElement("li",{className:"vf-tabs__item",key:t},l.createElement(m.rU,{className:"vf-tabs__link "+(n===e.pathname?"is-active":""),to:n},t,l.createElement("span",{className:"mg-number"},(null===(s=null===(r=null==a?void 0:a[n])||void 0===r?void 0:r.data)||void 0===s?void 0:s.hitCount)||"")))}))))},v=()=>{const{queryParameters:e,setQueryParameters:t}=(0,l.useContext)(r),[a,n]=(0,l.useState)(e.query);return(0,l.useEffect)((()=>{n(e.query)}),[e.query]),l.createElement("div",{className:"vf-form vf-form--search vf-form--search--responsive vf-sidebar vf-sidebar--end"},l.createElement("div",{className:"vf-sidebar__inner"},l.createElement("div",{className:"vf-form__item | vf-search__item"},l.createElement("input",{type:"text",placeholder:"Enter your search terms",id:"text",className:"vf-form__input | st-default-search-input",value:a,onChange:e=>{n(e.target.value)}})),l.createElement("button",{type:"button",className:"vf-search__button | vf-button vf-button--primary",onClick:()=>{t(Object.assign(Object.assign({},e),{query:a}))}},l.createElement("span",{className:"vf-button__text"},"Search "),l.createElement("span",{className:"icon icon-common icon-search"})),l.createElement("button",{type:"button",className:"vf-search__button | vf-button vf-button--tertiary",onClick:()=>{t({})}},l.createElement("span",{className:"vf-button__text"},"Clear All "),l.createElement("span",{className:"icon icon-common icon-times-circle"}))))};var p=a(1699),f=a(9170);const g={"/search/studies":{columns:[{id:"study_id",Header:"MGnify ID",accessor:e=>e.id,Cell:({cell:e})=>l.createElement(m.rU,{to:`/studies/${e.value}`},e.value)},{id:"ena_id",Header:"ENA accession",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.ENA_PROJECT)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement("span",null,l.createElement("a",{href:`https://www.ebi.ac.uk/ena/browser/view/${e.value}`,className:"ext"},e.value))},{id:"biome",Header:"Biome",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.biome_name)||void 0===a?void 0:a.join(":")},Cell:({cell:e})=>l.createElement("span",null,e.value)},{id:"centre",Header:"Centre name",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.centre_name)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)}]},"/search/samples":{columns:[{id:"sample_id",Header:"Sample",accessor:e=>e.id,Cell:({cell:e})=>l.createElement(m.rU,{to:`/samples/${e.value}`},e.value)},{id:"mgnify_id",Header:"MGnify ID",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.METAGENOMICS_PROJECTS)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement(m.rU,{to:`/studies/${e.value}`},e.value)},{id:"sample_name",Header:"Name",pathnames:["/search/studies"],accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.name)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)},{id:"sample_description",Header:"Description",pathnames:["/search/studies"],accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.description)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)}]},"/search/analyses":{columns:[{id:"analyses_id",Header:"Analysis",accessor:e=>(e.id||"").split("_"),Cell:({cell:e})=>l.createElement(m.rU,{to:`/analyses/${e.value[0]}?version=${e.value[1]}`},e.value[0])},{id:"pipeline",Header:"Pipeline version",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.pipeline_version)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement("span",null,l.createElement(m.rU,{to:`/pipelines/${e.value}`},e.value))},{id:"sample_id",Header:"Sample",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.METAGENOMICS_SAMPLES)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement(m.rU,{to:`/samples/${e.value}`},e.value)},{id:"mgnify_id",Header:"MGnify ID",accessor:e=>{var t,a;return(null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.METAGENOMICS_PROJECTS)||void 0===a?void 0:a[0])||""},Cell:({cell:e})=>l.createElement(m.rU,{to:`/studies/${e.value}`},e.value)},{id:"experiment",Header:"Experiment type",accessor:e=>{var t,a;return null===(a=null===(t=null==e?void 0:e.fields)||void 0===t?void 0:t.experiment_type)||void 0===a?void 0:a[0]},Cell:({cell:e})=>l.createElement("span",null,e.value)}]}},E=()=>{const{pathname:e}=(0,n.TH)(),{searchData:t}=(0,l.useContext)(r),{data:a,loading:c,error:o}=(null==t?void 0:t[e])||{},i=(0,l.useMemo)((()=>{var t;return null===(t=null==g?void 0:g[e])||void 0===t?void 0:t.columns}),[e]);if(c)return l.createElement(s.Z,{size:"small"});if(o||!a)return l.createElement(p.Z,{error:o});const m={data:a.entries,meta:{pagination:{pages:Math.ceil(a.hitCount/25)}}};return l.createElement(f.Z,{cols:i,data:m,title:`Studies (${a.hitCount})`,initialPage:1})};var h=a(3647),b=a(2119);const _=(e,t)=>e.map((e=>{return a=e,t[e].split(",").filter(Boolean).map((e=>`${a}:${e}`)).join(",");var a})).filter(Boolean).join(","),N=()=>{const[e,t]=(0,b.B)({query:"",centre_name:"",biome:""}),a={searchData:{"/search/studies":(0,h.Yg)("metagenomics_projects",{query:(null==e?void 0:e.query)||"domain_source:metagenomics_projects",size:25,fields:"ENA_PROJECT,biome_name,centre_name",facetcount:10,facetsdepth:3,facets:_(["centre_name","biome"],e)}),"/search/samples":(0,h.Yg)("metagenomics_samples",{query:(null==e?void 0:e.query)||"domain_source:metagenomics_samples",size:25,fields:"METAGENOMICS_PROJECTS,name,description",facetcount:10,facetsdepth:3,facets:_(["biome"],e)}),"/search/analyses":(0,h.Yg)("metagenomics_analyses",{query:(null==e?void 0:e.query)||"domain_source:metagenomics_analyses",size:25,fields:"METAGENOMICS_PROJECTS,METAGENOMICS_SAMPLES,pipeline_version,experiment_type",facetcount:10,facetsdepth:3,facets:_(["biome"],e)})},queryParameters:e,setQueryParameters:t};return l.createElement("section",{className:"vf-content"},l.createElement("h2",null,"Text Search."),l.createElement(r.Provider,{value:a},l.createElement(v,null),l.createElement(d,null),l.createElement("section",{className:"embl-grid"},l.createElement("div",{className:"vf-stack vf-stack--400"},l.createElement(n.rs,null,l.createElement(n.AW,{path:"/search/studies"},l.createElement(i,null),l.createElement(c,null)),l.createElement(n.AW,{path:"/search/samples"},l.createElement(i,null)),l.createElement(n.AW,{path:"/search/analyses"},l.createElement(i,null)))),l.createElement(E,null))))}}}]);
//# sourceMappingURL=879.966910fd.chunk.js.map