<!doctype html>
<html lang="en">
<head id="head">
    <title>Run &lt; EBI Metagenomics &lt; EMBL-EBI</title>
    {{> partials/head this}}
</head>
<body class="level2"><!-- add any of your classes or IDs -->
<div id="header-container">{{> partials/header this}}</div>

<!-- Suggested layout containers / #content -->
<div id="content">
    <div id="main-content-area" class="row column small-12 medium-12 large-12" role="main">
    </div>
</div>

<script id="runTmpl" type="text/template">
    <div class="column small-12 medium-12 large-12">
        <nav aria-label="You are here:" role="navigation">
            <ul class="breadcrumbs columns">
                <li><a href="{{htmlWebpackPlugin.options.templateData.subfolder}}">Home</a></li>
                <li><a href="{{htmlWebpackPlugin.options.templateData.subfolder}}/samples/<%= sample_id %>">Sample <%= sample_id %></a></li>
                <li>
                    <span class="show-for-sr">Current: </span> Run <%= run_id %>
                </li>
            </ul>
        </nav>
        <h2>Run <%= run_id %></h2>
        <section>
            <h4>Analysis pipeline version
                <select id="analysisSelect" class="autowidth">
                    <% _.each(pipeline_versions, function(version){ %>
                    <option value="<%= version%>">V<%= version %></option>
                    <% }); %>
                </select>
            </h4>
        </section>

        <ul class="tabs" data-deep-link="true" data-update-history="true" data-deep-link-smudge="500" data-tabs
            id="run-tabs">
            <li class="tabs-title is-active"><a href="#overview" aria-selected="true">Overview</a></li>
            <li class="tabs-title"><a href="#qc">Quality control</a></li>
            <li class="tabs-title"><a href="#taxonomic">Taxonomic analysis</a></li>
            <li class="tabs-title"><a href="#functional">Functional analysis</a></li>
            <li class="tabs-title"><a href="#abundance">Abundance and comparison</a></li>
            <li class="tabs-title"><a href="#download">Download</a></li>
        </ul>
        <div class="tabs-content" data-tab-content="run-tabs">
            <div class="tabs-panel active" id="overview">
            </div>
            <div class="tabs-panel" id="qc">
                <div class="row">
                    <div class="center column small-12 medium-12 large-12">
                        <p>The chart below shows the number of reads which pass the quality control steps we have
                            implemented in our pipeline. Sequence merging may have occurred with paired-end data, so the
                            initial number of reads may differ from the number given by ENA.</p>
                        <div id="QC-step-chart" class="run-qc-chart"></div>
                        <p>The histograms below show the distribution of sequence lengths, in basepairs, (left) and GC
                            percentage (right) for the sequences having passed our quality control steps. Note that for
                            large files, the distributions were compiled from a random subset of 2 millions sequence
                            reads.
                            The standard deviations are shown on each plot. The bar chart underneath each graph
                            indicates
                            the minimum, average and maximum length and average GC and AT content, respectively.</p>
                    </div>
                </div>
            </div>
            <div class="tabs-panel" id="taxonomic">

                <div id="ssu-lsu-btns" class="row columns  <% if (version<4.0){ %> hidden <% } %>">
                    <button class="button rna-select-button" value="/ssu" data-cy="ssu-btn">Small subunit rRNA</button>
                    <button class="button rna-select-button" value="/lsu" data-cy="lsu-btn">Large subunit rRNA</button>
                </div>
                <div class="row columns">
                    These are the results from the taxonomic analysis steps of our pipeline. You can switch between
                    different views of the data using the menu of icons below (pie, bar, stacked and interactive
                    krona charts). The data used to build these charts can be found under the "Download" tab.
                </div>
                <ul class="tabs" data-tabs id="taxonomy-tabs">
                    <li class="tabs-title active">
                        <a class="chart-icon-cont" href="#krona" aria-selected="true">
                            <img class="chart-icon" src="{{htmlWebpackPlugin.options.templateData.subfolder}}/static/images/ico_graph_krona_on.svg"/>
                        </a>
                    </li>
                    <li class="tabs-title">
                        <a class="chart-icon-cont" href="#pie" aria-selected="false">
                            <img class="chart-icon" src="{{htmlWebpackPlugin.options.templateData.subfolder}}/static/images/ico_graph_pie_on.svg"/>
                        </a>
                    </li>
                    <li class="tabs-title">
                        <a class="chart-icon-cont" href="#column" aria-selected="false">
                            <img class="chart-icon" src="{{htmlWebpackPlugin.options.templateData.subfolder}}/static/images/ico_graph_barh_on.svg"/>
                        </a>
                    </li>
                    <li class="tabs-title">
                        <a class="chart-icon-cont" href="#stacked-column" aria-selected="false">
                            <img class="chart-icon" src="{{htmlWebpackPlugin.options.templateData.subfolder}}/static/images/ico_graph_col_on.svg"/>
                        </a>
                    </li>
                </ul>

                <div class="tabs-content" data-tab-content="taxonomy-tabs">

                    <div class="tabs-panel active" id="krona">
                        <div id="tax-Krona">
                            <!--<div class="msg_error" id="ie_krona">Krona chart is only working for latest versions of Internet-->
                            <!--Explorer (IE 9+). <br/>-->
                            <!--Please, update your browser to a more recent version - <a href="http://windows.microsoft.com/ie"-->
                            <!--onclick="trackExternalDownload('http://windows.microsoft.com/ie')">Download-->
                            <!--Now</a>.-->
                        </div>

                    </div>
                    <div class="tabs-panel" id="pie">
                        <div class="row">
                            <div class="columns small-12 medium-4 larger-4">
                                <div id="domain-composition-pie"></div>
                            </div>
                            <div class="columns small-12 medium-8 larger-8">
                                <div id="phylum-composition-pie"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="columns small-12 medium-12 large-12">
                                <div class="phylum-table"></div>
                            </div>
                        </div>
                    </div>
                    <div class="tabs-panel" id="column">
                        <div class="row">
                            <div class="columns small-12 medium-4 larger-4">
                                <div id="domain-composition-column"></div>
                            </div>
                            <div class="columns small-12 medium-8 larger-8">
                                <div id="phylum-composition-column"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="columns small-12 medium-12 large-12">
                                <div class="phylum-table"></div>
                            </div>
                        </div>
                    </div>
                    <div class="tabs-panel" id="stacked-column">
                        <div class="row">
                            <div class="columns small-12 medium-12 larger-12">
                                <div id="phylum-composition-stacked-column"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="columns small-12 medium-12 large-12">
                                <div class="phylum-table"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tabs-panel" id="functional">
                <div class="row column">
                    <p>These charts present the functional analysis of our pipeline, which focuses
                        on matches to the <a
                                href="http://www.ebi.ac.uk/interpro" title="InterPro website"
                                class="ext">InterPro
                            database</a> and GO terms, which summarise the functional content of the sequences in the
                        sample. The full set of results files may be found under the "Download" tab.</p>
                </div>
                <div class="row column">
                    <div id="SeqFeat-chart" class="run-qc-chart"></div>
                </div>
                <div class="row column">
                    <h4>Interpro match summary</h4>
                </div>
                <div class="row">
                    <div class="columns small-12 medium-4 large-4">
                        <div id="InterProPie-chart"></div>
                    </div>
                    <div class="columns small-12 medium-8 large-8">
                        <div id="InterPro-table"></div>
                    </div>
                </div>
                <div class="row column">
                    <h4>GO Terms annotation</h4>
                    <p>A summary of Gene Ontology (GO) terms derived from InterPro matches to your sample is provided in
                        the charts below.</p>
                    <p>Switch view:
                    <ul class="tabs">
                        <li class="tabs-title" id="go-bar-btn">
                            <a class="chart-icon-cont" href="#go-bar" aria-selected="true">
                                <img class="chart-icon" src="{{htmlWebpackPlugin.options.templateData.subfolder}}/static/images/ico_graph_barh_on.svg"/>
                            </a>
                        </li>
                        <li class="tabs-title" id="go-pie-btn">
                            <a class="chart-icon-cont" href="#go-pie" aria-selected="false">
                                <img class="chart-icon" src="{{htmlWebpackPlugin.options.templateData.subfolder}}/static/images/ico_graph_pie_on.svg"/>
                            </a>
                        </li>
                    </ul>
                    </p>
                </div>
                <div class="row" id="go-slim-bar-charts">
                    <div class="columns small-12 medium-4 large-4">
                        <div id="biological-process-bar-chart"></div>
                    </div>
                    <div class="columns small-12 medium-4 large-4">
                        <div id="molecular-function-bar-chart"></div>
                    </div>
                    <div class="columns small-12 medium-4 large-4">
                        <div id="cellular-component-bar-chart"></div>
                    </div>
                </div>
                <div class="row" id="go-slim-pie-charts" style="display:none">
                    <div class="columns small-12 medium-4 large-4">
                        <div id="biological-process-pie-chart"></div>
                    </div>
                    <div class="columns small-12 medium-4 large-4">
                        <div id="molecular-function-pie-chart"></div>
                    </div>
                    <div class="columns small-12 medium-4 large-4">
                        <div id="cellular-component-pie-chart"></div>
                    </div>
                </div>
            </div>

            <div class="tabs-panel" id="download">
                <div id="download-list">
                </div>
            </div>
            <div class="tabs-panel" id="abundance">
                This page gives you information regarding metagenomic community diversity estimation and information
                which allow comparisons between all study runs. The following plots illustrate the taxa abundance
                distribution.
                <div id="abundance-disp">
                    <img id="abundance-chart" class='abundance-chart' src="">
                </div>
            </div>
        </div>
    </div>
</script>

<script id="downloadsTmpl" type="text/template">
    <div class="row columns">
        <div class="row columns">
            <p>Here you may download the full set of analysis results files. For the original raw sequence reads, follow
                the link to ENA. Multi-part files should be concatenated after unzipping.</p>
        </div>
        <% _.each(groups, function(group, name){ %>
        <h3> <%= name %></h3>
        <div class="row columns">
            <table class="runs-download-table">
                <thead>
                <tr>
                    <th>Name</th>
                    <th>Compression</th>
                    <th>Format</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                <% _.each(group, function(entry){ %>
                <tr>
                    <td><%= entry.attributes.description.label %></td>
                    <td><%= entry.attributes['file-format'].compression ? entry.attributes['file-format'].compExtension :
                        '-' %>
                    </td>
                    <td><%= entry.attributes['file-format'].name %></td>
                    <td><% if (entry.attributes.links.length===1){ %>
                        <div class="download-part">
                            <a href="<%= entry.attributes.links[0] %>"><span class="icon  icon-functional" data-icon="="></span>
                                </a>
                        </div>
                        <% } else { %>
                            <% _.each(entry.attributes.links, function(link, i){ %>
                            <div class="download-part">
                                    <a  href="<%= link %>">Part <%= (i+1) %><span class="icon  icon-functional" data-icon="="></span>
                                    </a>
                            </div>
                            <% }) %>
                        <% } %>

                    </td>
                </tr>
                <% }); %>
                </tbody>
            </table>
        </div>
        <% }); %>
    </div>
</script>

<div id="footer">
    {{>partials/elixir}}
    {{>partials/footer}}
</div>

</body>

</html>